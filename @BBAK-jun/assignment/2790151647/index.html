<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>항해플러스 프론트엔드 6기 기술블로그</title>
  <link rel="icon" href="/front_6th/favicon.ico"/>
  
  <script type="module" crossorigin src="/front_6th/assets/index-S6z1r9QJ.js"></script>
  <link rel="stylesheet" crossorigin href="/front_6th/assets/index-BXO68frB.css">
</head>
<body>
<div id="root"><link rel="preload" as="image" href="https://github.com/user-attachments/assets/df8cf14e-b714-4372-b8ae-391899b06a01"/><link rel="preload" as="image" href="https://github.com/user-attachments/assets/1f99276e-8992-4745-995c-dd30a3fe0b99"/><div data-slot="sidebar-wrapper" style="--sidebar-width:16rem;--sidebar-width-icon:3rem" class="group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full"><div class="min-h-screen flex w-full"><div class="group peer text-sidebar-foreground hidden md:block" data-state="expanded" data-collapsible="" data-variant="sidebar" data-side="left" data-slot="sidebar"><div data-slot="sidebar-gap" class="relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear group-data-[collapsible=offcanvas]:w-0 group-data-[side=right]:rotate-180 group-data-[collapsible=icon]:w-(--sidebar-width-icon)"></div><div data-slot="sidebar-container" class="fixed inset-y-0 z-10 hidden h-svh transition-[left,right,width] duration-200 ease-linear md:flex left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)] group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l w-64"><div data-sidebar="sidebar" data-slot="sidebar-inner" class="bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm"><div data-slot="sidebar-content" data-sidebar="content" class="flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden bg-card border-r border-border"><a class="p-4" href="/front_6th/" data-discover="true"><div class="flex items-center space-x-2 mb-6"><div class="w-8 h-8 bg-gradient-primary rounded-lg flex items-center justify-center"><span class="text-white font-bold text-sm">6기</span></div><h4 class="text-lg font-bold text-primary">항해플러스 프론트엔드</h4></div></a><div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><div data-slot="sidebar-group-label" data-sidebar="group-label" class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground px-4">학습 관리</div><div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm"><ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-1 px-2"><li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative"><a data-slot="sidebar-menu-button" data-sidebar="menu-button" data-size="default" data-active="false" class="peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground text-sm h-12 text-foreground hover:bg-secondary hover:text-secondary-foreground rounded-lg transition-all duration-300" href="/front_6th/" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-users h-5 w-5" aria-hidden="true"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><path d="M16 3.128a4 4 0 0 1 0 7.744"></path><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><circle cx="9" cy="7" r="4"></circle></svg><span class="ml-3">수강생 목록</span></a></li><li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative"><a data-slot="sidebar-menu-button" data-sidebar="menu-button" data-size="default" data-active="false" class="peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground text-sm h-12 text-foreground hover:bg-secondary hover:text-secondary-foreground rounded-lg transition-all duration-300" href="/front_6th/assignments/" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open h-5 w-5" aria-hidden="true"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg><span class="ml-3">과제 목록</span></a></li></ul></div></div></div></div></div></div><div class="flex-1 min-w-0"><header class="h-12 flex items-center border-b border-border bg-card px-4"><button data-slot="sidebar-trigger" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-7 mr-4 text-white" data-sidebar="trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-panel-left" aria-hidden="true"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path></svg><span class="sr-only">Toggle Sidebar</span></button><h4 class="text-lg font-semibold "><a href="/front_6th/@BBAK-jun/" data-discover="true">BBAK-jun<!-- --> 님의 상세페이지</a> ＞ <!-- -->[3팀 박준형] Chapter 4-1 성능 최적화</h4></header><main class="p-6"><div><div class="card-wrap"><div data-slot="card" class="card text-card-foreground flex flex-col gap-6 shadow-sm mb-6 p-6 border border-gray-700 bg-gray-800 rounded-lg"><a href="https://github.com/hanghae-plus/front_6th_chapter4-1/pull/16" target="_blank"><div class="flex items-start gap-4"><div class="flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" height="32" aria-hidden="true" viewBox="0 0 24 24" width="32" fill="white" class="w-8 h-8"><path d="M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"></path></svg></div><div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-2"><h3 class="text-lg font-semibold text-white truncate">[3팀 박준형] Chapter 4-1 성능 최적화</h3></div><div class="flex items-center gap-4 text-xs text-gray-500"><span>by <!-- -->BBAK-jun</span><span>2025. 9. 2.</span></div></div></div></a></div></div><div class="overflow-auto"><div data-color-mode="dark" class="wmde-markdown wmde-markdown-color p-6 max-w-full" style="word-wrap:break-word;overflow-wrap:break-word"><h2 id="과제-체크포인트"><a class="anchor" aria-hidden="true" tabindex="-1" href="#과제-체크포인트"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>과제 체크포인트</h2>
<h3 id="배포-링크"><a class="anchor" aria-hidden="true" tabindex="-1" href="#배포-링크"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>배포 링크</h3>
<!-- -->
<ul>
<li>vanilla SSG : <a href="https://bbak-jun.github.io/front_6th_chapter4-1/vanilla/">https://bbak-jun.github.io/front_6th_chapter4-1/vanilla/</a></li>
<li>react SSG : <a href="https://bbak-jun.github.io/front_6th_chapter4-1/react/">https://bbak-jun.github.io/front_6th_chapter4-1/react/</a></li>
</ul>
<h3 id="기본과제-vanilla-ssr--ssg"><a class="anchor" aria-hidden="true" tabindex="-1" href="#기본과제-vanilla-ssr--ssg"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>기본과제 (Vanilla SSR &amp; SSG)</h3>
<h4 id="express-ssr-서버"><a class="anchor" aria-hidden="true" tabindex="-1" href="#express-ssr-서버"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Express SSR 서버</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> Express 미들웨어 기반 서버 구현</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 개발/프로덕션 환경 분기 처리</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> HTML 템플릿 치환 (<code>&lt;!--app-html--&gt;</code>, <code>&lt;!--app-head--&gt;</code>)</li>
</ul>
<h4 id="서버-사이드-렌더링"><a class="anchor" aria-hidden="true" tabindex="-1" href="#서버-사이드-렌더링"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>서버 사이드 렌더링</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 서버에서 동작하는 Router 구현</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 서버 데이터 프리페칭 (상품 목록, 상품 상세)</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 서버 상태관리 초기화</li>
</ul>
<h4 id="클라이언트-hydration"><a class="anchor" aria-hidden="true" tabindex="-1" href="#클라이언트-hydration"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>클라이언트 Hydration</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> <code>window.__INITIAL_DATA__</code> 스크립트 주입</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 클라이언트 상태 복원</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 서버-클라이언트 데이터 일치</li>
</ul>
<h4 id="static-site-generation"><a class="anchor" aria-hidden="true" tabindex="-1" href="#static-site-generation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Static Site Generation</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 동적 라우트 SSG (상품 상세 페이지들)</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 빌드 타임 페이지 생성</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 파일 시스템 기반 배포</li>
</ul>
<h3 id="심화과제-react-ssr--ssg"><a class="anchor" aria-hidden="true" tabindex="-1" href="#심화과제-react-ssr--ssg"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>심화과제 (React SSR &amp; SSG)</h3>
<h4 id="react-ssr"><a class="anchor" aria-hidden="true" tabindex="-1" href="#react-ssr"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>React SSR</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> <code>renderToString</code> 서버 렌더링</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> TypeScript SSR 모듈 빌드</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> Universal React Router (서버/클라이언트 분기)</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> React 상태관리 서버 초기화</li>
</ul>
<h4 id="react-hydration"><a class="anchor" aria-hidden="true" tabindex="-1" href="#react-hydration"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>React Hydration</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> Hydration 불일치 방지</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 클라이언트 상태 복원</li>
</ul>
<h4 id="static-site-generation-1"><a class="anchor" aria-hidden="true" tabindex="-1" href="#static-site-generation-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Static Site Generation</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 동적 라우트 SSG (상품 상세 페이지들)</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 빌드 타임 페이지 생성</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 파일 시스템 기반 배포</li>
</ul>
<h2 id="구현-과정-돌아보기"><a class="anchor" aria-hidden="true" tabindex="-1" href="#구현-과정-돌아보기"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>구현 과정 돌아보기</h2>
<h3 id="가장-어려웠던-부분과-해결-과정"><a class="anchor" aria-hidden="true" tabindex="-1" href="#가장-어려웠던-부분과-해결-과정"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>가장 어려웠던 부분과 해결 과정</h3>
<h4 id="1-ssr에서-스토어-상태-공유-문제로-인한-e2e-테스트-간섭"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-ssr에서-스토어-상태-공유-문제로-인한-e2e-테스트-간섭"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. SSR에서 스토어 상태 공유 문제로 인한 e2e 테스트 간섭</h4>
<p><strong>문제:</strong> e2e 테스트들이 동시에 실행될 때 SSR 환경에서 router 인스턴스와 스토어가 모듈 레벨에서 공유되어 테스트 간 상태가 오염되는 문제가 발생했습니다.</p>
<p><strong>해결 과정:</strong></p>
<ul>
<li>문제의 근본 원인을 파악: <code>router</code> 인스턴스가 <code>packages/react/src/core/router/instance.ts</code>에서 싱글톤으로 생성되어 공유됨</li>
<li>Router Factory 패턴을 시도했지만, 더 간단한 해결책을 선택</li>
<li><code>entry-server.tsx</code>에서 각 SSR 요청마다 router에 라우트를 다시 등록하도록 수정하여 상태 격리 달성</li>
</ul>
<h4 id="2-ssg-빌드-중-vite-module-runner-has-been-closed-오류"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-ssg-빌드-중-vite-module-runner-has-been-closed-오류"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. SSG 빌드 중 &quot;Vite module runner has been closed&quot; 오류</h4>
<p><strong>문제:</strong> static-site-generate.ts에서 Vite 인스턴스를 너무 일찍 닫아버려서 SSG 생성 중 모듈 로딩 오류가 발생했습니다.</p>
<p><strong>해결 과정:</strong></p>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// 문제가 있던 코드</span>
</span><span class="code-line"><span class="token keyword">await</span> vite<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// render 함수 반환 직후 바로 닫음</span>
</span><span class="code-line"><span class="token keyword">return</span> mod<span class="token punctuation">.</span>render<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 해결된 코드</span>
</span><span class="code-line"><span class="token keyword">return</span> <span class="token punctuation">{</span> render<span class="token operator">:</span> mod<span class="token punctuation">.</span>render<span class="token punctuation">,</span> vite <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// vite 인스턴스를 함께 반환</span>
</span><span class="code-line"><span class="token comment">// 모든 렌더링 작업 완료 후 finally 블록에서 닫음</span>
</span></code><div class="copied" data-code="// 문제가 있던 코드
await vite.close(); // render 함수 반환 직후 바로 닫음
return mod.render;

// 해결된 코드
return { render: mod.render, vite }; // vite 인스턴스를 함께 반환
// 모든 렌더링 작업 완료 후 finally 블록에서 닫음
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h4 id="3-typescript-마이그레이션-중-모듈-해상도-문제"><a class="anchor" aria-hidden="true" tabindex="-1" href="#3-typescript-마이그레이션-중-모듈-해상도-문제"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>3. TypeScript 마이그레이션 중 모듈 해상도 문제</h4>
<p><strong>문제:</strong> JavaScript에서 TypeScript로 마이그레이션하면서 <code>static-site-generate.js</code>를 <code>static-site-generate.ts</code>로 변환할 때 모듈 import와 타입 정의 문제가 발생했습니다.</p>
<p><strong>해결 과정:</strong></p>
<ul>
<li>package.json 스크립트를 <code>node</code>에서 <code>tsx</code>로 변경</li>
<li>타입 안전성을 위한 proper typing 추가</li>
<li>에러 핸들링과 리소스 관리 개선</li>
</ul>
<h3 id="구현하면서-새롭게-알게-된-개념"><a class="anchor" aria-hidden="true" tabindex="-1" href="#구현하면서-새롭게-알게-된-개념"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>구현하면서 새롭게 알게 된 개념</h3>
<h4 id="ssr-환경에서의-상태-격리의-중요성"><a class="anchor" aria-hidden="true" tabindex="-1" href="#ssr-환경에서의-상태-격리의-중요성"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>SSR 환경에서의 상태 격리의 중요성</h4>
<ul>
<li><strong>모듈 레벨 싱글톤의 위험성</strong>: Node.js 환경에서 모듈은 캐시되므로 여러 요청 간에 상태가 공유될 수 있다는 것을 체감했습니다.</li>
<li><strong>테스트 환경에서의 상태 오염</strong>: e2e 테스트가 병렬로 실행될 때 공유된 상태로 인해 예측 불가능한 결과가 나올 수 있음을 학습했습니다.</li>
<li><strong>실제 운영 환경에서의 사례</strong>: 실제로 회사에서 운용 중인 Nuxt2 서비스에서 Vuex 스토어가 요청별로 격리되지 않고 공유되는 문제를 경험했습니다. 메타프레임워크임에도 불구하고 이런 문제가 발생할 수 있다는 것을 확인했습니다.</li>
</ul>
<h4 id="vite의-ssr-모듈-로딩-메커니즘"><a class="anchor" aria-hidden="true" tabindex="-1" href="#vite의-ssr-모듈-로딩-메커니즘"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Vite의 SSR 모듈 로딩 메커니즘</h4>
<ul>
<li><strong>Vite 인스턴스 생명주기</strong>: Vite 인스턴스를 너무 일찍 닫으면 이후 모듈 로딩에서 오류가 발생한다는 것을 알게 되었습니다.</li>
<li><strong>리소스 관리의 중요성</strong>: SSG 같은 배치 작업에서는 리소스를 적절한 시점에 해제해야 한다는 것을 학습했습니다.</li>
</ul>
<h4 id="universal-router-패턴의-복잡성"><a class="anchor" aria-hidden="true" tabindex="-1" href="#universal-router-패턴의-복잡성"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Universal Router 패턴의 복잡성</h4>
<ul>
<li><strong>서버와 클라이언트의 라우터 동작 차이</strong>: 같은 라우터 코드가 서버에서는 매번 새로운 컨텍스트를 생성해야 하지만, 클라이언트에서는 싱글톤으로 동작해야 한다는 차이점을 이해했습니다.</li>
<li><strong>동적 라우트 등록</strong>: SSR에서 각 요청마다 라우트를 다시 등록하는 것이 상태 격리에 도움이 된다는 것을 학습했습니다.</li>
</ul>
<h4 id="typescript와-build-tool-통합"><a class="anchor" aria-hidden="true" tabindex="-1" href="#typescript와-build-tool-통합"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>TypeScript와 Build Tool 통합</h4>
<ul>
<li><strong>tsx vs node</strong>: TypeScript 파일을 실행할 때 <code>tsx</code>를 사용하면 별도 컴파일 없이 바로 실행할 수 있다는 것을 알게 되었습니다.</li>
<li><strong>모듈 해상도와 타입 정의</strong>: SSR 환경에서 모듈 import 시 타입 정의와 런타임 동작이 일치해야 한다는 중요성을 체감했습니다.</li>
</ul>
<h4 id="성능-최적화-관점에서의-인사이트"><a class="anchor" aria-hidden="true" tabindex="-1" href="#성능-최적화-관점에서의-인사이트"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>성능 최적화 관점에서의 인사이트</h4>
<h4 id="리소스-관리-최적화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#리소스-관리-최적화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>리소스 관리 최적화</h4>
<ul>
<li><strong>Vite 인스턴스 생명주기 관리</strong>: SSG 생성 시 Vite 인스턴스를 적절한 시점까지 유지하고 모든 작업 완료 후 정리함으로써 메모리 누수를 방지했습니다.</li>
<li><strong>에러 핸들링과 리소스 정리</strong>: try-catch-finally 패턴을 사용하여 오류 발생 시에도 리소스가 적절히 정리되도록 구현했습니다.</li>
</ul>
<h4 id="상태-관리-최적화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#상태-관리-최적화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>상태 관리 최적화</h4>
<ul>
<li><strong>각 요청별 독립적인 스토어</strong>: SSR에서 매번 새로운 productStore 인스턴스를 생성하여 메모리 사용량을 최적화하고 상태 오염을 방지했습니다.</li>
<li><strong>라우터 상태 격리</strong>: 각 SSR 요청마다 라우트를 재등록하는 오버헤드가 있지만, 상태 격리를 통한 안정성 향상이 더 중요하다고 판단했습니다.</li>
</ul>
<h4 id="빌드-최적화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#빌드-최적화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>빌드 최적화</h4>
<ul>
<li><strong>TypeScript 직접 실행</strong>: <code>tsx</code>를 사용하여 별도 컴파일 단계 없이 TypeScript 파일을 직접 실행함으로써 빌드 파이프라인을 단순화했습니다.</li>
<li><strong>에러 처리 개선</strong>: SSG 생성 중 개별 페이지 오류가 전체 빌드를 중단시키지 않도록 error boundary를 구현했습니다.</li>
</ul>
<h2 id="학습-갈무리"><a class="anchor" aria-hidden="true" tabindex="-1" href="#학습-갈무리"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>학습 갈무리</h2>
<h3 id="q1-현재-구현한-ssrssg-아키텍처에서-확장성을-고려할-때-어떤-부분을-개선하시겠습니까"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q1-현재-구현한-ssrssg-아키텍처에서-확장성을-고려할-때-어떤-부분을-개선하시겠습니까"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q1. 현재 구현한 SSR/SSG 아키텍처에서 확장성을 고려할 때 어떤 부분을 개선하시겠습니까?</h3>
<h4 id="상태-관리-아키텍처-개선"><a class="anchor" aria-hidden="true" tabindex="-1" href="#상태-관리-아키텍처-개선"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>상태 관리 아키텍처 개선</h4>
<ul>
<li><strong>Router Factory 패턴 완전 적용</strong>: 현재는 각 요청마다 라우트를 재등록하는 방식인데, 완전한 Router Factory를 구현하여 각 요청마다 독립적인 router 인스턴스를 생성하도록 개선하겠습니다.</li>
<li><strong>Context Provider 격리</strong>: 각 SSR 요청마다 완전히 독립적인 Context를 생성하여 상태 오염 가능성을 원천 차단하겠습니다.</li>
</ul>
<h4 id="캐싱-및-성능-최적화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#캐싱-및-성능-최적화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>캐싱 및 성능 최적화</h4>
<ul>
<li><strong>SSG 증분 빌드</strong>: 현재는 모든 페이지를 매번 재생성하는데, 변경된 데이터에 따라 필요한 페이지만 재생성하는 증분 빌드를 도입하겠습니다.</li>
<li><strong>메모리 기반 캐싱</strong>: 자주 요청되는 데이터를 메모리에 캐시하여 API 호출 횟수를 줄이겠습니다.</li>
</ul>
<h4 id="에러-처리-및-모니터링"><a class="anchor" aria-hidden="true" tabindex="-1" href="#에러-처리-및-모니터링"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>에러 처리 및 모니터링</h4>
<ul>
<li><strong>구조화된 에러 처리</strong>: 현재는 단순한 try-catch 구조인데, 에러 타입별로 다른 처리 전략을 적용할 수 있도록 개선하겠습니다.</li>
<li><strong>성능 메트릭 수집</strong>: SSR/SSG 빌드 시간, 메모리 사용량 등의 메트릭을 수집하여 성능 병목 지점을 파악하겠습니다.</li>
</ul>
<h3 id="q2-express-서버-대신-다른-런타임cloudflare-workers-vercel-edge-functions-등을-사용한다면-어떤-점을-수정해야-할까요"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q2-express-서버-대신-다른-런타임cloudflare-workers-vercel-edge-functions-등을-사용한다면-어떤-점을-수정해야-할까요"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q2. Express 서버 대신 다른 런타임(Cloudflare Workers, Vercel Edge Functions 등)을 사용한다면 어떤 점을 수정해야 할까요?</h3>
<h4 id="멀티런타임-지원-프레임워크-도입"><a class="anchor" aria-hidden="true" tabindex="-1" href="#멀티런타임-지원-프레임워크-도입"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>멀티런타임 지원 프레임워크 도입</h4>
<p><strong>Hono 같은 Web Standards 기반 프레임워크 활용</strong></p>
<ul>
<li><a href="https://hono.dev/">Hono</a>는 Web Standards API만을 사용하여 Cloudflare, Fastly, Deno, Bun, AWS, Node.js 등 모든 런타임에서 동작합니다.</li>
<li>Express 대신 Hono로 서버를 구현하면 런타임 환경에 구애받지 않습니다:</li>
</ul>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Hono <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;hono&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hono</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&#x27;Hello Hono!&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#x27;/api/products&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// Web Standards 기반 fetch API 사용</span>
</span><span class="code-line">  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#x27;https://api.example.com/products&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">default</span> app
</span></code><div class="copied" data-code="import { Hono } from &#x27;hono&#x27;

const app = new Hono()

app.get(&#x27;/&#x27;, (c) =&gt; c.text(&#x27;Hello Hono!&#x27;))
app.get(&#x27;/api/products&#x27;, async (c) =&gt; {
  // Web Standards 기반 fetch API 사용
  const response = await fetch(&#x27;https://api.example.com/products&#x27;)
  return c.json(await response.json())
})

export default app
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h4 id="서버리스-환경-적응"><a class="anchor" aria-hidden="true" tabindex="-1" href="#서버리스-환경-적응"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>서버리스 환경 적응</h4>
<ul>
<li><strong>상태 관리 방식 변경</strong>: 현재 우리가 해결한 &quot;모듈 레벨 상태 공유&quot; 문제는 서버리스에서는 자연스럽게 해결됩니다. 각 요청이 독립적인 실행 환경에서 처리되기 때문입니다.</li>
<li><strong>Cold Start 최적화</strong>: 번들 크기를 최소화하고, 필요한 모듈만 동적으로 import하여 초기 실행 시간을 줄여야 합니다.</li>
</ul>
<h4 id="런타임-api-차이-대응"><a class="anchor" aria-hidden="true" tabindex="-1" href="#런타임-api-차이-대응"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>런타임 API 차이 대응</h4>
<ul>
<li><strong>Web Standards API 사용</strong>: Node.js 특화 API(<code>fs</code>, <code>path</code> 등) 대신 Web Standards API(<code>fetch</code>, <code>Response</code>, <code>Request</code> 등)를 사용해야 합니다.</li>
<li><strong>환경 변수 접근</strong>: <code>process.env</code> 대신 각 플랫폼별 환경 변수 접근 방식을 추상화해야 합니다.</li>
</ul>
<h4 id="리소스-관리-최적화-1"><a class="anchor" aria-hidden="true" tabindex="-1" href="#리소스-관리-최적화-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>리소스 관리 최적화</h4>
<ul>
<li><strong>메모리 제한</strong>: Edge Functions는 메모리 사용량이 제한적이므로, 현재의 Vite 인스턴스 관리 방식을 더욱 효율적으로 개선해야 합니다.</li>
<li><strong>실행 시간 제한</strong>: 요청 처리 시간 제한이 있으므로, SSR 렌더링 시간을 최적화해야 합니다.</li>
</ul>
<h3 id="q3-현재-구현에서-성능-병목이-될-수-있는-지점은-어디이고-어떻게-개선하시겠습니까"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q3-현재-구현에서-성능-병목이-될-수-있는-지점은-어디이고-어떻게-개선하시겠습니까"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q3. 현재 구현에서 성능 병목이 될 수 있는 지점은 어디이고, 어떻게 개선하시겠습니까?</h3>
<h4 id="1-ssr에서-매번-라우트-재등록하는-오버헤드"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-ssr에서-매번-라우트-재등록하는-오버헤드"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. SSR에서 매번 라우트 재등록하는 오버헤드</h4>
<p><strong>병목 지점:</strong> <code>entry-server.tsx</code>에서 각 요청마다 라우트를 재등록하는 작업
<strong>개선 방안:</strong></p>
<ul>
<li>Router Factory 패턴을 완전히 구현하여 라우트가 미리 등록된 독립적인 인스턴스를 생성</li>
<li>라우트 설정을 캐시하여 재등록 오버헤드 최소화</li>
</ul>
<h4 id="2-vite-인스턴스-생성해제-비용"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-vite-인스턴스-생성해제-비용"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. Vite 인스턴스 생성/해제 비용</h4>
<p><strong>병목 지점:</strong> SSG 생성 시 Vite 인스턴스의 생성과 해제 과정
<strong>개선 방안:</strong></p>
<ul>
<li>Vite 인스턴스 풀링을 통한 재사용</li>
<li>개발 환경에서는 한 번 생성된 인스턴스를 재사용하도록 개선</li>
</ul>
<h4 id="3-상품-데이터-직렬화역직렬화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#3-상품-데이터-직렬화역직렬화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>3. 상품 데이터 직렬화/역직렬화</h4>
<p><strong>병목 지점:</strong> 서버에서 클라이언트로 전달되는 초기 데이터의 직렬화 과정
<strong>개선 방안:</strong></p>
<ul>
<li>필요한 데이터만 선택적으로 직렬화</li>
<li>압축 알고리즘 적용으로 전송 크기 최적화</li>
</ul>
<h4 id="4-메모리-사용량-최적화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#4-메모리-사용량-최적화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>4. 메모리 사용량 최적화</h4>
<p><strong>병목 지점:</strong> 대량의 상품 페이지 SSG 생성 시 메모리 사용량 증가
<strong>개선 방안:</strong></p>
<ul>
<li>배치 처리를 통한 메모리 사용량 제어</li>
<li>WeakMap을 활용한 자동 가비지 컬렉션 최적화</li>
</ul>
<h3 id="q4-1000개-이상의-상품-페이지를-ssg로-생성할-때-고려해야-할-사항은-무엇입니까"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q4-1000개-이상의-상품-페이지를-ssg로-생성할-때-고려해야-할-사항은-무엇입니까"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q4. 1000개 이상의 상품 페이지를 SSG로 생성할 때 고려해야 할 사항은 무엇입니까?</h3>
<h4 id="메모리-관리-최적화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#메모리-관리-최적화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>메모리 관리 최적화</h4>
<ul>
<li><strong>배치 처리</strong>: 한 번에 모든 페이지를 생성하지 않고 100-200개씩 배치로 나누어 처리</li>
<li><strong>가비지 컬렉션</strong>: 각 배치 완료 후 명시적으로 메모리 정리</li>
<li><strong>Vite 인스턴스 재사용</strong>: 현재 구현처럼 인스턴스를 재사용하여 생성 비용 최소화</li>
</ul>
<h4 id="빌드-시간-최적화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#빌드-시간-최적화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>빌드 시간 최적화</h4>
<ul>
<li><strong>병렬 처리</strong>: Worker Threads를 활용하여 여러 페이지를 동시에 생성</li>
<li><strong>증분 빌드</strong>: 변경된 상품만 재생성하는 로직 구현</li>
<li><strong>캐싱 전략</strong>: 렌더링 결과를 캐시하여 불필요한 재생성 방지</li>
</ul>
<h4 id="실제-구현-예시"><a class="anchor" aria-hidden="true" tabindex="-1" href="#실제-구현-예시"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>실제 구현 예시</h4>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">generateInBatches</span><span class="token punctuation">(</span>pages<span class="token operator">:</span> Page<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> batchSize <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pages<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> batchSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> batch <span class="token operator">=</span> pages<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> i <span class="token operator">+</span> batchSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">await</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>batch<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>page <span class="token operator">=&gt;</span> <span class="token function">generatePage</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 배치 완료 후 메모리 정리</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>global<span class="token punctuation">.</span>gc<span class="token punctuation">)</span> global<span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="async function generateInBatches(pages: Page[], batchSize = 100) {
  for (let i = 0; i &lt; pages.length; i += batchSize) {
    const batch = pages.slice(i, i + batchSize);
    await Promise.all(batch.map(page =&gt; generatePage(page)));

    // 배치 완료 후 메모리 정리
    if (global.gc) global.gc();
  }
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h3 id="q5-hydration-과정에서-사용자가-느낄-수-있는-ux-이슈는-무엇이고-어떻게-개선할-수-있을까요"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q5-hydration-과정에서-사용자가-느낄-수-있는-ux-이슈는-무엇이고-어떻게-개선할-수-있을까요"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q5. Hydration 과정에서 사용자가 느낄 수 있는 UX 이슈는 무엇이고, 어떻게 개선할 수 있을까요?</h3>
<h4 id="주요-ux-이슈들"><a class="anchor" aria-hidden="true" tabindex="-1" href="#주요-ux-이슈들"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>주요 UX 이슈들</h4>
<p><strong>인터랙션 차단 (Interaction Blocking)</strong></p>
<ul>
<li>Hydration 완료 전까지 사용자 클릭이나 입력이 동작하지 않아 답답함을 느낄 수 있습니다.</li>
<li>특히 버튼 클릭이나 폼 입력 시 반응이 없어 사용자가 여러 번 클릭하는 문제가 발생합니다.</li>
</ul>
<p><strong>시각적 깜빡임 (Flash of Content)</strong></p>
<ul>
<li>서버에서 렌더링된 HTML과 클라이언트에서 렌더링되는 결과가 다를 때 화면이 깜빡이는 현상</li>
<li>CSS-in-JS나 동적 스타일링 시 특히 자주 발생합니다.</li>
</ul>
<h4 id="개선-방안"><a class="anchor" aria-hidden="true" tabindex="-1" href="#개선-방안"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>개선 방안</h4>
<p><strong>Progressive Enhancement 적용</strong></p>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// 기본 기능은 서버 렌더링으로, 고급 기능은 클라이언트에서 점진적으로 활성화</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token function-variable function">ProductCard</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> product<span class="token punctuation">,</span> isHydrated <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;product-card&quot;</span><span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token punctuation">{</span><span class="token comment">/* 기본 링크는 항상 동작 */</span><span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/product/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>product<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token operator">&gt;</span>상세보기<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token punctuation">{</span><span class="token comment">/* 고급 기능은 Hydration 후 활성화 */</span><span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">{</span>isHydrated <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>
</span><span class="code-line">        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleQuickView<span class="token punctuation">}</span><span class="token operator">&gt;</span>빠른 미리보기<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token punctuation">)</span><span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</span><span class="code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// 기본 기능은 서버 렌더링으로, 고급 기능은 클라이언트에서 점진적으로 활성화
const ProductCard = ({ product, isHydrated }) =&gt; {
  return (
    &lt;div className=&quot;product-card&quot;&gt;
      &lt;h3&gt;{product.name}&lt;/h3&gt;
      {/* 기본 링크는 항상 동작 */}
      &lt;a href={`/product/${product.id}`}&gt;상세보기&lt;/a&gt;

      {/* 고급 기능은 Hydration 후 활성화 */}
      {isHydrated &amp;&amp; (
        &lt;button onClick={handleQuickView}&gt;빠른 미리보기&lt;/button&gt;
      )}
    &lt;/div&gt;
  );
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>Skeleton UI와 로딩 상태</strong></p>
<ul>
<li>Hydration 중임을 명확히 표시하여 사용자 기대치 관리</li>
<li>인터랙티브하지 않은 요소들을 시각적으로 구분하여 표시</li>
</ul>
<p><strong>Selective Hydration</strong></p>
<ul>
<li>중요한 인터랙션 요소부터 우선적으로 Hydrate</li>
<li>React 18의 Suspense를 활용한 부분적 Hydration 구현</li>
</ul>
<h3 id="q6-이번-과제에서-학습한-내용을-실제-프로덕션-환경에-적용할-때-추가로-고려해야-할-사항은"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q6-이번-과제에서-학습한-내용을-실제-프로덕션-환경에-적용할-때-추가로-고려해야-할-사항은"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q6. 이번 과제에서 학습한 내용을 실제 프로덕션 환경에 적용할 때 추가로 고려해야 할 사항은?</h3>
<h4 id="메타프레임워크의-함정-nuxt2-vuex-스토어-공유-사례"><a class="anchor" aria-hidden="true" tabindex="-1" href="#메타프레임워크의-함정-nuxt2-vuex-스토어-공유-사례"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>메타프레임워크의 함정: Nuxt2 Vuex 스토어 공유 사례</h4>
<img width="757" height="654" alt="image" src="https://github.com/user-attachments/assets/df8cf14e-b714-4372-b8ae-391899b06a01"/>
<p><strong>실제 운영 환경에서 발생한 문제</strong></p>
<ul>
<li>Nuxt2를 사용한 서비스에서 Vuex 스토어가 요청별로 격리되지 않고 서버에서 공유되는 문제 발생</li>
<li>사용자 A의 개인정보가 사용자 B에게 노출되거나, 로그인 상태가 다른 사용자에게 공유되는 심각한 보안 이슈</li>
<li>메타프레임워크를 사용한다고 해서 이런 문제가 자동으로 해결되는 것은 아니라는 교훈</li>
</ul>
<p><strong>Nuxt2에서 발생하는 이유</strong></p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 잘못된 예시 - Nuxt2에서 흔히 발생하는 패턴</span>
</span><span class="code-line"><span class="token comment">// store/index.js</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token function-variable function">state</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">isLoggedIn</span><span class="token operator">:</span> <span class="token boolean">false</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 문제: 서버에서 이 스토어 인스턴스가 공유될 수 있음</span>
</span></code><div class="copied" data-code="// 잘못된 예시 - Nuxt2에서 흔히 발생하는 패턴
// store/index.js
export const state = () =&gt; ({
  user: null,
  isLoggedIn: false
})

// 문제: 서버에서 이 스토어 인스턴스가 공유될 수 있음
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>해결 방안</strong></p>
<ul>
<li>Nuxt3로 마이그레이션: Pinia 사용으로 상태 격리 개선</li>
<li>또는 Nuxt2에서 스토어 초기화 로직 개선:</li>
</ul>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 개선된 방식</span>
</span><span class="code-line"><span class="token comment">// nuxt.config.js</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// SSR에서 스토어를 매번 새로 생성하도록 설정</span>
</span><span class="code-line">  <span class="token literal-property property">ssr</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#x27;universal&#x27;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// store/index.js - 각 요청마다 새로운 상태로 초기화</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">nuxtServerInit</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> commit <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> req <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token comment">// 서버에서 각 요청마다 스토어 초기화</span>
</span><span class="code-line">    <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&#x27;RESET_STATE&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// 개선된 방식
// nuxt.config.js
export default {
  // SSR에서 스토어를 매번 새로 생성하도록 설정
  ssr: true,
  mode: &#x27;universal&#x27;
}

// store/index.js - 각 요청마다 새로운 상태로 초기화
export const actions = {
  nuxtServerInit({ commit }, { req }) {
    // 서버에서 각 요청마다 스토어 초기화
    commit(&#x27;RESET_STATE&#x27;)
  }
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>교훈</strong></p>
<ul>
<li><strong>메타프레임워크도 완벽하지 않다</strong>: 잘 알려진 프레임워크라도 SSR 환경에서 상태 격리 문제가 발생할 수 있음</li>
<li><strong>철저한 테스트 필요</strong>: 동시 사용자 환경에서의 상태 격리 테스트가 필수</li>
<li><strong>직접 구현의 가치</strong>: 이번 과제처럼 직접 구현하면서 이런 문제를 미리 인지하고 해결할 수 있음</li>
</ul>
<h4 id="cold-start-최적화-전략"><a class="anchor" aria-hidden="true" tabindex="-1" href="#cold-start-최적화-전략"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Cold Start 최적화 전략</h4>
<p><strong>서버리스 환경에서의 Cold Start 해결 방안</strong></p>
<p>Google Cloud Run의 경우 <a href="https://medium.com/google-cloud/3-solutions-to-mitigate-the-cold-starts-on-cloud-run-8c60f0ae7894">3가지 해결책</a>이 있습니다:</p>
<img width="714" height="414" alt="image" src="https://github.com/user-attachments/assets/1f99276e-8992-4745-995c-dd30a3fe0b99"/>
<ol>
<li>
<p><strong>Min Instance 설정</strong>: 최소 인스턴스 수를 유지하여 Cold Start 방지</p>
<ul>
<li>비용이 발생하지만 가장 안정적인 방법</li>
<li>트래픽 패턴을 분석하여 적절한 최소 인스턴스 수 결정</li>
</ul>
</li>
<li>
<p><strong>스케줄러를 통한 주기적 호출</strong>: Cloud Scheduler로 정기적으로 서비스 호출</p>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// Cloud Scheduler에서 매 분마다 호출</span>
</span><span class="code-line">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#x27;/health&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&#x27;OK&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code><div class="copied" data-code="// Cloud Scheduler에서 매 분마다 호출
app.get(&#x27;/health&#x27;, (c) =&gt; c.text(&#x27;OK&#x27;))
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
</li>
<li>
<p><strong>SIGTERM 무한 루프</strong>: 인스턴스 종료 시 자기 자신을 호출</p>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line">process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#x27;SIGTERM&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// 자기 자신을 호출하여 새 인스턴스 생성</span>
</span><span class="code-line">  <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">SERVICE_URL</span> <span class="token operator">+</span> <span class="token string">&#x27;/health&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></code><div class="copied" data-code="process.on(&#x27;SIGTERM&#x27;, async () =&gt; {
  // 자기 자신을 호출하여 새 인스턴스 생성
  await fetch(process.env.SERVICE_URL + &#x27;/health&#x27;)
})
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
</li>
</ol>
<h4 id="성능-측정-및-부하-테스트-환경"><a class="anchor" aria-hidden="true" tabindex="-1" href="#성능-측정-및-부하-테스트-환경"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>성능 측정 및 부하 테스트 환경</h4>
<p><strong>실시간 성능 모니터링 대시보드</strong></p>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// 성능 메트릭 수집 미들웨어</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token function-variable function">performanceMiddleware</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token keyword">const</span> memoryBefore <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">memoryUsage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> duration <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start
</span><span class="code-line">  <span class="token keyword">const</span> memoryAfter <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">memoryUsage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// 메트릭 전송 (Prometheus, DataDog 등)</span>
</span><span class="code-line">  metrics<span class="token punctuation">.</span><span class="token function">histogram</span><span class="token punctuation">(</span><span class="token string">&#x27;ssr_render_time&#x27;</span><span class="token punctuation">,</span> duration<span class="token punctuation">)</span>
</span><span class="code-line">  metrics<span class="token punctuation">.</span><span class="token function">gauge</span><span class="token punctuation">(</span><span class="token string">&#x27;memory_usage&#x27;</span><span class="token punctuation">,</span> memoryAfter<span class="token punctuation">.</span>heapUsed <span class="token operator">-</span> memoryBefore<span class="token punctuation">.</span>heapUsed<span class="token punctuation">)</span>
</span><span class="code-line">  metrics<span class="token punctuation">.</span><span class="token function">counter</span><span class="token punctuation">(</span><span class="token string">&#x27;requests_total&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inc</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    method<span class="token operator">:</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span>method<span class="token punctuation">,</span>
</span><span class="code-line">    status<span class="token operator">:</span> c<span class="token punctuation">.</span>res<span class="token punctuation">.</span>status
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// 성능 메트릭 수집 미들웨어
const performanceMiddleware = async (c, next) =&gt; {
  const start = Date.now()
  const memoryBefore = process.memoryUsage()

  await next()

  const duration = Date.now() - start
  const memoryAfter = process.memoryUsage()

  // 메트릭 전송 (Prometheus, DataDog 등)
  metrics.histogram(&#x27;ssr_render_time&#x27;, duration)
  metrics.gauge(&#x27;memory_usage&#x27;, memoryAfter.heapUsed - memoryBefore.heapUsed)
  metrics.counter(&#x27;requests_total&#x27;).inc({
    method: c.req.method,
    status: c.res.status
  })
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>상용환경 유사 테스트 환경 구축</strong></p>
<ol>
<li><strong>데이터베이스 스냅샷 활용</strong>: 실제 상용 데이터의 익명화된 스냅샷으로 테스트 DB 구성</li>
<li><strong>부하 테스트 시나리오</strong>: 실제 사용자 패턴을 모방한 트래픽 시뮬레이션
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line"><span class="token comment"># K6를 사용한 부하 테스트 예시</span>
</span><span class="code-line">k6 run <span class="token parameter variable">--vus</span> <span class="token number">100</span> <span class="token parameter variable">--duration</span> 5m load-test.js
</span></code><div class="copied" data-code="# K6를 사용한 부하 테스트 예시
k6 run --vus 100 --duration 5m load-test.js
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
</li>
</ol>
<p><strong>RPS/TPS 측정 및 최적화</strong></p>
<ul>
<li><strong>목표 성능 지표</strong>:
<ul>
<li>SSR 응답 시간: &lt; 200ms (95th percentile)</li>
<li>RPS: &gt; 1000 requests/second</li>
<li>메모리 사용량: &lt; 512MB per instance</li>
</ul>
</li>
<li><strong>병목 지점 식별</strong>: DB 쿼리, 렌더링, 네트워크 I/O 각각의 성능 측정</li>
<li><strong>점진적 최적화</strong>: 각 개선사항의 성능 영향도 측정</li>
</ul>
<h4 id="모니터링-및-로깅-체계"><a class="anchor" aria-hidden="true" tabindex="-1" href="#모니터링-및-로깅-체계"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>모니터링 및 로깅 체계</h4>
<ul>
<li><strong>성능 메트릭</strong>: SSR 렌더링 시간, 메모리 사용량, Cold Start 빈도 추적</li>
<li><strong>에러 추적</strong>: Sentry나 DataDog 같은 APM 도구로 실시간 에러 모니터링</li>
<li><strong>사용자 경험 메트릭</strong>: Core Web Vitals (LCP, FID, CLS) 측정</li>
</ul>
<h4 id="보안-고려사항"><a class="anchor" aria-hidden="true" tabindex="-1" href="#보안-고려사항"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>보안 고려사항</h4>
<ul>
<li><strong>CSP (Content Security Policy)</strong>: XSS 공격 방지를 위한 엄격한 CSP 설정</li>
<li><strong>CSRF 보호</strong>: 상태 변경 요청에 대한 CSRF 토큰 검증</li>
<li><strong>환경 변수 관리</strong>: 민감한 정보는 안전한 시크릿 관리 시스템 사용</li>
</ul>
<h3 id="q7-nextjs-같은-프레임워크-대신-직접-구현한-ssrssg의-장단점은-무엇인가요"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q7-nextjs-같은-프레임워크-대신-직접-구현한-ssrssg의-장단점은-무엇인가요"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q7. Next.js 같은 프레임워크 대신 직접 구현한 SSR/SSG의 장단점은 무엇인가요?</h3>
<h4 id="장점"><a class="anchor" aria-hidden="true" tabindex="-1" href="#장점"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>장점</h4>
<p><strong>깊은 학습과 이해</strong></p>
<ul>
<li>SSR/SSG의 내부 동작 원리를 직접 체험하며 깊이 있는 이해를 얻을 수 있었습니다.</li>
<li>문제 발생 시 근본 원인을 파악하고 해결할 수 있는 능력을 기를 수 있었습니다.</li>
</ul>
<p><strong>완전한 커스터마이징 자유도</strong></p>
<ul>
<li>프로젝트의 특수한 요구사항에 맞춰 자유롭게 구현할 수 있습니다.</li>
<li>불필요한 기능 없이 필요한 것만 구현하여 번들 크기를 최적화할 수 있습니다.</li>
</ul>
<p><strong>기술적 제약 없음</strong></p>
<ul>
<li>특정 프레임워크의 규칙이나 제약에 얽매이지 않고 최적의 솔루션을 구현할 수 있습니다.</li>
</ul>
<h4 id="단점"><a class="anchor" aria-hidden="true" tabindex="-1" href="#단점"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>단점</h4>
<p><strong>개발 시간과 비용</strong></p>
<ul>
<li>기본적인 기능부터 모두 구현해야 하므로 개발 시간이 오래 걸립니다.</li>
<li>검증된 솔루션이 아니므로 예상치 못한 버그나 이슈가 발생할 수 있습니다.</li>
</ul>
<p><strong>유지보수 부담</strong></p>
<ul>
<li>모든 코드를 직접 관리해야 하므로 유지보수 비용이 높습니다.</li>
<li>보안 업데이트나 성능 개선을 모두 직접 해야 합니다.</li>
</ul>
<p><strong>생태계 지원 부족</strong></p>
<ul>
<li>커뮤니티 지원이나 플러그인 생태계의 혜택을 받기 어렵습니다.</li>
<li>문제 해결을 위한 레퍼런스가 부족합니다.</li>
</ul>
<h3 id="q8-nextjs-를-이용하여-ssg-방식으로-배포하려면-어떻게-해야-좋을까요"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q8-nextjs-를-이용하여-ssg-방식으로-배포하려면-어떻게-해야-좋을까요"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q8. Next.js 를 이용하여 SSG 방식으로 배포하려면 어떻게 해야 좋을까요?</h3>
<!-- -->
<h2 id="코드-품질-향상"><a class="anchor" aria-hidden="true" tabindex="-1" href="#코드-품질-향상"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>코드 품질 향상</h2>
<h3 id="자랑하고-싶은-구현"><a class="anchor" aria-hidden="true" tabindex="-1" href="#자랑하고-싶은-구현"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>자랑하고 싶은 구현</h3>
<h4 id="1-ssg-빌드-시-리소스-관리-최적화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-ssg-빌드-시-리소스-관리-최적화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. SSG 빌드 시 리소스 관리 최적화</h4>
<p>Vite 인스턴스 생명주기를 적절히 관리하여 메모리 누수를 방지하는 구조를 구현했습니다:</p>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">loadRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> builtEntry <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token constant">SSR_DIR</span><span class="token punctuation">,</span> <span class="token string">&quot;entry-server.tsx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>builtEntry<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> mod <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token function">pathToFileURL</span><span class="token punctuation">(</span>builtEntry<span class="token punctuation">)</span><span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> mod<span class="token punctuation">.</span>render <span class="token operator">!==</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;SSR 모듈에 render가 없습니다.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token punctuation">{</span> render<span class="token operator">:</span> mod<span class="token punctuation">.</span>render<span class="token punctuation">,</span> vite<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> vite <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">createViteServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    server<span class="token operator">:</span> <span class="token punctuation">{</span> middlewareMode<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    appType<span class="token operator">:</span> <span class="token string">&quot;custom&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">try</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> mod <span class="token operator">=</span> <span class="token keyword">await</span> vite<span class="token punctuation">.</span><span class="token function">ssrLoadModule</span><span class="token punctuation">(</span><span class="token string">&quot;/src/entry-server.tsx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> mod<span class="token punctuation">.</span>render <span class="token operator">!==</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;SSR 모듈에 render가 없습니다.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token comment">// Vite 인스턴스를 반환하여 나중에 닫을 수 있도록 함</span>
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token punctuation">{</span> render<span class="token operator">:</span> mod<span class="token punctuation">.</span>render<span class="token punctuation">,</span> vite <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">await</span> vite<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="async function loadRender() {
  const builtEntry = path.join(SSR_DIR, &quot;entry-server.tsx&quot;);
  if (fs.existsSync(builtEntry)) {
    const mod = await import(pathToFileURL(builtEntry).href);
    if (typeof mod.render !== &quot;function&quot;) throw new Error(&quot;SSR 모듈에 render가 없습니다.&quot;);
    return { render: mod.render, vite: null };
  }

  const vite = await createViteServer({
    server: { middlewareMode: true },
    appType: &quot;custom&quot;,
  });
  try {
    const mod = await vite.ssrLoadModule(&quot;/src/entry-server.tsx&quot;);
    if (typeof mod.render !== &quot;function&quot;) throw new Error(&quot;SSR 모듈에 render가 없습니다.&quot;);
    // Vite 인스턴스를 반환하여 나중에 닫을 수 있도록 함
    return { render: mod.render, vite };
  } catch (e) {
    await vite.close();
    throw e;
  }
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>이 방식으로 빌드된 파일이 있을 때는 Vite 인스턴스를 생성하지 않고, 개발 시에만 필요할 때 생성하여 모든 작업 완료 후 정리하도록 했습니다.</p>
<h4 id="2-실제-운영-환경-문제를-고려한-상태-격리-구현"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-실제-운영-환경-문제를-고려한-상태-격리-구현"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. 실제 운영 환경 문제를 고려한 상태 격리 구현</h4>
<p>실제 회사에서 겪은 Nuxt2 Vuex 스토어 공유 문제를 바탕으로, 처음부터 상태 격리를 염두에 두고 구현했습니다:</p>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// entry-server.tsx에서 각 요청마다 독립적인 인스턴스 생성</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./core/router/instance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> module<span class="token punctuation">.</span>router<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// 매번 새로운 라우트 등록으로 상태 격리</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> Home<span class="token punctuation">.</span>PageComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">    getServerSideProps<span class="token operator">:</span> Home<span class="token punctuation">.</span>getServerSideProps<span class="token punctuation">,</span>
</span><span class="code-line">    generateMetaData<span class="token operator">:</span> Home<span class="token punctuation">.</span>generateMetaData<span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// 매번 새로운 productStore 인스턴스 생성</span>
</span><span class="code-line">  <span class="token keyword">const</span> productStore <span class="token operator">=</span> <span class="token function">createProductStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// entry-server.tsx에서 각 요청마다 독립적인 인스턴스 생성
export const render = async (url: string) =&gt; {
  const router = await import(&quot;./core/router/instance&quot;).then((module) =&gt; module.router);

  // 매번 새로운 라우트 등록으로 상태 격리
  router.addRoute(&quot;/&quot;, Home.PageComponent, {
    getServerSideProps: Home.getServerSideProps,
    generateMetaData: Home.generateMetaData,
  });

  // 매번 새로운 productStore 인스턴스 생성
  const productStore = createProductStore({...});
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>실제 운영 환경의 교훈을 반영한 설계</strong></p>
<ul>
<li>메타프레임워크도 완벽하지 않다는 인식 하에 처음부터 상태 격리 고려</li>
<li>각 SSR 요청마다 완전히 독립적인 컨텍스트 생성</li>
<li>동시 사용자 환경에서의 안전성을 최우선으로 고려</li>
</ul>
<h3 id="개선하고-싶은-부분"><a class="anchor" aria-hidden="true" tabindex="-1" href="#개선하고-싶은-부분"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>개선하고 싶은 부분</h3>
<h4 id="1-ssr-상태-격리-방식의-근본적-개선"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-ssr-상태-격리-방식의-근본적-개선"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. SSR 상태 격리 방식의 근본적 개선</h4>
<p>현재는 각 요청마다 라우트를 재등록하는 방식으로 임시 해결했지만, 이는 성능상 오버헤드가 있습니다. Router Factory 패턴을 완전히 구현하여 각 요청마다 독립적인 router 인스턴스를 생성하는 방식으로 개선하고 싶습니다.</p>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// 현재 방식 (임시 해결)</span>
</span><span class="code-line">router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> Home<span class="token punctuation">.</span>PageComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token string">&quot;/product/:id/&quot;</span><span class="token punctuation">,</span> ProductDetail<span class="token punctuation">.</span>PageComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 개선하고 싶은 방식</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token function-variable function">createSSRRouter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UniversalRouter</span><span class="token punctuation">(</span><span class="token constant">BASE_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token comment">// 라우트 설정을 미리 등록한 독립적인 인스턴스 반환</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token function">setupRoutes</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// 현재 방식 (임시 해결)
router.addRoute(&quot;/&quot;, Home.PageComponent, { ... });
router.addRoute(&quot;/product/:id/&quot;, ProductDetail.PageComponent, { ... });

// 개선하고 싶은 방식
const createSSRRouter = () =&gt; {
  const router = new UniversalRouter(BASE_URL);
  // 라우트 설정을 미리 등록한 독립적인 인스턴스 반환
  return setupRoutes(router);
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h4 id="2-에러-처리의-세분화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-에러-처리의-세분화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. 에러 처리의 세분화</h4>
<p>현재는 단순한 try-catch 구조로 모든 에러를 동일하게 처리하고 있는데, 에러 타입별로 다른 처리 전략을 적용하고 싶습니다:</p>
<ul>
<li>네트워크 에러: 재시도 로직</li>
<li>렌더링 에러: Fallback 페이지 제공</li>
<li>데이터 에러: 기본값으로 대체</li>
</ul>
<h4 id="3-성능-모니터링-시스템-구축"><a class="anchor" aria-hidden="true" tabindex="-1" href="#3-성능-모니터링-시스템-구축"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>3. 성능 모니터링 시스템 구축</h4>
<p>SSR/SSG 과정에서 발생하는 성능 메트릭을 수집하고 분석할 수 있는 시스템을 구축하고 싶습니다:</p>
<ul>
<li>렌더링 시간 측정</li>
<li>메모리 사용량 추적</li>
<li>API 호출 횟수 및 응답 시간 모니터링</li>
</ul>
<h3 id="리팩토링-계획"><a class="anchor" aria-hidden="true" tabindex="-1" href="#리팩토링-계획"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>리팩토링 계획</h3>
<h4 id="1-router-아키텍처-개선"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-router-아키텍처-개선"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. Router 아키텍처 개선</h4>
<ul>
<li><strong>Router Factory 패턴</strong>: 각 SSR 요청마다 독립적인 router 인스턴스 생성</li>
<li><strong>타입 안전성 강화</strong>: 라우트 매개변수와 컴포넌트 props 간의 타입 일관성 보장</li>
</ul>
<h4 id="2-성능-최적화-우선순위"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-성능-최적화-우선순위"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. 성능 최적화 우선순위</h4>
<ul>
<li><strong>캐싱 전략</strong>: 렌더링 결과와 API 응답 캐싱</li>
<li><strong>번들 최적화</strong>: 코드 스플리팅으로 초기 로딩 시간 단축</li>
</ul>
<h2 id="학습-연계"><a class="anchor" aria-hidden="true" tabindex="-1" href="#학습-연계"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>학습 연계</h2>
<h3 id="다음-학습-목표"><a class="anchor" aria-hidden="true" tabindex="-1" href="#다음-학습-목표"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>다음 학습 목표</h3>
<h4 id="1-streaming-ssr-구현-방안"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-streaming-ssr-구현-방안"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. Streaming SSR 구현 방안</h4>
<p><strong>React 18 Suspense 기반 스트리밍</strong></p>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// entry-server.tsx에서 스트리밍 렌더링</span>
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> renderToPipeableStream <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;react-dom/server&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">renderStream</span> <span class="token operator">=</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> pipe<span class="token punctuation">,</span> abort <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">renderToPipeableStream</span><span class="token punctuation">(</span>
</span><span class="code-line">      <span class="token operator">&lt;</span>App url<span class="token operator">=</span><span class="token punctuation">{</span>url<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">{</span>
</span><span class="code-line">        bootstrapScripts<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#x27;/assets/client.js&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token function">onShellReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token comment">// 초기 HTML shell을 즉시 스트리밍</span>
</span><span class="code-line">          <span class="token function">resolve</span><span class="token punctuation">(</span>pipe<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token function">onAllReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token comment">// 모든 Suspense boundary가 완료됨</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token function">onError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 컴포넌트에서 Suspense 활용</span>
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">ProductPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> productId <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>상품 페이지<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token operator">&lt;</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&lt;</span>ProductSkeleton <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
</span><span class="code-line">        <span class="token operator">&lt;</span>ProductDetail productId<span class="token operator">=</span><span class="token punctuation">{</span>productId<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token operator">&lt;</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&lt;</span>ReviewsSkeleton <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
</span><span class="code-line">        <span class="token operator">&lt;</span>ProductReviews productId<span class="token operator">=</span><span class="token punctuation">{</span>productId<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
</span><span class="code-line">    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</span><span class="code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// entry-server.tsx에서 스트리밍 렌더링
import { renderToPipeableStream } from &#x27;react-dom/server&#x27;;

export const renderStream = (url: string) =&gt; {
  return new Promise((resolve, reject) =&gt; {
    const { pipe, abort } = renderToPipeableStream(
      &lt;App url={url} /&gt;,
      {
        bootstrapScripts: [&#x27;/assets/client.js&#x27;],
        onShellReady() {
          // 초기 HTML shell을 즉시 스트리밍
          resolve(pipe);
        },
        onAllReady() {
          // 모든 Suspense boundary가 완료됨
        },
        onError(error) {
          reject(error);
        }
      }
    );
  });
};

// 컴포넌트에서 Suspense 활용
function ProductPage({ productId }) {
  return (
    &lt;div&gt;
      &lt;h1&gt;상품 페이지&lt;/h1&gt;
      &lt;Suspense fallback={&lt;ProductSkeleton /&gt;}&gt;
        &lt;ProductDetail productId={productId} /&gt;
      &lt;/Suspense&gt;
      &lt;Suspense fallback={&lt;ReviewsSkeleton /&gt;}&gt;
        &lt;ProductReviews productId={productId} /&gt;
      &lt;/Suspense&gt;
    &lt;/div&gt;
  );
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>스트리밍의 장점</strong></p>
<ul>
<li>초기 HTML이 빠르게 전송되어 사용자가 즉시 콘텐츠를 볼 수 있음</li>
<li>무거운 데이터 로딩이 완료되기 전에도 페이지 구조 표시 가능</li>
<li>TTFB(Time to First Byte) 개선</li>
</ul>
<h4 id="2-isr-incremental-static-regeneration-구현"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-isr-incremental-static-regeneration-구현"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. ISR (Incremental Static Regeneration) 구현</h4>
<p><strong>캐시 기반 ISR 전략</strong></p>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// ISR 구현을 위한 캐시 매니저</span>
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">ISRCache</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">private</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">private</span> revalidateQueue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">async</span> <span class="token function">get</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> revalidateAfter<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> cached <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cached<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token comment">// 캐시 없음 - 새로 생성</span>
</span><span class="code-line">      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">generateAndCache</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">const</span> isStale <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> cached<span class="token punctuation">.</span>timestamp <span class="token operator">&gt;</span> revalidateAfter<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>isStale <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>revalidateQueue<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token comment">// 백그라운드에서 재생성 (stale-while-revalidate)</span>
</span><span class="code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span>revalidateQueue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">generateAndCache</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span>revalidateQueue<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">return</span> cached<span class="token punctuation">.</span>content<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">private</span> <span class="token keyword">async</span> <span class="token function">generateAndCache</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">generateContent</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">      content<span class="token punctuation">,</span>
</span><span class="code-line">      timestamp<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">return</span> content<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 사용 예시</span>
</span><span class="code-line">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#x27;/product/:id&#x27;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> productId <span class="token operator">=</span> c<span class="token punctuation">.</span>req<span class="token punctuation">.</span><span class="token function">param</span><span class="token punctuation">(</span><span class="token string">&#x27;id&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> cacheKey <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">product-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>productId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token keyword">await</span> isrCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">,</span> <span class="token number">3600000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1시간 후 재검증</span>
</span><span class="code-line">  <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// ISR 구현을 위한 캐시 매니저
class ISRCache {
  private cache = new Map();
  private revalidateQueue = new Set();

  async get(key: string, revalidateAfter: number) {
    const cached = this.cache.get(key);

    if (!cached) {
      // 캐시 없음 - 새로 생성
      return this.generateAndCache(key);
    }

    const isStale = Date.now() - cached.timestamp &gt; revalidateAfter;

    if (isStale &amp;&amp; !this.revalidateQueue.has(key)) {
      // 백그라운드에서 재생성 (stale-while-revalidate)
      this.revalidateQueue.add(key);
      this.generateAndCache(key).finally(() =&gt; {
        this.revalidateQueue.delete(key);
      });
    }

    return cached.content;
  }

  private async generateAndCache(key: string) {
    const content = await this.generateContent(key);
    this.cache.set(key, {
      content,
      timestamp: Date.now()
    });
    return content;
  }
}

// 사용 예시
app.get(&#x27;/product/:id&#x27;, async (c) =&gt; {
  const productId = c.req.param(&#x27;id&#x27;);
  const cacheKey = `product-${productId}`;

  const html = await isrCache.get(cacheKey, 3600000); // 1시간 후 재검증
  return c.html(html);
});
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>ISR의 핵심 개념</strong></p>
<ul>
<li><strong>Stale-While-Revalidate</strong>: 기존 캐시된 콘텐츠를 서빙하면서 백그라운드에서 새로 생성</li>
<li><strong>On-Demand Revalidation</strong>: 특정 이벤트(데이터 업데이트 등) 발생 시 즉시 재생성</li>
<li><strong>캐시 무효화</strong>: 관련 데이터 변경 시 해당 페이지들의 캐시 삭제</li>
</ul>
<p><strong>CMS 연동 시나리오</strong></p>
<ol>
<li><strong>CMS에서 레슨권 정보 수정</strong> → 웹훅 트리거</li>
<li><strong>무효화 API 호출</strong> → 해당 레슨권 캐시 삭제</li>
<li><strong>다음 사용자 요청</strong> → 새로운 데이터로 페이지 재생성</li>
<li><strong>이후 요청들</strong> → 캐시된 최신 페이지 서빙</li>
</ol>
<p><strong>예상 효과</strong></p>
<ul>
<li><strong>성능</strong>: 캐시된 페이지로 빠른 로딩 (&lt; 100ms)</li>
<li><strong>최신성</strong>: CMS 변경 시 즉시 반영</li>
<li><strong>비용 절약</strong>: 불필요한 재생성 최소화</li>
</ul>
<h3 id="실무-적용-계획"><a class="anchor" aria-hidden="true" tabindex="-1" href="#실무-적용-계획"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>실무 적용 계획</h3>
<!-- -->
<h2 id="리뷰-받고-싶은-내용"><a class="anchor" aria-hidden="true" tabindex="-1" href="#리뷰-받고-싶은-내용"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>리뷰 받고 싶은 내용</h2>
<h3 id="1-ssr-상태-격리-방식"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-ssr-상태-격리-방식"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. SSR 상태 격리 방식</h3>
<p>현재 <code>entry-server.tsx</code>에서 각 요청마다 라우트를 재등록하는 방식으로 상태 격리를 구현했는데, 이 방식이 성능상 문제가 없는지, 더 효율적인 대안이 있는지 확인 부탁드립니다.</p>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// packages/react/src/entry-server.tsx</span>
</span><span class="code-line">router
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> Home<span class="token punctuation">.</span>PageComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">    getServerSideProps<span class="token operator">:</span> Home<span class="token punctuation">.</span>getServerSideProps<span class="token punctuation">,</span>
</span><span class="code-line">    generateMetaData<span class="token operator">:</span> Home<span class="token punctuation">.</span>generateMetaData<span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token string">&quot;/product/:id/&quot;</span><span class="token punctuation">,</span> ProductDetail<span class="token punctuation">.</span>PageComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">    getServerSideProps<span class="token operator">:</span> ProductDetail<span class="token punctuation">.</span>getServerSideProps<span class="token punctuation">,</span>
</span><span class="code-line">    generateMetaData<span class="token operator">:</span> ProductDetail<span class="token punctuation">.</span>generateMetaData<span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// packages/react/src/entry-server.tsx
router
  .addRoute(&quot;/&quot;, Home.PageComponent, {
    getServerSideProps: Home.getServerSideProps,
    generateMetaData: Home.generateMetaData,
  })
  .addRoute(&quot;/product/:id/&quot;, ProductDetail.PageComponent, {
    getServerSideProps: ProductDetail.getServerSideProps,
    generateMetaData: ProductDetail.generateMetaData,
  });
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h3 id="2-vite-인스턴스-생명주기-관리"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-vite-인스턴스-생명주기-관리"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. Vite 인스턴스 생명주기 관리</h3>
<p><code>static-site-generate.ts</code>에서 Vite 인스턴스를 관리하는 방식이 대용량 SSG 생성 시에도 안정적으로 동작할지, 메모리 누수 가능성은 없는지 확인 부탁드립니다.</p>
<h3 id="3-universal-router-패턴"><a class="anchor" aria-hidden="true" tabindex="-1" href="#3-universal-router-패턴"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>3. Universal Router 패턴</h3>
<p>현재 구현한 Universal Router가 복잡한 라우팅 시나리오(중첩 라우트, 동적 임포트 등)에서도 안정적으로 동작할지, 개선할 부분이 있는지 의견 부탁드립니다.</p>
<h3 id="4-타입-안전성-개선"><a class="anchor" aria-hidden="true" tabindex="-1" href="#4-타입-안전성-개선"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>4. 타입 안전성 개선</h3>
<p>TypeScript 마이그레이션 과정에서 타입 정의가 불완전한 부분이나, 더 타입 안전하게 개선할 수 있는 부분이 있는지 검토 부탁드립니다.</p>
<h3 id="5-성능-최적화-우선순위"><a class="anchor" aria-hidden="true" tabindex="-1" href="#5-성능-최적화-우선순위"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>5. 성능 최적화 우선순위</h3>
<p>현재 식별한 성능 병목 지점들 중에서 실제 프로덕션 환경에서 우선적으로 개선해야 할 부분은 무엇인지, 효과적인 최적화 전략에 대한 의견 부탁드립니다.</p>
<h3 id="6-부하-테스트-및-성능-측정-전략"><a class="anchor" aria-hidden="true" tabindex="-1" href="#6-부하-테스트-및-성능-측정-전략"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>6. 부하 테스트 및 성능 측정 전략</h3>
<p>실제 상용 환경과 유사한 조건에서 SSR/SSG 성능을 측정하기 위한 부하 테스트 환경 구축 시 고려해야 할 사항들과, RPS/TPS 목표 수치 설정에 대한 의견 부탁드립니다. 특히 데이터베이스 부하와 프론트엔드 렌더링 부하를 동시에 테스트할 때의 모범 사례가 궁금합니다.</p>
<h3 id="7-레슨권-페이지-isr-구현-전략"><a class="anchor" aria-hidden="true" tabindex="-1" href="#7-레슨권-페이지-isr-구현-전략"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>7. 레슨권 페이지 ISR 구현 전략</h3>
<p>레슨권 구매 전시페이지에 ISR을 적용할 계획인데, CMS 웹훅을 통한 캐시 무효화 전략이 적절한지, 그리고 24시간 캐시 유지 시간이 비즈니스 요구사항에 맞는지 검토 부탁드립니다. 또한 레슨권별로 개별 캐시 무효화하는 방식 외에 더 효율적인 캐시 관리 방안이 있는지 의견 부탁드립니다.</p>
<p>현재 구현 및 고민사항:</p>
<ol>
<li>
<p><strong>SSG vs ISR 선택 배경</strong></p>
<ul>
<li>초기에는 SSG로 해결하려 했으나, 레슨권 정보가 자주 업데이트되는 특성상 ISR이 더 적합하다고 판단</li>
<li>CMS 툴에서 변경될 때마다 무조건 재빌드하는 것은 비효율적이라 생각</li>
<li>하지만 회사에서 개선해봤었던 Nuxt2 서비스에서 ISR 관련 문제를 겪은 경험이 있어 신중하게 접근 중</li>
</ul>
</li>
<li>
<p><strong>캐시 전략 관련 고민</strong></p>
<ul>
<li>가격 정보 변경 시 캐시 무효화 타이밍 (실시간 vs 배치)</li>
<li>재고가 있는 레슨권의 경우 실시간 재고 반영 vs 캐시 우선 전략</li>
<li>대량의 레슨권(1000개 이상)에서 ISR 재생성 비용 최적화 방안</li>
<li>CDN 캐시와 ISR 캐시의 동기화 전략</li>
<li>사용자별 맞춤 추천 레슨권의 캐시 관리</li>
</ul>
</li>
<li>
<p><strong>실제 마주한 문제점들</strong></p>
<ul>
<li>CMS 툴에서 변경될 때마다 무조건 재빌드하면 비용이 많이 발생</li>
<li>그날 마감숙제에서 생긴했던 캐시무효화 API를 쓰나 툴이라고</li>
<li>CMS 툴에서 변경됐을때 무효화 트리거시키는 부분은나 만들면 되지않을까 싶음</li>
</ul>
</li>
<li>
<p><strong>현재 고려 중인 해결 방안</strong></p>
<ul>
<li>레슨권 데이터 변경 유형별 캐시 전략 차별화:
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// 변경 유형별 캐시 정책 설정</span>
</span><span class="code-line"><span class="token keyword">const</span> cachePolicy <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  price<span class="token operator">:</span> <span class="token punctuation">{</span> revalidate<span class="token operator">:</span> <span class="token string">&#x27;realtime&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token comment">// 가격: 실시간 갱신</span>
</span><span class="code-line">  description<span class="token operator">:</span> <span class="token punctuation">{</span> revalidate<span class="token operator">:</span> <span class="token string">&#x27;batch&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 설명: 배치 처리</span>
</span><span class="code-line">  stock<span class="token operator">:</span> <span class="token punctuation">{</span> revalidate<span class="token operator">:</span> <span class="token string">&#x27;hybrid&#x27;</span> <span class="token punctuation">}</span>        <span class="token comment">// 재고: 하이브리드</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// 변경 유형별 캐시 정책 설정
const cachePolicy = {
  price: { revalidate: &#x27;realtime&#x27; },    // 가격: 실시간 갱신
  description: { revalidate: &#x27;batch&#x27; },  // 설명: 배치 처리
  stock: { revalidate: &#x27;hybrid&#x27; }        // 재고: 하이브리드
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
</li>
<li>캐시 무효화 우선순위 시스템 도입:
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// 우선순위 기반 캐시 무효화</span>
</span><span class="code-line"><span class="token keyword">const</span> invalidationPriority <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token constant">HIGH</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#x27;price&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;stock&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>           <span class="token comment">// 즉시 무효화</span>
</span><span class="code-line">  <span class="token constant">MEDIUM</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#x27;description&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;images&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// 배치 무효화</span>
</span><span class="code-line">  <span class="token constant">LOW</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#x27;reviews&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;ratings&#x27;</span><span class="token punctuation">]</span>         <span class="token comment">// 정기 무효화</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// 우선순위 기반 캐시 무효화
const invalidationPriority = {
  HIGH: [&#x27;price&#x27;, &#x27;stock&#x27;],           // 즉시 무효화
  MEDIUM: [&#x27;description&#x27;, &#x27;images&#x27;],  // 배치 무효화
  LOW: [&#x27;reviews&#x27;, &#x27;ratings&#x27;]         // 정기 무효화
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
</li>
</ul>
</li>
<li>
<p><strong>검토 요청사항</strong></p>
<ul>
<li>위와 같은 캐시 전략이 실제 운영환경에서 효과적일지</li>
<li>하이브리드 캐시 전략 (일부는 실시간, 일부는 배치)의 구현 복잡도 대비 효과</li>
<li>대규모 레슨권 데이터에서의 성능과 비용 최적화 방안</li>
<li>사용자 경험을 해치지 않으면서도 시스템 부하를 최소화할 수 있는 균형점</li>
</ul>
</li>
</ol></div></div><div class="overflow-auto mt-9"><div data-color-mode="dark" class="wmde-markdown wmde-markdown-color p-6 max-w-full" style="word-wrap:break-word;overflow-wrap:break-word"><h2 id="과제-피드백"><a class="anchor" aria-hidden="true" tabindex="-1" href="#과제-피드백"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>과제 피드백</h2>
<p>와 준형님 과제를 이렇게까지 잘 해주실줄은 생각도 못했네요!
너무 멋집니다!</p>
<p>관련해서 질문도 많이 주셨지만 질문들이 모두 저도고민이 많이 필요한 질문들인 것 같아요. 시간이 많이 필요할 것 같습니다 ㅜㅜ
나중에 준일 코치님  솔루션 코드를 보면서 비교를 해보시면 정답은 아니더라도 코치는 어떻게 생각했는지 알 수 있지 않을까 싶습니다.
근데 준형님이 너무 과제를 잘해주셔서 더이상 뭐를 제안드릴것이 있나 싶을 정도에요.
다시한번 멘토링 노트를 뒤적여볼 정도입니다.</p>
<p>그런데 오히려 제가 궁금한 것이 있는데 AI도구는 사용하신건가요? 사용하지 않으신건가요? 이게 일주일만에 가능한건가요? ㅎㅎ 정말 놀랍네요</p>
<h2 id="수고하셨습니다-자신있게-bp후보로-올립니다"><a class="anchor" aria-hidden="true" tabindex="-1" href="#수고하셨습니다-자신있게-bp후보로-올립니다"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>수고하셨습니다. 자신있게 BP후보로 올립니다.</h2>
<p>아무래도 신경쓰여서 준일님에게 과제의 의도에 맞게 답변 부탁드리니 아래와 같이 장문으로 정리해주셨습니다!!</p>
<h2 id="1-ssr-상태-격리-방식의-적절성-검토"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-ssr-상태-격리-방식의-적절성-검토"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(1) SSR 상태 격리 방식의 적절성 검토</h2>
<blockquote>
<p>현재 entry-server.tsx에서 각 요청마다 라우트를 재등록하는 방식으로 상태 격리를 구현했는데, 이 방식이 성능상 문제가 없는지, 더 효율적인 대안이 있는지 검토 부탁드립니다.</p>
</blockquote>
<p>라우터를 등록하는 부분 자체는 성능에 영향을 많이 주진 않는답니다 ㅎㅎ 개선을 한다고 해도 효과가 미미하달까..
다만 지금 router를 dynamic import 로 불러오고 있는데 이렇게 하더라도 자연스럽게 import된 결과물이 캐시되기 때문에, 매번 똑같은 인스턴스를 가르키게 되어요. router context로 만들어서 관리하는 의미가... 없는거죠 ㅠ</p>
<p>이런 방식으로 만들어서 관리할 수 있지 않을까 싶네요!</p>
<h3 id="router-factory"><a class="anchor" aria-hidden="true" tabindex="-1" href="#router-factory"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Router Factory</h3>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// router-factory.ts</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">createSSRRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> UniversalRouter <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UniversalRouter</span><span class="token punctuation">(</span><span class="token constant">BASE_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token comment">// 라우트 설정을 미리 구성된 템플릿에서 복사</span>
</span><span class="code-line">  <span class="token constant">ROUTE_CONFIGS</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>config <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>path<span class="token punctuation">,</span> config<span class="token punctuation">.</span>component<span class="token punctuation">,</span> config<span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token keyword">return</span> router<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// entry-server.tsx</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createSSRRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 매번 새로운 인스턴스</span>
</span><span class="code-line">  <span class="token keyword">const</span> productStore <span class="token operator">=</span> <span class="token function">createProductStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token comment">// 이제 라우트 재등록 불필요</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token keyword">await</span> router<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// router-factory.ts
export function createSSRRouter(): UniversalRouter {
  const router = new UniversalRouter(BASE_URL);
  
  // 라우트 설정을 미리 구성된 템플릿에서 복사
  ROUTE_CONFIGS.forEach(config =&gt; {
    router.addRoute(config.path, config.component, config.options);
  });
  
  return router;
}

// entry-server.tsx
export const render = async (url: string) =&gt; {
  const router = createSSRRouter(); // 매번 새로운 인스턴스
  const productStore = createProductStore();
  
  // 이제 라우트 재등록 불필요
  return await router.resolve(url);
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h3 id="context-isolation-패턴"><a class="anchor" aria-hidden="true" tabindex="-1" href="#context-isolation-패턴"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Context Isolation 패턴</h3>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// ssr-context.ts</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">SSRContext</span> <span class="token punctuation">{</span>
</span><span class="code-line">  router<span class="token operator">:</span> UniversalRouter<span class="token punctuation">;</span>
</span><span class="code-line">  store<span class="token operator">:</span> ProductStore<span class="token punctuation">;</span>
</span><span class="code-line">  request<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">    headers<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">createSSRContext</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> SSRContext <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span>
</span><span class="code-line">    router<span class="token operator">:</span> <span class="token function">createSSRRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    store<span class="token operator">:</span> <span class="token function">createProductStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    request<span class="token operator">:</span> <span class="token punctuation">{</span> url<span class="token punctuation">,</span> headers<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// ssr-context.ts
export interface SSRContext {
  router: UniversalRouter;
  store: ProductStore;
  request: {
    url: string;
    headers: Record&lt;string, string&gt;;
  };
}

export function createSSRContext(url: string): SSRContext {
  return {
    router: createSSRRouter(),
    store: createProductStore(),
    request: { url, headers: {} }
  };
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h2 id="2-vite-인스턴스-생명주기-관리의-안정성"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-vite-인스턴스-생명주기-관리의-안정성"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(2) Vite 인스턴스 생명주기 관리의 안정성</h2>
<blockquote>
<p>static-site-generate.ts에서 Vite 인스턴스를 관리하는 방식이 대용량 SSG 생성 시에도 안정적으로 동작할지, 메모리 누수 가능성은 없는지 확인 부탁드립니다.</p>
</blockquote>
<p>음... 저는 굳이 vite를 사용해야하나? 라는 의견인데요, ssg는 &quot;빌드된 CSR 결과물&quot;이 필요하기 때문에, csr로 미리 빌드해놓고 빌드된걸 가져다 사용하는 방식으로 하면 vite를 사용할 필요가 없다고 생각해요. 그리고 이런 과정으로 만들어야 더 정확하게 만들어질 수 있지 않나!? 라는 생각이 드네요!</p>
<p>개발 테스트를 위해 vite 인스턴스를 사용할 수 있으나, 대용량 생성을 개발모드에서 하는건 위험하지 않을까요!?</p>
<p>결론은... vite를 아예 안 쓰는 방향으로 만들어야한다고 생각합니다.</p>
<h2 id="3-universal-router-패턴의-확장성"><a class="anchor" aria-hidden="true" tabindex="-1" href="#3-universal-router-패턴의-확장성"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(3) Universal Router 패턴의 확장성</h2>
<blockquote>
<p>현재 구현한 Universal Router가 복잡한 라우팅 시나리오(중첩 라우트, 동적 임포트 등)에서도 안정적으로 동작할지, 개선할 부분이 있는지 조언 부탁드립니다.</p>
</blockquote>
<p>현재 구현은 기본적인 라우팅 요구사항을 충족하지만, 복잡한 시나리오에서는 확장이 필요합니다. 몇 가지 예시를 제시해볼게요!</p>
<h3 id="중첩-라우트-지원"><a class="anchor" aria-hidden="true" tabindex="-1" href="#중첩-라우트-지원"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>중첩 라우트 지원</h3>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token keyword">interface</span> <span class="token class-name">RouteConfig</span> <span class="token punctuation">{</span>
</span><span class="code-line">  path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">  component<span class="token operator">:</span> ComponentType<span class="token punctuation">;</span>
</span><span class="code-line">  children<span class="token operator">?</span><span class="token operator">:</span> RouteConfig<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  guards<span class="token operator">?</span><span class="token operator">:</span> RouteGuard<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  meta<span class="token operator">?</span><span class="token operator">:</span> RouteMeta<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">EnhancedUniversalRouter</span> <span class="token keyword">extends</span> <span class="token class-name">UniversalRouter</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">addNestedRoute</span><span class="token punctuation">(</span>config<span class="token operator">:</span> RouteConfig<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>path<span class="token punctuation">,</span> config<span class="token punctuation">.</span>component<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">      getServerSideProps<span class="token operator">:</span> config<span class="token punctuation">.</span>getServerSideProps<span class="token punctuation">,</span>
</span><span class="code-line">      generateMetaData<span class="token operator">:</span> config<span class="token punctuation">.</span>generateMetaData<span class="token punctuation">,</span>
</span><span class="code-line">      children<span class="token operator">:</span> config<span class="token punctuation">.</span>children<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token comment">// 중첩된 자식 라우트들도 재귀적으로 등록</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      config<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>child <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">const</span> childPath <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>child<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addNestedRoute</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>child<span class="token punctuation">,</span> path<span class="token operator">:</span> childPath <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="interface RouteConfig {
  path: string;
  component: ComponentType;
  children?: RouteConfig[];
  guards?: RouteGuard[];
  meta?: RouteMeta;
}

class EnhancedUniversalRouter extends UniversalRouter {
  addNestedRoute(config: RouteConfig): void {
    this.addRoute(config.path, config.component, {
      getServerSideProps: config.getServerSideProps,
      generateMetaData: config.generateMetaData,
      children: config.children,
    });
    
    // 중첩된 자식 라우트들도 재귀적으로 등록
    if (config.children) {
      config.children.forEach(child =&gt; {
        const childPath = `${config.path}${child.path}`;
        this.addNestedRoute({ ...child, path: childPath });
      });
    }
  }
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>... (135줄 남음)
접기
message.txt
11KB
shiren — 오후 5:45
헉...........
이렇게까지 감사합니다!!!! 준일님!!
﻿
ᓚ₍ ^. ̫ .^₎
황준일
junil.hwang</p>
<h2 id="1-ssr-상태-격리-방식의-적절성-검토-1"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-ssr-상태-격리-방식의-적절성-검토-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(1) SSR 상태 격리 방식의 적절성 검토</h2>
<blockquote>
<p>현재 entry-server.tsx에서 각 요청마다 라우트를 재등록하는 방식으로 상태 격리를 구현했는데, 이 방식이 성능상 문제가 없는지, 더 효율적인 대안이 있는지 검토 부탁드립니다.</p>
</blockquote>
<p>라우터를 등록하는 부분 자체는 성능에 영향을 많이 주진 않는답니다 ㅎㅎ 개선을 한다고 해도 효과가 미미하달까..
다만 지금 router를 dynamic import 로 불러오고 있는데 이렇게 하더라도 자연스럽게 import된 결과물이 캐시되기 때문에, 매번 똑같은 인스턴스를 가르키게 되어요. router context로 만들어서 관리하는 의미가... 없는거죠 ㅠ</p>
<p>이런 방식으로 만들어서 관리할 수 있지 않을까 싶네요!</p>
<h3 id="router-factory-1"><a class="anchor" aria-hidden="true" tabindex="-1" href="#router-factory-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Router Factory</h3>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// router-factory.ts</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">createSSRRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> UniversalRouter <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UniversalRouter</span><span class="token punctuation">(</span><span class="token constant">BASE_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token comment">// 라우트 설정을 미리 구성된 템플릿에서 복사</span>
</span><span class="code-line">  <span class="token constant">ROUTE_CONFIGS</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>config <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>path<span class="token punctuation">,</span> config<span class="token punctuation">.</span>component<span class="token punctuation">,</span> config<span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token keyword">return</span> router<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// entry-server.tsx</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createSSRRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 매번 새로운 인스턴스</span>
</span><span class="code-line">  <span class="token keyword">const</span> productStore <span class="token operator">=</span> <span class="token function">createProductStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token comment">// 이제 라우트 재등록 불필요</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token keyword">await</span> router<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// router-factory.ts
export function createSSRRouter(): UniversalRouter {
  const router = new UniversalRouter(BASE_URL);
  
  // 라우트 설정을 미리 구성된 템플릿에서 복사
  ROUTE_CONFIGS.forEach(config =&gt; {
    router.addRoute(config.path, config.component, config.options);
  });
  
  return router;
}

// entry-server.tsx
export const render = async (url: string) =&gt; {
  const router = createSSRRouter(); // 매번 새로운 인스턴스
  const productStore = createProductStore();
  
  // 이제 라우트 재등록 불필요
  return await router.resolve(url);
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h3 id="context-isolation-패턴-1"><a class="anchor" aria-hidden="true" tabindex="-1" href="#context-isolation-패턴-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Context Isolation 패턴</h3>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// ssr-context.ts</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">SSRContext</span> <span class="token punctuation">{</span>
</span><span class="code-line">  router<span class="token operator">:</span> UniversalRouter<span class="token punctuation">;</span>
</span><span class="code-line">  store<span class="token operator">:</span> ProductStore<span class="token punctuation">;</span>
</span><span class="code-line">  request<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">    headers<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">createSSRContext</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> SSRContext <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span>
</span><span class="code-line">    router<span class="token operator">:</span> <span class="token function">createSSRRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    store<span class="token operator">:</span> <span class="token function">createProductStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    request<span class="token operator">:</span> <span class="token punctuation">{</span> url<span class="token punctuation">,</span> headers<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// ssr-context.ts
export interface SSRContext {
  router: UniversalRouter;
  store: ProductStore;
  request: {
    url: string;
    headers: Record&lt;string, string&gt;;
  };
}

export function createSSRContext(url: string): SSRContext {
  return {
    router: createSSRRouter(),
    store: createProductStore(),
    request: { url, headers: {} }
  };
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h2 id="2-vite-인스턴스-생명주기-관리의-안정성-1"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-vite-인스턴스-생명주기-관리의-안정성-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(2) Vite 인스턴스 생명주기 관리의 안정성</h2>
<blockquote>
<p>static-site-generate.ts에서 Vite 인스턴스를 관리하는 방식이 대용량 SSG 생성 시에도 안정적으로 동작할지, 메모리 누수 가능성은 없는지 확인 부탁드립니다.</p>
</blockquote>
<p>음... 저는 굳이 vite를 사용해야하나? 라는 의견인데요, ssg는 &quot;빌드된 CSR 결과물&quot;이 필요하기 때문에, csr로 미리 빌드해놓고 빌드된걸 가져다 사용하는 방식으로 하면 vite를 사용할 필요가 없다고 생각해요. 그리고 이런 과정으로 만들어야 더 정확하게 만들어질 수 있지 않나!? 라는 생각이 드네요!</p>
<p>개발 테스트를 위해 vite 인스턴스를 사용할 수 있으나, 대용량 생성을 개발모드에서 하는건 위험하지 않을까요!?</p>
<p>결론은... vite를 아예 안 쓰는 방향으로 만들어야한다고 생각합니다.</p>
<h2 id="3-universal-router-패턴의-확장성-1"><a class="anchor" aria-hidden="true" tabindex="-1" href="#3-universal-router-패턴의-확장성-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(3) Universal Router 패턴의 확장성</h2>
<blockquote>
<p>현재 구현한 Universal Router가 복잡한 라우팅 시나리오(중첩 라우트, 동적 임포트 등)에서도 안정적으로 동작할지, 개선할 부분이 있는지 조언 부탁드립니다.</p>
</blockquote>
<p>현재 구현은 기본적인 라우팅 요구사항을 충족하지만, 복잡한 시나리오에서는 확장이 필요합니다. 몇 가지 예시를 제시해볼게요!</p>
<h3 id="중첩-라우트-지원-1"><a class="anchor" aria-hidden="true" tabindex="-1" href="#중첩-라우트-지원-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>중첩 라우트 지원</h3>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token keyword">interface</span> <span class="token class-name">RouteConfig</span> <span class="token punctuation">{</span>
</span><span class="code-line">  path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">  component<span class="token operator">:</span> ComponentType<span class="token punctuation">;</span>
</span><span class="code-line">  children<span class="token operator">?</span><span class="token operator">:</span> RouteConfig<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  guards<span class="token operator">?</span><span class="token operator">:</span> RouteGuard<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">  meta<span class="token operator">?</span><span class="token operator">:</span> RouteMeta<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">EnhancedUniversalRouter</span> <span class="token keyword">extends</span> <span class="token class-name">UniversalRouter</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">addNestedRoute</span><span class="token punctuation">(</span>config<span class="token operator">:</span> RouteConfig<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>path<span class="token punctuation">,</span> config<span class="token punctuation">.</span>component<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">      getServerSideProps<span class="token operator">:</span> config<span class="token punctuation">.</span>getServerSideProps<span class="token punctuation">,</span>
</span><span class="code-line">      generateMetaData<span class="token operator">:</span> config<span class="token punctuation">.</span>generateMetaData<span class="token punctuation">,</span>
</span><span class="code-line">      children<span class="token operator">:</span> config<span class="token punctuation">.</span>children<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token comment">// 중첩된 자식 라우트들도 재귀적으로 등록</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      config<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>child <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">const</span> childPath <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>child<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addNestedRoute</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>child<span class="token punctuation">,</span> path<span class="token operator">:</span> childPath <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="interface RouteConfig {
  path: string;
  component: ComponentType;
  children?: RouteConfig[];
  guards?: RouteGuard[];
  meta?: RouteMeta;
}

class EnhancedUniversalRouter extends UniversalRouter {
  addNestedRoute(config: RouteConfig): void {
    this.addRoute(config.path, config.component, {
      getServerSideProps: config.getServerSideProps,
      generateMetaData: config.generateMetaData,
      children: config.children,
    });
    
    // 중첩된 자식 라우트들도 재귀적으로 등록
    if (config.children) {
      config.children.forEach(child =&gt; {
        const childPath = `${config.path}${child.path}`;
        this.addNestedRoute({ ...child, path: childPath });
      });
    }
  }
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h3 id="동적-임포트-지원"><a class="anchor" aria-hidden="true" tabindex="-1" href="#동적-임포트-지원"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>동적 임포트 지원</h3>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token keyword">interface</span> <span class="token class-name">LazyRouteConfig</span> <span class="token punctuation">{</span>
</span><span class="code-line">  path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> ComponentType <span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line">  getServerSideProps<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">LazyRouter</span> <span class="token keyword">extends</span> <span class="token class-name">EnhancedUniversalRouter</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">async</span> <span class="token function">addLazyRoute</span><span class="token punctuation">(</span>config<span class="token operator">:</span> LazyRouteConfig<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> componentPromise <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>path<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> Component <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> componentPromise<span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token keyword">return</span> <span class="token function">Component</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">      getServerSideProps<span class="token operator">:</span> config<span class="token punctuation">.</span>getServerSideProps<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="interface LazyRouteConfig {
  path: string;
  component: () =&gt; Promise&lt;{ default: ComponentType }&gt;;
  getServerSideProps?: () =&gt; Promise&lt;any&gt;;
}

class LazyRouter extends EnhancedUniversalRouter {
  async addLazyRoute(config: LazyRouteConfig): Promise&lt;void&gt; {
    const componentPromise = config.component();
    
    this.addRoute(config.path, async (context) =&gt; {
      const { default: Component } = await componentPromise;
      return Component(context);
    }, {
      getServerSideProps: config.getServerSideProps,
    });
  }
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h3 id="라우트-가드-및-미들웨어"><a class="anchor" aria-hidden="true" tabindex="-1" href="#라우트-가드-및-미들웨어"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>라우트 가드 및 미들웨어</h3>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token keyword">type</span> <span class="token class-name">RouteGuard</span> <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token operator">:</span> RouteContext<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">interface</span> <span class="token class-name">RouteContext</span> <span class="token punctuation">{</span>
</span><span class="code-line">  path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line">  params<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line">  query<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line">  headers<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">GuardedRouter</span> <span class="token keyword">extends</span> <span class="token class-name">LazyRouter</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">async</span> <span class="token function">resolve</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> match <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findRoute</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>match<span class="token operator">?.</span>guards<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> guard <span class="token keyword">of</span> match<span class="token punctuation">.</span>guards<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword">const</span> canActivate <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">guard</span><span class="token punctuation">(</span>match<span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>canActivate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Route access denied: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="type RouteGuard = (context: RouteContext) =&gt; boolean | Promise&lt;boolean&gt;;

interface RouteContext {
  path: string;
  params: Record&lt;string, string&gt;;
  query: Record&lt;string, string&gt;;
  headers: Record&lt;string, string&gt;;
}

class GuardedRouter extends LazyRouter {
  async resolve(url: string): Promise&lt;string&gt; {
    const match = this.findRoute(url);
    
    if (match?.guards) {
      for (const guard of match.guards) {
        const canActivate = await guard(match.context);
        if (!canActivate) {
          throw new Error(`Route access denied: ${url}`);
        }
      }
    }
    
    return super.resolve(url);
  }
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h3 id="권장-확장-구조"><a class="anchor" aria-hidden="true" tabindex="-1" href="#권장-확장-구조"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>권장 확장 구조</h3>
<pre class="language-typescript"><code class="language-typescript code-highlight"><span class="code-line"><span class="token comment">// routes/index.ts</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> routeConfigs<span class="token operator">:</span> RouteConfig<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">  <span class="token punctuation">{</span>
</span><span class="code-line">    path<span class="token operator">:</span> <span class="token string">&#x27;/&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    component<span class="token operator">:</span> Home<span class="token punctuation">.</span>PageComponent<span class="token punctuation">,</span>
</span><span class="code-line">    getServerSideProps<span class="token operator">:</span> Home<span class="token punctuation">.</span>getServerSideProps<span class="token punctuation">,</span>
</span><span class="code-line">    generateMetaData<span class="token operator">:</span> Home<span class="token punctuation">.</span>generateMetaData<span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">{</span>
</span><span class="code-line">    path<span class="token operator">:</span> <span class="token string">&#x27;/product&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">    component<span class="token operator">:</span> ProductLayout<span class="token punctuation">,</span>
</span><span class="code-line">    children<span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-line">      <span class="token punctuation">{</span>
</span><span class="code-line">        path<span class="token operator">:</span> <span class="token string">&#x27;/:id&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">        component<span class="token operator">:</span> ProductDetail<span class="token punctuation">.</span>PageComponent<span class="token punctuation">,</span>
</span><span class="code-line">        getServerSideProps<span class="token operator">:</span> ProductDetail<span class="token punctuation">.</span>getServerSideProps<span class="token punctuation">,</span>
</span><span class="code-line">        guards<span class="token operator">:</span> <span class="token punctuation">[</span>authGuard<span class="token punctuation">,</span> productExistsGuard<span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">{</span>
</span><span class="code-line">        path<span class="token operator">:</span> <span class="token string">&#x27;/:id/reviews&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#x27;./ProductReviews&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>m <span class="token operator">=&gt;</span> m<span class="token punctuation">.</span>default<span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line"><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// routes/index.ts
export const routeConfigs: RouteConfig[] = [
  {
    path: &#x27;/&#x27;,
    component: Home.PageComponent,
    getServerSideProps: Home.getServerSideProps,
    generateMetaData: Home.generateMetaData,
  },
  {
    path: &#x27;/product&#x27;,
    component: ProductLayout,
    children: [
      {
        path: &#x27;/:id&#x27;,
        component: ProductDetail.PageComponent,
        getServerSideProps: ProductDetail.getServerSideProps,
        guards: [authGuard, productExistsGuard],
      },
      {
        path: &#x27;/:id/reviews&#x27;,
        component: () =&gt; import(&#x27;./ProductReviews&#x27;).then(m =&gt; m.default),
      }
    ],
  },
];
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>사실 기존에 잘 작성된 라우터를 참고해보면 좋습니다 ㅎㅎ react-router 를 참고해본다거나..!?</p>
<h2 id="4-타입-안전성-개선-방안"><a class="anchor" aria-hidden="true" tabindex="-1" href="#4-타입-안전성-개선-방안"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(4) 타입 안전성 개선 방안</h2>
<blockquote>
<p>TypeScript 마이그레이션 과정에서 타입 정의가 불완전한 부분이나, 더 타입 안전하게 개선할 수 있는 부분이 있는지 검토해주세요.</p>
</blockquote>
<p>음... 이건 AI가 남긴 것 같은 질문이네요 ㅋㅋ 전체적인 내용을 훑어보기는 어려운것 같아요. 준형님께서 개선하고 싶은 타입을 언급해주시면 이에 대한 답변은 드릴 수 있을 것 같습니다. 이야기하자면 끝이 없다보니...</p>
<h2 id="5-성능-최적화-우선순위"><a class="anchor" aria-hidden="true" tabindex="-1" href="#5-성능-최적화-우선순위"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(5) 성능 최적화 우선순위</h2>
<blockquote>
<p>현재 식별한 성능 병목 지점들 중에서 실제 프로덕션 환경에서 우선적으로 개선해야 할 부분은 무엇인지, 효과적인 최적화 전략에 대한 조언 부탁드립니다.</p>
</blockquote>
<p>성능 개선이라기보단, 첫 번째 질문에서 언급한 router에 대한 부분과 ssg를 사용할 때 vite를 쓰는 부분을 개선해야한다고 생각해요.</p>
<ol>
<li>라우터 등록 오버헤드는 큰 이슈는 아닌 것 같아서 패스해도 무방해보입니다.</li>
<li>ssg 생성시 vite를 아예 안 쓰도록 해주세요. 빌드된걸 사용하면 고민할 필요가 없는 문제일 것 같아요.</li>
<li>상품 직렬화는 성능개선이라기보단 설계와 가까운 부분인데, 이것도 nextjs 같은 친구들이 어떤방식으로 사용하고 있는지 참고해보면 좋겠습니다.</li>
<li>대량의 상품 페이지 SSG 생성 시 메모리 사용량 증가는 사실 당연한 것 같아요 ㅎㅎ 메모리 사용량을 줄이려면 10개씩 묶어서 생성한다거나 혹은 정말 필요한 페이지만 ssg로 만들어서 사용하는 방법이 있답니다! 모든 페이지를 만들어서 사용할 필요가 없어요..! 이건 비즈니스에 대한 전략이 필요하다고 생각해요.</li>
</ol>
<h2 id="6-부하-테스트-및-성능-측정-전략"><a class="anchor" aria-hidden="true" tabindex="-1" href="#6-부하-테스트-및-성능-측정-전략"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(6) 부하 테스트 및 성능 측정 전략</h2>
<blockquote>
<p>실제 상용 환경과 유사한 조건에서 SSR/SSG 성능을 측정하기 위한 부하 테스트 환경 구축 시 고려해야 할 사항들과, RPS/TPS 목표 수치 설정에 대한 조언 부탁드립니다. 특히 데이터베이스 부하와 프론트엔드 렌더링 부하를 동시에 테스트할 때의 모범 사례가 궁금합니다.</p>
</blockquote>
<p>프론트엔드에서 DB 부하를 테스트할 필요가 있을까요? 이건 별도의 테스트가 필요하다고 생각해요.
프론트엔드 렌더링 부하의 경우에는... 사실 매번 렌더링을 해서 사용하기보단 보통 캐시를 사용하고 실시간으로 구성이 필요하다면 SSR이 아니라 CSR로 구성해야 한다고 생각합니다.</p>
<p>RPS/TPS 에 대한 수치는 <a href="https://partnerjun.tistory.com/95">https://partnerjun.tistory.com/95</a> 이 블로그를 참고해주세요!</p>
<p>인스턴스 하나가 얼만큼의 트래픽을 버텨낼 수 있는지 측정한 다음에 Scale in / out 을 하는 방식으로 관리할 수 있을 것 같습니다.</p>
<p>그리고 모든 페이지에 대해 SSR을 할 것인지, SSG를 할 것인지에 대한 의사결정도 필요해요. 단순히 성능최적화 해야지! 라는 전략보단... 어떤 페이지에 대해 어떤 목적으로 최적화를 할지에 대한 의사결정이 선행되어야할 것 같습니다.</p>
<h2 id="7-레슨권-페이지-isr-구현-전략-검토"><a class="anchor" aria-hidden="true" tabindex="-1" href="#7-레슨권-페이지-isr-구현-전략-검토"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>(7) 레슨권 페이지 ISR 구현 전략 검토</h2>
<blockquote>
<p>레슨권 구매 전시페이지에 ISR을 적용할 계획인데, CMS 웹훅을 통한 캐시 무효화 전략이 적절한지, 그리고 24시간 캐시 유지 시간이 비즈니스 요구사항에 맞는지 검토 부탁드립니다. 또한 레슨권별로 개별 캐시 무효화하는 방식 외에 더 효율적인 캐시 관리 방안이 있는지 조언해주세요.</p>
</blockquote>
<p>고정되는 부분과 고정되지 않는 부분을 고려해서 일부분은 Client에서 API로 불러와서 그리도록 하면 어떨까 싶어요.
제안해주신 것 처럼 CMS 툴에서 초기화한 다음에 다시 빌드하는 방법도 좋을 것 같은데, 아예 매번 빌드를 하기보다 api 캐시만 갱신하고 (데이터만 다시 생성해주고), 그 다음에 API를 호출해서 client 에서 렌더링하면 ssg의 장점과 csr의 장점을 함께 누릴 수 있을 것 같네요!</p>
<p>아니면 만들어야 하는 페이지가 많지 않다면 그냥 대략 30 ~ 60초마다 SSR에서 만들어서 캐싱해주면 어떨까 싶기도합니다!
캐싱된 결과물을 레디스에 올려놓고 사용한다거나!?</p></div></div><div class="mt-9"></div></div></main></div></div></div></div>
</body>
</html>
