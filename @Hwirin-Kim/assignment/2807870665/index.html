<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="/front_6th/favicon.ico"/>
  
    <title>[1팀 김휘린] Chapter 4-2 코드 관점의 성능 최적화 - 김휘린 | 항해플러스 프론트엔드 6기</title>
    <meta name="description" content=" [항해플러스 프론트엔드 6기] 김휘린님이 제출한 [1팀 김휘린] Chapter 4-2 코드 관점의 성능 최적화 과제를 확인하세요. 코드 구현, 문제 해결 과정, 피드백 내용을 상세히 살펴볼 수 있습니다." />
    <meta name="keywords" content="항해플러스, 프론트엔드, 개발자교육, React, TypeScript, JavaScript, 기술면접, 웹개발, 김휘린, [1팀 김휘린] Chapter 4-2 코드 관점의 성능 최적화, 과제상세, 코드리뷰, 피드백, Pull Request" />
    <meta property="og:title" content="[1팀 김휘린] Chapter 4-2 코드 관점의 성능 최적화 - 김휘린 | 항해플러스 프론트엔드 6기" />
    <meta property="og:description" content=" [항해플러스 프론트엔드 6기] 김휘린님이 제출한 [1팀 김휘린] Chapter 4-2 코드 관점의 성능 최적화 과제를 확인하세요. 코드 구현, 문제 해결 과정, 피드백 내용을 상세히 살펴볼 수 있습니다." />
    <meta property="og:image" content="/defaultThumbnail.jpg" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="[1팀 김휘린] Chapter 4-2 코드 관점의 성능 최적화 - 김휘린 | 항해플러스 프론트엔드 6기" />
    <meta name="twitter:description" content=" [항해플러스 프론트엔드 6기] 김휘린님이 제출한 [1팀 김휘린] Chapter 4-2 코드 관점의 성능 최적화 과제를 확인하세요. 코드 구현, 문제 해결 과정, 피드백 내용을 상세히 살펴볼 수 있습니다." />
    <meta name="twitter:image" content="/defaultThumbnail.jpg" />
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-6J8QP7YK1E"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-6J8QP7YK1E');
  </script>
  <script type="module" crossorigin src="/front_6th/assets/index-B12XiTr6.js"></script>
  <link rel="stylesheet" crossorigin href="/front_6th/assets/index-BXO68frB.css">
</head>
<body>
<div id="root"><div data-slot="sidebar-wrapper" style="--sidebar-width:16rem;--sidebar-width-icon:3rem" class="group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full"><div class="min-h-screen flex w-full"><div class="group peer text-sidebar-foreground hidden md:block" data-state="expanded" data-collapsible="" data-variant="sidebar" data-side="left" data-slot="sidebar"><div data-slot="sidebar-gap" class="relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear group-data-[collapsible=offcanvas]:w-0 group-data-[side=right]:rotate-180 group-data-[collapsible=icon]:w-(--sidebar-width-icon)"></div><div data-slot="sidebar-container" class="fixed inset-y-0 z-10 hidden h-svh transition-[left,right,width] duration-200 ease-linear md:flex left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)] group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l w-64"><div data-sidebar="sidebar" data-slot="sidebar-inner" class="bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm"><div data-slot="sidebar-content" data-sidebar="content" class="flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden bg-card border-r border-border"><a class="p-4" href="/front_6th/" data-discover="true"><div class="flex items-center space-x-2 mb-6"><div class="w-8 h-8 bg-gradient-primary rounded-lg flex items-center justify-center"><span class="text-white font-bold text-sm">6기</span></div><h4 class="text-lg font-bold text-primary">항해플러스 프론트엔드</h4></div></a><div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><div data-slot="sidebar-group-label" data-sidebar="group-label" class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground px-4">학습 관리</div><div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm"><ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-1 px-2"><li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative"><a data-slot="sidebar-menu-button" data-sidebar="menu-button" data-size="default" data-active="false" class="peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground text-sm h-12 text-foreground hover:bg-secondary hover:text-secondary-foreground rounded-lg transition-all duration-300" href="/front_6th/" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-users h-5 w-5" aria-hidden="true"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><path d="M16 3.128a4 4 0 0 1 0 7.744"></path><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><circle cx="9" cy="7" r="4"></circle></svg><span class="ml-3">수강생 목록</span></a></li><li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative"><a data-slot="sidebar-menu-button" data-sidebar="menu-button" data-size="default" data-active="false" class="peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground text-sm h-12 text-foreground hover:bg-secondary hover:text-secondary-foreground rounded-lg transition-all duration-300" href="/front_6th/assignments/" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open h-5 w-5" aria-hidden="true"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg><span class="ml-3">과제 목록</span></a></li></ul></div></div></div></div></div></div><div class="flex-1 min-w-0"><header class="h-12 flex items-center border-b border-border bg-card px-4"><button data-slot="sidebar-trigger" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-7 mr-4 text-white" data-sidebar="trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-panel-left" aria-hidden="true"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path></svg><span class="sr-only">Toggle Sidebar</span></button><h4 class="text-lg font-semibold "><a href="/front_6th/@Hwirin-Kim/" data-discover="true">Hwirin-Kim<!-- --> 님의 상세페이지</a> ＞ <!-- -->[1팀 김휘린] Chapter 4-2 코드 관점의 성능 최적화</h4></header><main class="p-6"><div><div class="card-wrap"><div data-slot="card" class="card text-card-foreground flex flex-col gap-6 shadow-sm mb-6 p-6 border border-gray-700 bg-gray-800 rounded-lg"><a href="https://github.com/hanghae-plus/front_6th_chapter4-2/pull/12" target="_blank"><div class="flex items-start gap-4"><div class="flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" height="32" aria-hidden="true" viewBox="0 0 24 24" width="32" fill="white" class="w-8 h-8"><path d="M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"></path></svg></div><div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-2"><h3 class="text-lg font-semibold text-white truncate">[1팀 김휘린] Chapter 4-2 코드 관점의 성능 최적화</h3></div><div class="flex items-center gap-4 text-xs text-gray-500"><span>by <!-- -->Hwirin-Kim</span><span>2025. 9. 8.</span></div></div></div></a></div></div><div class="overflow-auto"><div data-color-mode="dark" class="wmde-markdown wmde-markdown-color p-6 max-w-full" style="word-wrap:break-word;overflow-wrap:break-word"><h1 id="과제-체크포인트"><a class="anchor" aria-hidden="true" tabindex="-1" href="#과제-체크포인트"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>과제 체크포인트</h1>
<h2 id="배포"><a class="anchor" aria-hidden="true" tabindex="-1" href="#배포"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>배포</h2>
<p><a href="https://hwirin-kim.github.io/front_6th_chapter4-2/">https://hwirin-kim.github.io/front_6th_chapter4-2/</a></p>
<h2 id="과제-요구사항"><a class="anchor" aria-hidden="true" tabindex="-1" href="#과제-요구사항"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>과제 요구사항</h2>
<ul class="contains-task-list">
<li class="task-list-item">
<p><input type="checkbox" disabled="" checked=""/> 배포 후 url 제출</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled="" checked=""/> API 호출 최적화(<code>Promise.all</code> 이해)</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled="" checked=""/> SearchDialog 불필요한 연산 최적화</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled="" checked=""/> SearchDialog 불필요한 리렌더링 최적화</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled="" checked=""/> 시간표 블록 드래그시 렌더링 최적화</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled="" checked=""/> 시간표 블록 드롭시 렌더링 최적화</p>
</li>
</ul>
<h2 id="과제-셀프회고"><a class="anchor" aria-hidden="true" tabindex="-1" href="#과제-셀프회고"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>과제 셀프회고</h2>
<!-- -->
<p>이번 과제는 성능 최적화에 관한 부분으로 현업에서 일하며 흔하게 접할만한 상황들이 주어졌다.
특히 과제를 진행하며 어떻게 해야 좀 더 리렌더링을 유발하지 않는 습관이 생기는지 알듯한 느낌이였다.</p>
<p>이번 과제를 진행하며 사용한 방법은 콘솔로그활용 및 React Dev Tools의 하이라이팅을 주로 사용하였다.
하이라이팅을 쓰며 리렌더링 되는 부분을 시각적으로 확인하고, 좀 애매한 부분은 콘솔로 해당 컴포넌트가 정말 리렌더링 되는지 체크하는 방식을 사용했다.</p>
<h4 id="첫-번째-api-호출-최적화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#첫-번째-api-호출-최적화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>첫 번째 api 호출 최적화</h4>
<p>여기에는 크게 두 가지 문제가 있었다.
첫 번째는 Promise.all 안에서 promise를 넘기지 않고 await를 하여 대기하는 문제.
두 번째는 동일 api의 중복 호출이였다. (물론 일부러 그렇게 코드가 짜여져있었지만..)</p>
<p>첫 번째 케이스는 Promise.all내부에 await를 삭제함으로써 쉽게 해결했다.
두 번째 케이스는 호출을 캐싱하는 방법을 선택했다.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">axios<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">AxiosResponse</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> baseUrl <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&quot;../baseUrl&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">type <span class="token maybe-class-name">CacheEntry</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token literal-property property">promise</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&lt;</span><span class="token maybe-class-name">AxiosResponse</span><span class="token operator">&lt;</span>unknown<span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token literal-property property">time</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token maybe-class-name">CacheEntry</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">TTL</span> <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span> <span class="token comment">//5분</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> fetchWithCache <span class="token operator">=</span> async <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
</span><span class="code-line">  <span class="token literal-property property">url</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
</span><span class="code-line">  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span> force<span class="token operator">?</span><span class="token operator">:</span> boolean <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&lt;</span><span class="token maybe-class-name">AxiosResponse</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> now <span class="token operator">=</span> <span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> cached <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// force 요청이 아니고, 캐시가 존재하며 TTL 이내라면 캐시 반환</span>
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token operator">?.</span>force <span class="token operator">&amp;&amp;</span> cached <span class="token operator">&amp;&amp;</span> now <span class="token operator">-</span> cached<span class="token punctuation">.</span><span class="token property-access">time</span> <span class="token operator">&lt;</span> <span class="token constant">TTL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;캐시 히트 : &quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> cached<span class="token punctuation">.</span><span class="token property-access">promise</span> <span class="token keyword module">as</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&lt;</span><span class="token maybe-class-name">AxiosResponse</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// 그 외 새 요청 실행</span>
</span><span class="code-line">  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;API 호출 : &quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> request <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token property-access">get</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>baseUrl <span class="token operator">+</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// 새 요청 캐시 저장</span>
</span><span class="code-line">  cache<span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">promise</span><span class="token operator">:</span> request<span class="token punctuation">,</span> <span class="token literal-property property">time</span><span class="token operator">:</span> now <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// 새 요청 반환</span>
</span><span class="code-line">  <span class="token keyword control-flow">return</span> request<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="import axios, { AxiosResponse } from &quot;axios&quot;;
import { baseUrl } from &quot;../baseUrl&quot;;

type CacheEntry = {
  promise: Promise&lt;AxiosResponse&lt;unknown&gt;&gt;;
  time: number;
};

const cache = new Map&lt;string, CacheEntry&gt;();
const TTL = 5 * 60 * 1000; //5분

export const fetchWithCache = async &lt;T&gt;(
  url: string,
  options?: { force?: boolean }
): Promise&lt;AxiosResponse&lt;T&gt;&gt; =&gt; {
  const now = Date.now();
  const cached = cache.get(url);

  // force 요청이 아니고, 캐시가 존재하며 TTL 이내라면 캐시 반환
  if (!options?.force &amp;&amp; cached &amp;&amp; now - cached.time &lt; TTL) {
    console.log(&quot;캐시 히트 : &quot;, url);
    return cached.promise as Promise&lt;AxiosResponse&lt;T&gt;&gt;;
  }

  // 그 외 새 요청 실행
  console.log(&quot;API 호출 : &quot;, url);
  const request = axios.get&lt;T&gt;(baseUrl + url);

  // 새 요청 캐시 저장
  cache.set(url, { promise: request, time: now });

  // 새 요청 반환
  return request;
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>위 코드와 같이, 어떤 url로 api 요청을 받으면 해당 요청이 캐시에 존재하는지 먼저 확인하고, 없다면 새 요청을 실행 및 url을 키로 하여 캐시에 저장하는 방식을 취했다.</p>
<p>그때 드는 생각이 &quot;그렇다면 이 캐시는 언제까지 유효하지..?&quot; 라는 생각이 들었다.
그래서 TTL값을 설정하여 해당 시간이 지나면 다시 같은 url의 새로운 요청을 받도록 하였다.</p>
<p>또한 만약 강제로 요청을 보내고 싶은 경우가 있을 수 있으므로 force option을 추가하여 force인 경우 무조건 새 요청을 실행하도록 했다.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 실 사용 예시</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token function-variable function">fetchMajors</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> fetchWithCache<span class="token operator">&lt;</span><span class="token maybe-class-name">Lecture</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;/schedules-majors.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> <span class="token function-variable function">fetchLiberalArts</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span>
</span><span class="code-line">  fetchWithCache<span class="token operator">&lt;</span><span class="token maybe-class-name">Lecture</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;/schedules-liberal-arts.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> <span class="token function-variable function">fetchAllLectures</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span>
</span><span class="code-line">  <span class="token keyword control-flow">await</span> <span class="token known-class-name class-name">Promise</span><span class="token punctuation">.</span><span class="token method function property-access">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;API Call 1&quot;</span><span class="token punctuation">,</span> <span class="token dom variable">performance</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fetchMajors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;API Call 2&quot;</span><span class="token punctuation">,</span> <span class="token dom variable">performance</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fetchLiberalArts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;API Call 3&quot;</span><span class="token punctuation">,</span> <span class="token dom variable">performance</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fetchMajors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;API Call 4&quot;</span><span class="token punctuation">,</span> <span class="token dom variable">performance</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fetchLiberalArts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;API Call 5&quot;</span><span class="token punctuation">,</span> <span class="token dom variable">performance</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fetchMajors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&quot;API Call 6&quot;</span><span class="token punctuation">,</span> <span class="token dom variable">performance</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fetchLiberalArts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// 실 사용 예시
const fetchMajors = () =&gt; fetchWithCache&lt;Lecture[]&gt;(&quot;/schedules-majors.json&quot;);
const fetchLiberalArts = () =&gt;
  fetchWithCache&lt;Lecture[]&gt;(&quot;/schedules-liberal-arts.json&quot;);

const fetchAllLectures = async () =&gt;
  await Promise.all([
    (console.log(&quot;API Call 1&quot;, performance.now()), fetchMajors()),
    (console.log(&quot;API Call 2&quot;, performance.now()), fetchLiberalArts()),
    (console.log(&quot;API Call 3&quot;, performance.now()), fetchMajors()),
    (console.log(&quot;API Call 4&quot;, performance.now()), fetchLiberalArts()),
    (console.log(&quot;API Call 5&quot;, performance.now()), fetchMajors()),
    (console.log(&quot;API Call 6&quot;, performance.now()), fetchLiberalArts()),
  ]);
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>위 코드와 같이 사용하면 이제 캐싱이 잘 된다.</p>
<h4 id="searchdialog-최적화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#searchdialog-최적화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>SearchDialog 최적화</h4>
<p>이곳은 여러 컴포넌트가 한 곳에서 작성되어있고, 또한 입력폼의 경우 하나의 상태를 조작하여 여러 컴포넌트에 데이터를 뿌려주고있었다.
그래서 일단 시도한 방법은 다음과 같다.</p>
<ul>
<li>컴포넌트를 분리하고 memo로 감싸기</li>
<li>분리한 컴포넌트에 searchOptions 객체를 다 보내지 말고 실제 필요한 값만 보내기</li>
<li>changeSearchOption함수는 모든 입력 컴포넌트에서 필요한데 리렌더링되면서 다시 정의되지 않도록 useCallback사용하기
이 정도를 통해 한 입력컴포넌트를 동작해도 다른 입력컴포넌트가 리렌더링되는 문제를 막았다.</li>
</ul>
<p>또한 이 다이얼로그에는 무한스크롤 자체에 버그가 존재했다.
바로 useRef에 element를 넣어서 해당 element의 위치에 도달하면 감지되도록 intersectionObserver를 사용하는 것인데, 모달이 열리면서 useRef가 초기화 될때 jsx는 없으므로 null이 들어간다.
그래서 감지할 element가 없으니 제대로 동작하지 않는 것이다.
이 때, 아무 입력컴포넌트를 건드려 리렌더링을 유발하면 이때부터는 element가 useRef에 할당되어 무한스크롤이 잘 동작한다.</p>
<p>그래서 나는 이 문제를 해결하기위해 다음과 같은 방법을 사용했다.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line">
</span><span class="code-line"> <span class="token comment">// 무한스크롤 관련 참조</span>
</span><span class="code-line">  <span class="token keyword">const</span> loaderWrapperRef <span class="token operator">=</span> useRef<span class="token operator">&lt;</span><span class="token maybe-class-name">HTMLDivElement</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> loaderRef <span class="token operator">=</span> useRef<span class="token operator">&lt;</span><span class="token maybe-class-name">HTMLDivElement</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> observerRef <span class="token operator">=</span> useRef<span class="token operator">&lt;</span><span class="token maybe-class-name">IntersectionObserver</span> <span class="token operator">|</span> <span class="token keyword null nil">null</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> setLoaderWrapperRef <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">node</span><span class="token operator">:</span> <span class="token maybe-class-name">HTMLDivElement</span> <span class="token operator">|</span> <span class="token keyword null nil">null</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>node<span class="token punctuation">)</span> <span class="token keyword control-flow">return</span><span class="token punctuation">;</span> <span class="token comment">// unmount 시 null 들어옴</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token keyword">const</span> $loader <span class="token operator">=</span> loaderRef<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>$loader<span class="token punctuation">)</span> <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token comment">// 기존 옵저버 제거</span>
</span><span class="code-line">      observerRef<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token operator">?.</span><span class="token method function property-access">unobserve</span><span class="token punctuation">(</span>$loader<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">      <span class="token comment">// 새 옵저버 등록</span>
</span><span class="code-line">      <span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span>
</span><span class="code-line">        <span class="token punctuation">(</span><span class="token parameter">entries</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">isIntersecting</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">            <span class="token function">setPage</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prev</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token known-class-name class-name">Math</span><span class="token punctuation">.</span><span class="token method function property-access">min</span><span class="token punctuation">(</span>lastPage<span class="token punctuation">,</span> prev <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">          <span class="token punctuation">}</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">{</span> <span class="token literal-property property">root</span><span class="token operator">:</span> node <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">      observer<span class="token punctuation">.</span><span class="token method function property-access">observe</span><span class="token punctuation">(</span>$loader<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      observerRef<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> observer<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">[</span>lastPage<span class="token punctuation">]</span>
</span><span class="code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line"> <span class="token operator">&lt;</span><span class="token maybe-class-name">Box</span> overflowY<span class="token operator">=</span><span class="token string">&quot;auto&quot;</span> maxH<span class="token operator">=</span><span class="token string">&quot;500px&quot;</span> ref<span class="token operator">=</span><span class="token punctuation">{</span>setLoaderWrapperRef<span class="token punctuation">}</span><span class="token operator">&gt;</span>
</span><span class="code-line">                <span class="token operator">&lt;</span><span class="token maybe-class-name">Table</span> size<span class="token operator">=</span><span class="token string">&quot;sm&quot;</span> variant<span class="token operator">=</span><span class="token string">&quot;striped&quot;</span><span class="token operator">&gt;</span>
</span><span class="code-line">                  <span class="token operator">&lt;</span><span class="token maybe-class-name">Tbody</span><span class="token operator">&gt;</span>
</span><span class="code-line">                    <span class="token punctuation">{</span>visibleLectures<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">lecture<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">(</span>
</span><span class="code-line">                      <span class="token operator">&lt;</span><span class="token maybe-class-name">LectureRow</span>
</span><span class="code-line">                        key<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>lecture<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span>
</span><span class="code-line">                        lecture<span class="token operator">=</span><span class="token punctuation">{</span>lecture<span class="token punctuation">}</span>
</span><span class="code-line">                        addSchedule<span class="token operator">=</span><span class="token punctuation">{</span>addSchedule<span class="token punctuation">}</span>
</span><span class="code-line">                      <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line">                    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</span><span class="code-line">                  <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token maybe-class-name">Tbody</span><span class="token operator">&gt;</span>
</span><span class="code-line">                <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token maybe-class-name">Table</span><span class="token operator">&gt;</span>
</span><span class="code-line">
</span><span class="code-line">                <span class="token operator">&lt;</span><span class="token maybe-class-name">Box</span> ref<span class="token operator">=</span><span class="token punctuation">{</span>loaderRef<span class="token punctuation">}</span> h<span class="token operator">=</span><span class="token string">&quot;20px&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line">              <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token maybe-class-name">Box</span><span class="token operator">&gt;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span></code><div class="copied" data-code="
 // 무한스크롤 관련 참조
  const loaderWrapperRef = useRef&lt;HTMLDivElement&gt;(null);
  const loaderRef = useRef&lt;HTMLDivElement&gt;(null);
  const observerRef = useRef&lt;IntersectionObserver | null&gt;(null);

const setLoaderWrapperRef = useCallback(
    (node: HTMLDivElement | null) =&gt; {
      if (!node) return; // unmount 시 null 들어옴

      const $loader = loaderRef.current;
      if (!$loader) return;

      // 기존 옵저버 제거
      observerRef.current?.unobserve($loader);

      // 새 옵저버 등록
      const observer = new IntersectionObserver(
        (entries) =&gt; {
          if (entries[0].isIntersecting) {
            setPage((prev) =&gt; Math.min(lastPage, prev + 1));
          }
        },
        { root: node }
      );

      observer.observe($loader);
      observerRef.current = observer;
    },
    [lastPage]
  );


return (
 &lt;Box overflowY=&quot;auto&quot; maxH=&quot;500px&quot; ref={setLoaderWrapperRef}&gt;
                &lt;Table size=&quot;sm&quot; variant=&quot;striped&quot;&gt;
                  &lt;Tbody&gt;
                    {visibleLectures.map((lecture, index) =&gt; (
                      &lt;LectureRow
                        key={`${lecture.id}-${index}`}
                        lecture={lecture}
                        addSchedule={addSchedule}
                      /&gt;
                    ))}
                  &lt;/Tbody&gt;
                &lt;/Table&gt;

                &lt;Box ref={loaderRef} h=&quot;20px&quot; /&gt;
              &lt;/Box&gt;
)
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>Wrapper Box에 Ref를 바로 넘기지 않고 setLoaderWrapperRef라는 콜백함수를 넣어 jsx가 읽혀질때 함수가 실행되어 element가 할당되도록 만든 것이다.
위 방식은 현업에서 자주 사용했던 방법이라서 여기에서 곧바로 적용해볼 수 있었다.</p>
<p>마지막은 무한스크롤 되는 아이템들의 리렌더링문제이다.
해결 방법은 Tbody내부에서 새로운 컴포넌트로 빼낸 후 메모이제이션 되도록 하였다.</p>
<h4 id="시간표-드래그-앤-드롭"><a class="anchor" aria-hidden="true" tabindex="-1" href="#시간표-드래그-앤-드롭"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>시간표 드래그 앤 드롭</h4>
<p>시간표 드래그 앤 드롭 시 상당히 많은 리렌더링을 유발하고있었다. 원인은 다양하게 존재했지만 가장 큰 문제는 dndContext의 값 변화가 전체 시간표들을 리렌더링 시키는 것이였다.
일단 가장 쉬운 방법으로 프로바이더가 공유되어있으므로 각 시간표별로 프로바이더를 따로 보내줬다.  이렇게 한 이유는, 프로바이더를 공유해서 사용하면 activeId값을 계산하게 되면서 모든 컴포넌트가 한 번은 같이 리렌더링 되는 문제가 존재한다 라고 생각했기 때문이다.  또한 우리 프로젝트에서 시간표끼리 드래그를 넘겨줄것도 아니기 때문에 하나의 프로바이더가 아니여도 괜찮다고 판단했다.</p>
<p>이제 그다음 문제를 해결하기 위해 일단 컴포넌트들을 작게 분리하고 memo로 감쌌다. 그렇게 감싸다보니 결국 시간표가 업데이트되면 같은 컨텍스트를 공유하는 모든 곳이 리렌더링이 된다는 것도 발견하게 되었다.</p>
<p>그래서 이전에 배웠던 useSyncExternalStore를 활용해 외부 스토어를 하나 만든 뒤 마치 redux의 selector와 유사하게 특정 조각만 구독할 수 있고, 그리고 상태 업데이트 또한 키값을 통해 각 시간표마다 따로 진행되도록 만들었다.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 스토어</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">dummyScheduleMap</span> <span class="token keyword module">from</span> <span class="token string">&quot;../dummyScheduleMap&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">Schedule</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&quot;../types&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">type <span class="token maybe-class-name">ScheduleMap</span> <span class="token operator">=</span> <span class="token maybe-class-name">Record</span><span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token maybe-class-name">Schedule</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// emit할 때 어떤 테이블이 바뀌었는지 알려주기</span>
</span><span class="code-line">type <span class="token function-variable function"><span class="token maybe-class-name">Listener</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">changedId</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token doc-comment comment">/**
</span></span><span class="code-line"><span class="token doc-comment comment"> * ScheduleStore
</span></span><span class="code-line"><span class="token doc-comment comment"> * 시간표 데이터를 관리하는 스토어
</span></span><span class="code-line"><span class="token doc-comment comment"> */</span>
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">ScheduleStore</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">private</span> <span class="token literal-property property">schedulesMap</span><span class="token operator">:</span> <span class="token maybe-class-name">ScheduleMap</span> <span class="token operator">=</span> dummyScheduleMap<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">private</span> listeners <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Listener</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token doc-comment comment">/**
</span></span><span class="code-line"><span class="token doc-comment comment">   * subscribe
</span></span><span class="code-line"><span class="token doc-comment comment">   * 시간표 데이터 변경 시 호출되는 리스너를 등록
</span></span><span class="code-line"><span class="token doc-comment comment">   * <span class="token keyword">@param</span> <span class="token parameter">listener</span> 리스너
</span></span><span class="code-line"><span class="token doc-comment comment">   * <span class="token keyword">@returns</span> 해제 함수
</span></span><span class="code-line"><span class="token doc-comment comment">   */</span>
</span><span class="code-line">  <span class="token function-variable function">subscribe</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">listener</span><span class="token operator">:</span> <span class="token maybe-class-name">Listener</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">listeners</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">listeners</span><span class="token punctuation">.</span><span class="token method function property-access">delete</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// unsubscribe</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token doc-comment comment">/**
</span></span><span class="code-line"><span class="token doc-comment comment">   * getScheduleMap
</span></span><span class="code-line"><span class="token doc-comment comment">   * 시간표 데이터를 반환
</span></span><span class="code-line"><span class="token doc-comment comment">   * <span class="token keyword">@returns</span> 시간표 데이터
</span></span><span class="code-line"><span class="token doc-comment comment">   */</span>
</span><span class="code-line">  <span class="token function-variable function">getScheduleMap</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token doc-comment comment">/**
</span></span><span class="code-line"><span class="token doc-comment comment">   * setScheduleMap
</span></span><span class="code-line"><span class="token doc-comment comment">   * 시간표 데이터를 업데이트
</span></span><span class="code-line"><span class="token doc-comment comment">   * <span class="token keyword">@param</span> <span class="token parameter">next</span> 업데이트 함수
</span></span><span class="code-line"><span class="token doc-comment comment">   */</span>
</span><span class="code-line">  setScheduleMap <span class="token operator">=</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token literal-property property">next</span><span class="token operator">:</span> <span class="token maybe-class-name">ScheduleMap</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">prev</span><span class="token operator">:</span> <span class="token maybe-class-name">ScheduleMap</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token maybe-class-name">ScheduleMap</span><span class="token punctuation">)</span> <span class="token comment">// ✅ 두 가지 다 허용</span>
</span><span class="code-line">  <span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> next <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span> <span class="token operator">=</span> <span class="token punctuation">(</span>next <span class="token keyword module">as</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">prev</span><span class="token operator">:</span> <span class="token maybe-class-name">ScheduleMap</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token maybe-class-name">ScheduleMap</span><span class="token punctuation">)</span><span class="token punctuation">(</span>
</span><span class="code-line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span>
</span><span class="code-line">      <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span> <span class="token operator">=</span> next<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token doc-comment comment">/**
</span></span><span class="code-line"><span class="token doc-comment comment">   * setTable
</span></span><span class="code-line"><span class="token doc-comment comment">   * 특정 tableId만 업데이트
</span></span><span class="code-line"><span class="token doc-comment comment">   */</span>
</span><span class="code-line">  setTable <span class="token operator">=</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token literal-property property">tableId</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token literal-property property">next</span><span class="token operator">:</span> <span class="token maybe-class-name">Schedule</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">prev</span><span class="token operator">:</span> <span class="token maybe-class-name">Schedule</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token maybe-class-name">Schedule</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">  <span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> prevTable <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span><span class="token punctuation">[</span>tableId<span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">const</span> newTable <span class="token operator">=</span> <span class="token keyword">typeof</span> next <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> <span class="token function">next</span><span class="token punctuation">(</span>prevTable<span class="token punctuation">)</span> <span class="token operator">:</span> next<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 전체 객체 새로 만들지 말고, 해당 테이블만 교체</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span><span class="token punctuation">[</span>tableId<span class="token punctuation">]</span> <span class="token operator">=</span> newTable<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span>tableId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token doc-comment comment">/**
</span></span><span class="code-line"><span class="token doc-comment comment">   * deleteTable
</span></span><span class="code-line"><span class="token doc-comment comment">   * 특정 tableId만 삭제
</span></span><span class="code-line"><span class="token doc-comment comment">   */</span>
</span><span class="code-line">  <span class="token function-variable function">deleteTable</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">tableId</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> copy <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token spread operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">delete</span> copy<span class="token punctuation">[</span>tableId<span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span> <span class="token operator">=</span> copy<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span>tableId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token doc-comment comment">/**
</span></span><span class="code-line"><span class="token doc-comment comment">   * duplicateTable
</span></span><span class="code-line"><span class="token doc-comment comment">   * 특정 tableId만 복제
</span></span><span class="code-line"><span class="token doc-comment comment">   */</span>
</span><span class="code-line">  <span class="token function-variable function">duplicateTable</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">tableId</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> copy <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token spread operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">    copy<span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tableId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token spread operator">...</span>copy<span class="token punctuation">[</span>tableId<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span> <span class="token operator">=</span> copy<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span>tableId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token doc-comment comment">/**
</span></span><span class="code-line"><span class="token doc-comment comment">   * deleteScheduleItem
</span></span><span class="code-line"><span class="token doc-comment comment">   */</span>
</span><span class="code-line">  <span class="token function-variable function">deleteScheduleItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">tableId</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token maybe-class-name">Schedule</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span><span class="token punctuation">[</span>tableId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">schedulesMap</span><span class="token punctuation">[</span>tableId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">filter</span><span class="token punctuation">(</span>
</span><span class="code-line">      <span class="token punctuation">(</span><span class="token parameter">schedule</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span>
</span><span class="code-line">        schedule<span class="token punctuation">.</span><span class="token property-access">day</span> <span class="token operator">!==</span> data<span class="token punctuation">.</span><span class="token property-access">day</span> <span class="token operator">||</span> <span class="token operator">!</span>schedule<span class="token punctuation">.</span><span class="token property-access">range</span><span class="token punctuation">.</span><span class="token method function property-access">includes</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token property-access">range</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span>tableId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token doc-comment comment">/**
</span></span><span class="code-line"><span class="token doc-comment comment">   * emit
</span></span><span class="code-line"><span class="token doc-comment comment">   * 시간표 데이터 변경 시 호출되는 리스너 실행
</span></span><span class="code-line"><span class="token doc-comment comment">   */</span>
</span><span class="code-line">  <span class="token keyword">private</span> <span class="token function-variable function">emit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">changedId</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">listeners</span><span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">listener</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token function">listener</span><span class="token punctuation">(</span>changedId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line"><span class="token comment">// 싱글톤 인스턴스 생성</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> scheduleStore <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScheduleStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// 스토어
import dummyScheduleMap from &quot;../dummyScheduleMap&quot;;
import { Schedule } from &quot;../types&quot;;

type ScheduleMap = Record&lt;string, Schedule[]&gt;;

// emit할 때 어떤 테이블이 바뀌었는지 알려주기
type Listener = (changedId: string) =&gt; void;

/**
 * ScheduleStore
 * 시간표 데이터를 관리하는 스토어
 */
class ScheduleStore {
  private schedulesMap: ScheduleMap = dummyScheduleMap;
  private listeners = new Set&lt;Listener&gt;();

  /**
   * subscribe
   * 시간표 데이터 변경 시 호출되는 리스너를 등록
   * @param listener 리스너
   * @returns 해제 함수
   */
  subscribe = (listener: Listener) =&gt; {
    this.listeners.add(listener);
    return () =&gt; this.listeners.delete(listener); // unsubscribe
  };

  /**
   * getScheduleMap
   * 시간표 데이터를 반환
   * @returns 시간표 데이터
   */
  getScheduleMap = () =&gt; this.schedulesMap;

  /**
   * setScheduleMap
   * 시간표 데이터를 업데이트
   * @param next 업데이트 함수
   */
  setScheduleMap = (
    next: ScheduleMap | ((prev: ScheduleMap) =&gt; ScheduleMap) // ✅ 두 가지 다 허용
  ) =&gt; {
    if (typeof next === &quot;function&quot;) {
      this.schedulesMap = (next as (prev: ScheduleMap) =&gt; ScheduleMap)(
        this.schedulesMap
      );
    } else {
      this.schedulesMap = next;
    }
    this.emit(&quot;*&quot;);
  };

  /**
   * setTable
   * 특정 tableId만 업데이트
   */
  setTable = (
    tableId: string,
    next: Schedule[] | ((prev: Schedule[]) =&gt; Schedule[])
  ) =&gt; {
    const prevTable = this.schedulesMap[tableId] ?? [];
    const newTable = typeof next === &quot;function&quot; ? next(prevTable) : next;

    // 전체 객체 새로 만들지 말고, 해당 테이블만 교체
    this.schedulesMap[tableId] = newTable;
    this.emit(tableId);
  };

  /**
   * deleteTable
   * 특정 tableId만 삭제
   */
  deleteTable = (tableId: string) =&gt; {
    const copy = { ...this.schedulesMap };
    delete copy[tableId];
    this.schedulesMap = copy;
    this.emit(tableId);
  };

  /**
   * duplicateTable
   * 특정 tableId만 복제
   */
  duplicateTable = (tableId: string) =&gt; {
    const copy = { ...this.schedulesMap };
    copy[`${tableId}-${Date.now()}`] = [...copy[tableId]];
    this.schedulesMap = copy;
    this.emit(tableId);
  };

  /**
   * deleteScheduleItem
   */
  deleteScheduleItem = (tableId: string, data: Schedule) =&gt; {
    this.schedulesMap[tableId] = this.schedulesMap[tableId].filter(
      (schedule) =&gt;
        schedule.day !== data.day || !schedule.range.includes(data.range[0])
    );
    this.emit(tableId);
  };

  /**
   * emit
   * 시간표 데이터 변경 시 호출되는 리스너 실행
   */
  private emit = (changedId: string) =&gt; {
    this.listeners.forEach((listener) =&gt; listener(changedId));
  };
}
// 싱글톤 인스턴스 생성
export const scheduleStore = new ScheduleStore();
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>위 처럼 하나의 스토어를 만들었고, 그 안에 필요한 메서드들을 만들었다.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useSyncExternalStore <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">Schedule</span> <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&quot;../types&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> scheduleStore <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&quot;./schedule.store&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">dummyScheduleMap</span> <span class="token keyword module">from</span> <span class="token string">&quot;../dummyScheduleMap&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> <span class="token constant">EMPTY</span><span class="token operator">:</span> <span class="token maybe-class-name">Schedule</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 특정 tableId에 해당하는 schedule만 구독</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">useSchedule</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">tableId</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">Schedule</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword control-flow">return</span> <span class="token function">useSyncExternalStore</span><span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token parameter">onStoreChange</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span>
</span><span class="code-line">      scheduleStore<span class="token punctuation">.</span><span class="token method function property-access">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">changedId</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>changedId <span class="token operator">===</span> <span class="token string">&quot;*&quot;</span> <span class="token operator">||</span> changedId <span class="token operator">===</span> tableId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token function">onStoreChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> scheduleStore<span class="token punctuation">.</span><span class="token method function property-access">getScheduleMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>tableId<span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token constant">EMPTY</span>
</span><span class="code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">type <span class="token maybe-class-name">ScheduleMap</span> <span class="token operator">=</span> <span class="token maybe-class-name">Record</span><span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token maybe-class-name">Schedule</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token comment">// 시간표 데이터 전체를 구독</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">useSchedulesMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">ScheduleMap</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword control-flow">return</span> <span class="token function">useSyncExternalStore</span><span class="token punctuation">(</span>
</span><span class="code-line">    scheduleStore<span class="token punctuation">.</span><span class="token property-access">subscribe</span><span class="token punctuation">,</span>
</span><span class="code-line">    scheduleStore<span class="token punctuation">.</span><span class="token property-access">getScheduleMap</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> dummyScheduleMap
</span><span class="code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="import { useSyncExternalStore } from &quot;react&quot;;
import { Schedule } from &quot;../types&quot;;
import { scheduleStore } from &quot;./schedule.store&quot;;
import dummyScheduleMap from &quot;../dummyScheduleMap&quot;;

const EMPTY: Schedule[] = [];

// 특정 tableId에 해당하는 schedule만 구독
export function useSchedule(tableId: string): Schedule[] {
  return useSyncExternalStore(
    (onStoreChange) =&gt;
      scheduleStore.subscribe((changedId) =&gt; {
        if (changedId === &quot;*&quot; || changedId === tableId) {
          onStoreChange();
        }
      }),
    () =&gt; scheduleStore.getScheduleMap()[tableId] ?? EMPTY
  );
}

type ScheduleMap = Record&lt;string, Schedule[]&gt;;
// 시간표 데이터 전체를 구독
export function useSchedulesMap(): ScheduleMap {
  return useSyncExternalStore(
    scheduleStore.subscribe,
    scheduleStore.getScheduleMap,
    () =&gt; dummyScheduleMap
  );
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>이제 위 훅을 사용하여 구독할 데이터를 선택해서 사용할 수 있게 되었다.</p>
<h3 id="기술적-성장"><a class="anchor" aria-hidden="true" tabindex="-1" href="#기술적-성장"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>기술적 성장</h3>
<!-- -->
<p>리렌더링은 크게 부모컴포넌트의 리렌더링, 상태의 변화, 프롭스의 변화에 의해 발생한다.
따라서 부모컴포넌트의 리렌더링으로부터 자식이 리렌더링 되지 않으려면 자식 컴포넌트를 메모이제이션 해둬야한다.
하지만 자식컴포넌트에 넘겨지는 props에  객체/배열/함수를 새로 만들어서 넘겨주는 형태가 된다면 자식컴포넌트는 여전히 리렌더링 된다.
따라서 최소한 필요한 값 자체만 넘겨지도록 하고, 함수의 경우엔 useCallback을 통해 메모이제이션하여 새로 만들지 않고 기존 함수로 넘길 수 있도록 하는게 중요하다.</p>
<p>그래서 평소 습관 처럼 다음과 같은 생각을 하면서 코드를 짜면 좋다고 생각이 들었다.</p>
<ol>
<li>props최소화</li>
</ol>
<ul>
<li>자식 컴포넌트에 진짜 필요한 것만 넘기기</li>
<li>객체를 통째로 넘기지 말고 자식이 쓰는 값만 뽑아서 전달하기</li>
</ul>
<ol start="2">
<li>props로 넘기는 함수는 useCallback쓰기</li>
<li>큰 컴포넌트는 분리하고, 자주 바뀌지 않는 컴포넌트들은 memo로 감싸기</li>
</ol>
<p>위 세 가지만 생각하면서 만들어도 리렌더링이 효과적으로 줄 것이라고 생각이 들었다. 이번 과제 내내 위 3가지를 생각하며 최적화를 진행했기 때문에 더욱 와닿았다.</p>
<h3 id="코드-품질"><a class="anchor" aria-hidden="true" tabindex="-1" href="#코드-품질"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>코드 품질</h3>
<!-- -->
<p>이번 코드에서 마음에 들었던 부분은 스토어관련 부분이다.
이전에 공부했던 내용을 다시 사용했다는 부분에서 만족감이 컸다.</p>
<p>물론 만들면서 AI의 도움을 받다보니 내가 원하는 메서드를 안만들어준다거나 하여 필요없는데 포함되어있는 부분들도 존재한다.
이제 그런 부분들을 제거하고, 더 깔끔하고 실용적인 방법이 있는지 고민해봐야겠다.</p>
<h3 id="학습-효과-분석"><a class="anchor" aria-hidden="true" tabindex="-1" href="#학습-효과-분석"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>학습 효과 분석</h3>
<!-- -->
<p>처음과 비교하여 눈에 띄게 리렌더링을 최소화 시키면서 어떤 코드들이 리렌더링을 많이 유발시키는지 이해하게 되었다.
하지만 남아있는 고민은 &quot;과연 어디까지 리렌더링을 막는데 시간을 쏟아야 하나?&quot; 라는 생각이 들었다.
지금 상태보다 더 줄이려면 줄일수도 있을것 같다는 생각이 든다. 아직 완벽하지 않기 때문이다.
하지만 성능최적화가 되었다 라는 기준을 어디에 잡고 진행해야 하는지는 아직 감이 없는것 같다.</p>
<h3 id="과제-피드백"><a class="anchor" aria-hidden="true" tabindex="-1" href="#과제-피드백"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>과제 피드백</h3>
<!-- -->
<p>현업에서 업무를 보며 성능최적화에 실패했던 프로젝트가 있었다.
당시 과도한 리렌더링으로 화면이 느려지면서 버그가 생기곤 했는데, 그때 당시 결국 성능 최적화에 실패하고 다른 방식으로 기능을 만들었다.
당시엔 완전 초보자 시절이라 지금처럼 React dev tools도 몰랐고, 렌더링을 줄이기 위해 뭐부터 시작해야할지 감도 없었다.
하지만 지금 이 지식을 가지고 다시 도전한다면 왠지 성공해낼 수 있을것 같다는 생각이 든다.</p>
<h2 id="리뷰-받고-싶은-내용"><a class="anchor" aria-hidden="true" tabindex="-1" href="#리뷰-받고-싶은-내용"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>리뷰 받고 싶은 내용</h2>
<p>리뷰 받고 싶은 내용보다 질문이 있습니다.
이번 과제를 진행하면서 과도한 리렌더링을 줄여나가면서 &quot;과연 어느정도까지 리렌더링을 허용해줘야할까?&quot; 라는 의문이 남았습니다.
리렌더링이 발생한다고 해도 성능에 영향이 적을수도 있고, 반대로 리렌더링을 모두 막으려다가 코드가 과도하게 복잡해지거나 시간이 많이 소모되는 등의 문제가 생길 수 있다고 생각합니다.
또한 메모리 관점에서도 useMemo, useCallback, React.memo 와 같은 최적화기법은 내부적으로 값을 캐싱하기 때문에 남발할 경우 메모리 사용량이 늘어날 것이라고 예측됩니다.
그렇다면 실제 서비스에서 리렌더링을 어느정도 까지 진행해야하는지 기준을 어떻게 잡는지 궁금합니다. (그 기준에 객관적인 지표가 있는것인지 궁금합니다.)</p>
</div></div><div class="overflow-auto mt-9"><div data-color-mode="dark" class="wmde-markdown wmde-markdown-color p-6 max-w-full" style="word-wrap:break-word;overflow-wrap:break-word"><h2 id="과제-피드백"><a class="anchor" aria-hidden="true" tabindex="-1" href="#과제-피드백"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>과제 피드백</h2>
<p>안녕하세요 휘린님! 마지막 과제 너무 잘 진행해주셨네요 ㅎㅎ
그동안 너무 고생하셨습니다!!</p>
<hr/>
<blockquote>
<p>리뷰 받고 싶은 내용보다 질문이 있습니다. 이번 과제를 진행하면서 과도한 리렌더링을 줄여나가면서 &quot;과연 어느정도까지 리렌더링을 허용해줘야할까?&quot; 라는 의문이 남았습니다. 리렌더링이 발생한다고 해도 성능에 영향이 적을수도 있고, 반대로 리렌더링을 모두 막으려다가 코드가 과도하게 복잡해지거나 시간이 많이 소모되는 등의 문제가 생길 수 있다고 생각합니다. 또한 메모리 관점에서도 useMemo, useCallback, React.memo 와 같은 최적화기법은 내부적으로 값을 캐싱하기 때문에 남발할 경우 메모리 사용량이 늘어날 것이라고 예측됩니다. 그렇다면 실제 서비스에서 리렌더링을 어느정도 까지 진행해야하는지 기준을 어떻게 잡는지 궁금합니다. (그 기준에 객관적인 지표가 있는것인지 궁금합니다.)</p>
</blockquote>
<p>별도의 객관적인 지표가 있다기보단... 저의 경우 최적화가 꼭 필요한 시점은 &quot;사용자가 불편함을 느낄 때&quot; 라고 생각해요. 그 이전까지는 굳이? 라는 생각입니다 ㅎㅎ</p>
<p>해보면 알겠지만, 원리만 제대로 알고 있으면 최적화를 하는게 어렵진 않아요. 그래서 일단 기능을 빠르게 구현하고, 시간적 여유가 있을 때 혹은 정말 필요하다고 느끼는 시점에 진행하면 된다고 생각합니다.</p>
<p>제가 주로 최적화를 했던 시점은 위에서도 언급했지만, 사용자 문의가 들어왔을때였어요! 그렇게만 해도 충분했었답니다..!</p>
<p>다만 기술부채가 너무 쌓이면 나중에 해결하기가 어려워서.. 주기적으로 점검하면좋아요 ㅋㅋ</p>
<p>현재 프로젝트의 문제를 미리미리 파악하고, 이 문제를 해결하는데 어느 정도의 시간이 소요되는지 측정해보는거죠.</p></div></div><div class="mt-9"></div></div></main></div></div></div></div>
</body>
</html>
