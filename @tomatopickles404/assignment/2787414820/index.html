<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="/front_6th/favicon.ico"/>
  
    <title>[9팀 권지호] Chapter 4-1 성능 최적화 - 권지호 | 항해플러스 프론트엔드 6기</title>
    <meta name="description" content=" [항해플러스 프론트엔드 6기] 권지호님이 제출한 [9팀 권지호] Chapter 4-1 성능 최적화 과제를 확인하세요. 코드 구현, 문제 해결 과정, 피드백 내용을 상세히 살펴볼 수 있습니다." />
    <meta name="keywords" content="항해플러스, 프론트엔드, 개발자교육, React, TypeScript, JavaScript, 기술면접, 웹개발, 권지호, [9팀 권지호] Chapter 4-1 성능 최적화, 과제상세, 코드리뷰, 피드백, Pull Request" />
    <meta property="og:title" content="[9팀 권지호] Chapter 4-1 성능 최적화 - 권지호 | 항해플러스 프론트엔드 6기" />
    <meta property="og:description" content=" [항해플러스 프론트엔드 6기] 권지호님이 제출한 [9팀 권지호] Chapter 4-1 성능 최적화 과제를 확인하세요. 코드 구현, 문제 해결 과정, 피드백 내용을 상세히 살펴볼 수 있습니다." />
    <meta property="og:image" content="/defaultThumbnail.jpg" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="[9팀 권지호] Chapter 4-1 성능 최적화 - 권지호 | 항해플러스 프론트엔드 6기" />
    <meta name="twitter:description" content=" [항해플러스 프론트엔드 6기] 권지호님이 제출한 [9팀 권지호] Chapter 4-1 성능 최적화 과제를 확인하세요. 코드 구현, 문제 해결 과정, 피드백 내용을 상세히 살펴볼 수 있습니다." />
    <meta name="twitter:image" content="/defaultThumbnail.jpg" />
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-6J8QP7YK1E"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-6J8QP7YK1E');
  </script>
  <script type="module" crossorigin src="/front_6th/assets/index-DtEqFcg_.js"></script>
  <link rel="stylesheet" crossorigin href="/front_6th/assets/index-BXO68frB.css">
</head>
<body>
<div id="root"><div data-slot="sidebar-wrapper" style="--sidebar-width:16rem;--sidebar-width-icon:3rem" class="group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full"><div class="min-h-screen flex w-full"><div class="group peer text-sidebar-foreground hidden md:block" data-state="expanded" data-collapsible="" data-variant="sidebar" data-side="left" data-slot="sidebar"><div data-slot="sidebar-gap" class="relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear group-data-[collapsible=offcanvas]:w-0 group-data-[side=right]:rotate-180 group-data-[collapsible=icon]:w-(--sidebar-width-icon)"></div><div data-slot="sidebar-container" class="fixed inset-y-0 z-10 hidden h-svh transition-[left,right,width] duration-200 ease-linear md:flex left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)] group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l w-64"><div data-sidebar="sidebar" data-slot="sidebar-inner" class="bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm"><div data-slot="sidebar-content" data-sidebar="content" class="flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden bg-card border-r border-border"><a class="p-4" href="/front_6th/" data-discover="true"><div class="flex items-center space-x-2 mb-6"><div class="w-8 h-8 bg-gradient-primary rounded-lg flex items-center justify-center"><span class="text-white font-bold text-sm">6기</span></div><h4 class="text-lg font-bold text-primary">항해플러스 프론트엔드</h4></div></a><div data-slot="sidebar-group" data-sidebar="group" class="relative flex w-full min-w-0 flex-col p-2"><div data-slot="sidebar-group-label" data-sidebar="group-label" class="ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0 text-muted-foreground px-4">학습 관리</div><div data-slot="sidebar-group-content" data-sidebar="group-content" class="w-full text-sm"><ul data-slot="sidebar-menu" data-sidebar="menu" class="flex w-full min-w-0 flex-col gap-1 px-2"><li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative"><a data-slot="sidebar-menu-button" data-sidebar="menu-button" data-size="default" data-active="false" class="peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground text-sm h-12 text-foreground hover:bg-secondary hover:text-secondary-foreground rounded-lg transition-all duration-300" href="/front_6th/" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-users h-5 w-5" aria-hidden="true"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><path d="M16 3.128a4 4 0 0 1 0 7.744"></path><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><circle cx="9" cy="7" r="4"></circle></svg><span class="ml-3">수강생 목록</span></a></li><li data-slot="sidebar-menu-item" data-sidebar="menu-item" class="group/menu-item relative"><a data-slot="sidebar-menu-button" data-sidebar="menu-button" data-size="default" data-active="false" class="peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left outline-hidden ring-sidebar-ring transition-[width,height,padding] focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&amp;&gt;span:last-child]:truncate [&amp;&gt;svg]:size-4 [&amp;&gt;svg]:shrink-0 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground text-sm h-12 text-foreground hover:bg-secondary hover:text-secondary-foreground rounded-lg transition-all duration-300" href="/front_6th/assignments/" data-discover="true"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book-open h-5 w-5" aria-hidden="true"><path d="M12 7v14"></path><path d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"></path></svg><span class="ml-3">과제 목록</span></a></li></ul></div></div></div></div></div></div><div class="flex-1 min-w-0"><header class="h-12 flex items-center border-b border-border bg-card px-4"><button data-slot="sidebar-trigger" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg:not([class*=&#x27;size-&#x27;])]:size-4 shrink-0 [&amp;_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50 size-7 mr-4 text-white" data-sidebar="trigger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-panel-left" aria-hidden="true"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path></svg><span class="sr-only">Toggle Sidebar</span></button><h4 class="text-lg font-semibold "><a href="/front_6th/@tomatopickles404/" data-discover="true">tomatopickles404<!-- --> 님의 상세페이지</a> ＞ <!-- -->[9팀 권지호] Chapter 4-1 성능 최적화</h4></header><main class="p-6"><div><div class="card-wrap"><div data-slot="card" class="card text-card-foreground flex flex-col gap-6 shadow-sm mb-6 p-6 border border-gray-700 bg-gray-800 rounded-lg"><a href="https://github.com/hanghae-plus/front_6th_chapter4-1/pull/4" target="_blank"><div class="flex items-start gap-4"><div class="flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" height="32" aria-hidden="true" viewBox="0 0 24 24" width="32" fill="white" class="w-8 h-8"><path d="M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"></path></svg></div><div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-2"><h3 class="text-lg font-semibold text-white truncate">[9팀 권지호] Chapter 4-1 성능 최적화</h3></div><div class="flex items-center gap-4 text-xs text-gray-500"><span>by <!-- -->tomatopickles404</span><span>2025. 8. 31.</span></div></div></div></a></div></div><div class="overflow-auto"><div data-color-mode="dark" class="wmde-markdown wmde-markdown-color p-6 max-w-full" style="word-wrap:break-word;overflow-wrap:break-word"><h2 id="과제-체크포인트"><a class="anchor" aria-hidden="true" tabindex="-1" href="#과제-체크포인트"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>과제 체크포인트</h2>
<h3 id="배포-링크"><a class="anchor" aria-hidden="true" tabindex="-1" href="#배포-링크"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>배포 링크</h3>
<p>기본: <a href="https://tomatopickles404.github.io/front_6th_chapter4-1/vanilla/">https://tomatopickles404.github.io/front_6th_chapter4-1/vanilla/</a>
심화: <a href="https://hanghae-plus.github.io/front_6th_chapter4-1/react/">https://hanghae-plus.github.io/front_6th_chapter4-1/react/</a></p>
<!-- -->
<h3 id="기본과제-vanilla-ssr--ssg"><a class="anchor" aria-hidden="true" tabindex="-1" href="#기본과제-vanilla-ssr--ssg"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>기본과제 (Vanilla SSR &amp; SSG)</h3>
<h4 id="express-ssr-서버"><a class="anchor" aria-hidden="true" tabindex="-1" href="#express-ssr-서버"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Express SSR 서버</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> Express 미들웨어 기반 서버 구현</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 개발/프로덕션 환경 분기 처리</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> HTML 템플릿 치환 (<code>&lt;!--app-html--&gt;</code>, <code>&lt;!--app-head--&gt;</code>)</li>
</ul>
<h4 id="서버-사이드-렌더링"><a class="anchor" aria-hidden="true" tabindex="-1" href="#서버-사이드-렌더링"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>서버 사이드 렌더링</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 서버에서 동작하는 Router 구현</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 서버 데이터 프리페칭 (상품 목록, 상품 상세)</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 서버 상태관리 초기화</li>
</ul>
<h4 id="클라이언트-hydration"><a class="anchor" aria-hidden="true" tabindex="-1" href="#클라이언트-hydration"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>클라이언트 Hydration</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> <code>window.__INITIAL_DATA__</code> 스크립트 주입</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 클라이언트 상태 복원</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 서버-클라이언트 데이터 일치</li>
</ul>
<h4 id="static-site-generation"><a class="anchor" aria-hidden="true" tabindex="-1" href="#static-site-generation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Static Site Generation</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 동적 라우트 SSG (상품 상세 페이지들)</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 빌드 타임 페이지 생성</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 파일 시스템 기반 배포</li>
</ul>
<h3 id="심화과제-react-ssr--ssg"><a class="anchor" aria-hidden="true" tabindex="-1" href="#심화과제-react-ssr--ssg"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>심화과제 (React SSR &amp; SSG)</h3>
<h4 id="react-ssr"><a class="anchor" aria-hidden="true" tabindex="-1" href="#react-ssr"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>React SSR</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> <code>renderToString</code> 서버 렌더링</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> TypeScript SSR 모듈 빌드</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> Universal React Router (서버/클라이언트 분기)</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> React 상태관리 서버 초기화</li>
</ul>
<h4 id="react-hydration"><a class="anchor" aria-hidden="true" tabindex="-1" href="#react-hydration"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>React Hydration</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> Hydration 불일치 방지</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 클라이언트 상태 복원</li>
</ul>
<h4 id="static-site-generation-1"><a class="anchor" aria-hidden="true" tabindex="-1" href="#static-site-generation-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Static Site Generation</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 동적 라우트 SSG (상품 상세 페이지들)</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 빌드 타임 페이지 생성</li>
<li class="task-list-item"><input type="checkbox" disabled="" checked=""/> 파일 시스템 기반 배포</li>
</ul>
<h2 id="구현-과정-돌아보기"><a class="anchor" aria-hidden="true" tabindex="-1" href="#구현-과정-돌아보기"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>구현 과정 돌아보기</h2>
<h3 id="가장-어려웠던-부분과-해결-과정"><a class="anchor" aria-hidden="true" tabindex="-1" href="#가장-어려웠던-부분과-해결-과정"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>가장 어려웠던 부분과 해결 과정</h3>
<p>발제부터 2번 들었습니다. 가장 어려웠던 부분이라기 보다는.. 매 순간이 어려웠습니다.
제가 이해했다고 생각하고 코드를 작성하고 확인하면 매 순간 제 예상과 다른 결과였고, 이를 디버깅 하는 것에 대해 감을 잡는게 어려웠습니다.</p>
<p>제가 어려워하는 이유는 원리를 제대로 이해하고 있지 못하고 있기 때문이라고 생각했고, 어떤 부분을 이해하지 못하는 것인지 파악하기 위해 서버사이드 렌더링 흐름과 프로젝트 구조에 대한 파악을 해야겠다고 생각했습니다.</p>
<p>먼저, 브라우저의 서버 사이드 렌더링의 흐름을 한 번 정리하고 프로젝트의 구조를 이해해보고자 했습니다.
그리고 작성해야 하는 각 파일이 그 흐름 중 어디에서 동작하는지, 어떤 역할을 하는지 분석했습니다.</p>
<h4 id="ssr-기본-흐름"><a class="anchor" aria-hidden="true" tabindex="-1" href="#ssr-기본-흐름"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>SSR 기본 흐름</h4>
<ol>
<li>클라이언트 요청 → 서버에 문서 요청</li>
<li>서버 렌더링 → React 컴포넌트 실행하여 완전한 HTML 생성</li>
<li>응답 전송 → 브라우저에 HTML 전송</li>
<li>HTML 로드 → 브라우저가 HTML 렌더링</li>
<li>하이드레이션 → JS 번들 로드 후 인터랙티브 페이지 완성</li>
</ol>
<h4 id="진입점-파일들"><a class="anchor" aria-hidden="true" tabindex="-1" href="#진입점-파일들"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>진입점 파일들</h4>
<pre class="language-tsx"><code class="language-tsx code-highlight"><span class="code-line">packages<span class="token operator">/</span>vanilla<span class="token operator">/</span>
</span><span class="code-line">├── src<span class="token operator">/</span>
</span><span class="code-line">│   ├── main<span class="token punctuation">.</span><span class="token property-access">js</span>              # 클라이언트 <span class="token function">엔트리</span> <span class="token punctuation">(</span>하이드레이션 포함<span class="token punctuation">)</span>
</span><span class="code-line">│   ├── main<span class="token operator">-</span>server<span class="token punctuation">.</span><span class="token property-access">js</span>       # 서버 <span class="token function">엔트리</span> <span class="token punctuation">(</span><span class="token constant">SSR</span><span class="token punctuation">)</span>
</span><span class="code-line">│   ├── render<span class="token punctuation">.</span><span class="token property-access">js</span>            # 클라이언트 렌더링 로직
</span><span class="code-line">│   ├── stores<span class="token operator">/</span>              # 상태 관리
</span><span class="code-line">│   │   ├── productStore<span class="token punctuation">.</span><span class="token property-access">js</span>  # 상품 상태
</span><span class="code-line">│   │   ├── cartStore<span class="token punctuation">.</span><span class="token property-access">js</span>     # 장바구니 상태
</span><span class="code-line">│   │   └── uiStore<span class="token punctuation">.</span><span class="token property-access">js</span>       # <span class="token constant">UI</span> 상태
</span><span class="code-line">│   ├── services<span class="token operator">/</span>            # 비즈니스 로직
</span><span class="code-line">│   ├── router<span class="token operator">/</span>              # 라우팅
</span><span class="code-line">│   ├── pages<span class="token operator">/</span>               # 페이지 컴포넌트
</span><span class="code-line">│   ├── components<span class="token operator">/</span>          # <span class="token constant">UI</span> 컴포넌트
</span><span class="code-line">│   └── lib<span class="token operator">/</span>                 # 유틸리티
</span><span class="code-line">├── server<span class="token punctuation">.</span><span class="token property-access">js</span>                # <span class="token maybe-class-name">Express</span> <span class="token constant">SSR</span> 서버
</span><span class="code-line">└── <span class="token keyword">static</span><span class="token operator">-</span>site<span class="token operator">-</span>generate<span class="token punctuation">.</span><span class="token property-access">js</span>  # <span class="token constant">SSG</span> <span class="token punctuation">(</span>미완성<span class="token punctuation">)</span>
</span></code><div class="copied" data-code="packages/vanilla/
├── src/
│   ├── main.js              # 클라이언트 엔트리 (하이드레이션 포함)
│   ├── main-server.js       # 서버 엔트리 (SSR)
│   ├── render.js            # 클라이언트 렌더링 로직
│   ├── stores/              # 상태 관리
│   │   ├── productStore.js  # 상품 상태
│   │   ├── cartStore.js     # 장바구니 상태
│   │   └── uiStore.js       # UI 상태
│   ├── services/            # 비즈니스 로직
│   ├── router/              # 라우팅
│   ├── pages/               # 페이지 컴포넌트
│   ├── components/          # UI 컴포넌트
│   └── lib/                 # 유틸리티
├── server.js                # Express SSR 서버
└── static-site-generate.js  # SSG (미완성)
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>






























<table><thead><tr><th>파일</th><th>역할</th><th>동작 시점</th></tr></thead><tbody><tr><td>server.js</td><td>Express SSR 서버</td><td>서버 시작</td></tr><tr><td>main-server.js</td><td>SSR 렌더링 함수 제공</td><td>서버 요청 시</td></tr><tr><td>main.js</td><td>클라이언트 진입점 - 이벤트 등록, 라우터 시작, MSW 설정</td><td>브라우저 로드 시</td></tr><tr><td>render.js</td><td>렌더링 엔진 - Store 변화 감지하여 자동 리렌더링</td><td>클라이언트 런타임</td></tr></tbody></table>
<h4 id="vanilla-프로젝트-흐름"><a class="anchor" aria-hidden="true" tabindex="-1" href="#vanilla-프로젝트-흐름"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>vanilla 프로젝트 흐름</h4>
<p><strong>1. 서버 시작 (server.js)</strong></p>
<ul>
<li>Express 서버 초기화 및 포트 파인딩</li>
<li>개발/프로덕션 환경별 미들웨어 설정</li>
<li>Vite 개발 서버 연동</li>
<li>정적 파일 서빙 설정</li>
</ul>
<p><strong>2. 사용자 접근</strong></p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"><span class="token anchor function">^</span><span class="token group punctuation">(?!</span><span class="token char-set class-name">.</span><span class="token quantifier number">*</span><span class="token escape">\/</span>api<span class="token group punctuation">)</span><span class="token char-set class-name">.</span><span class="token quantifier number">*</span><span class="token anchor function">$</span></span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">try</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">normalizeUrl</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>originalUrl<span class="token punctuation">,</span> base<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 개발 환경에서만 매 요청마다 최신 모듈 로드 (HMR 지원)</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isProduction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      template <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      template <span class="token operator">=</span> <span class="token keyword">await</span> vite<span class="token punctuation">.</span><span class="token function">transformIndexHtml</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> template<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      render <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> vite<span class="token punctuation">.</span><span class="token function">ssrLoadModule</span><span class="token punctuation">(</span><span class="token string">&quot;/src/main-server.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>render<span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// SSR 렌더링</span>
</span><span class="code-line">    <span class="token keyword">const</span> rendered <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">render</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 클라이언트 하이드레이션용 초기 데이터 스크립트 생성</span>
</span><span class="code-line">    <span class="token keyword">const</span> initialDataScript <span class="token operator">=</span> rendered<span class="token punctuation">.</span>initialData
</span><span class="code-line">      <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;script&gt;window.__INITIAL_DATA__ = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>rendered<span class="token punctuation">.</span>initialData<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/script&gt;</span><span class="token template-punctuation string">`</span></span>
</span><span class="code-line">      <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">// 렌더링 결과를 HTML 템플릿에 주입</span>
</span><span class="code-line">    <span class="token keyword">const</span> html <span class="token operator">=</span> template
</span><span class="code-line">      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;!--app-head--&gt;&quot;</span><span class="token punctuation">,</span> rendered<span class="token punctuation">.</span>head <span class="token operator">??</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;!--app-html--&gt;&quot;</span><span class="token punctuation">,</span> rendered<span class="token punctuation">.</span>html <span class="token operator">??</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">      <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/head&gt;&quot;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>initialDataScript<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/head&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text/html&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token comment">// 개발 환경에서 스택 트레이스 정리</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isProduction <span class="token operator">&amp;&amp;</span> vite<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      vite<span class="token punctuation">.</span><span class="token function">ssrFixStacktrace</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;SSR 렌더링 에러:&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>stack<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="app.use(/^(?!.*\/api).*$/, async (req, res) =&gt; {
  try {
    const url = normalizeUrl(req.originalUrl, base);

    // 개발 환경에서만 매 요청마다 최신 모듈 로드 (HMR 지원)
    if (!isProduction) {
      template = await fs.readFile(&quot;./index.html&quot;, &quot;utf-8&quot;);
      template = await vite.transformIndexHtml(url, template);
      render = (await vite.ssrLoadModule(&quot;/src/main-server.js&quot;)).render;
    }

    // SSR 렌더링
    const rendered = await render(url, req.query);

    // 클라이언트 하이드레이션용 초기 데이터 스크립트 생성
    const initialDataScript = rendered.initialData
      ? `&lt;script&gt;window.__INITIAL_DATA__ = ${JSON.stringify(rendered.initialData)}&lt;/script&gt;`
      : &quot;&quot;;

    // 렌더링 결과를 HTML 템플릿에 주입
    const html = template
      .replace(&quot;&lt;!--app-head--&gt;&quot;, rendered.head ?? &quot;&quot;)
      .replace(&quot;&lt;!--app-html--&gt;&quot;, rendered.html ?? &quot;&quot;)
      .replace(&quot;&lt;/head&gt;&quot;, `${initialDataScript}&lt;/head&gt;`);

    res.status(200).set({ &quot;Content-Type&quot;: &quot;text/html&quot; }).send(html);
  } catch (error) {
    // 개발 환경에서 스택 트레이스 정리
    if (!isProduction &amp;&amp; vite) {
      vite.ssrFixStacktrace(error);
    }

    console.error(&quot;SSR 렌더링 에러:&quot;, error.message);
    res.status(500).end(error.stack);
  }
});
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<ul>
<li>main-server.js의 render 함수 호출</li>
<li>서버에서 페이지 컴포넌트를 실행하여 HTML 생성</li>
<li>초기 데이터를  window.__INITIAL_DATA__로 주입</li>
<li>완전한 HTML 문서를 브라우저에 전송</li>
</ul>
<p><strong>3. 서버사이드 렌더링 상세 과정</strong></p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>url<span class="token punctuation">,</span> query<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// 1. 라우터 설정 및 시작</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">&quot;http://localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span>query <span class="token operator">=</span> query<span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token comment">// 2. 라우트 찾기 및 핸들러 실행</span>
</span><span class="code-line">  <span class="token keyword">const</span> routeInfo <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">findRoute</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> routeInfo<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span>routeInfo<span class="token punctuation">.</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token keyword">return</span> result<span class="token punctuation">;</span> <span class="token comment">// { initialData, html, head }</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="export const render = async (url, query) =&gt; {
  // 1. 라우터 설정 및 시작
  router.setUrl(url, &quot;http://localhost&quot;);
  router.query = query;
  router.start();

  // 2. 라우트 찾기 및 핸들러 실행
  const routeInfo = router.findRoute(url);
  const result = await routeInfo.handler(routeInfo.params);
  
  return result; // { initialData, html, head }
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>4. 클라이언트 하이드레이션</strong>
JavaScript 로드 후 상태 복원 및 SPA 활성화</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">registerAllEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token function">registerGlobalEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token function">loadCartFromStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token function">initRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">MODE</span> <span class="token operator">!==</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">enableMocking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>main<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="function main() {
  registerAllEvents();
  registerGlobalEvents();
  loadCartFromStorage();
  initRender();
  router.start();
}

if (import.meta.env.MODE !== &quot;test&quot;) {
  enableMocking().then(main);
} else {
  main();
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[하이드레이션 상세 과정]</strong></p>
<ul>
<li>MSW 모킹 활성화</li>
<li>초기 데이터 복원</li>
</ul>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">// pages/HomePage.js:14-28</span>
</span><span class="code-line"><span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>__INITIAL_DATA__<span class="token operator">?.</span>products<span class="token operator">?.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> products<span class="token punctuation">,</span> categories<span class="token punctuation">,</span> totalCount <span class="token punctuation">}</span> <span class="token operator">=</span> window<span class="token punctuation">.</span>__INITIAL_DATA__<span class="token punctuation">;</span>
</span><span class="code-line">  productStore<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    type<span class="token operator">:</span> <span class="token constant">PRODUCT_ACTIONS</span><span class="token punctuation">.</span><span class="token constant">SETUP</span><span class="token punctuation">,</span>
</span><span class="code-line">    payload<span class="token operator">:</span> <span class="token punctuation">{</span> products<span class="token punctuation">,</span> categories<span class="token punctuation">,</span> totalCount<span class="token punctuation">,</span> loading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> status<span class="token operator">:</span> <span class="token string">&quot;done&quot;</span> <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">return</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// pages/HomePage.js:14-28
if (window.__INITIAL_DATA__?.products?.length &gt; 0) {
  const { products, categories, totalCount } = window.__INITIAL_DATA__;
  productStore.dispatch({
    type: PRODUCT_ACTIONS.SETUP,
    payload: { products, categories, totalCount, loading: false, status: &quot;done&quot; }
  });
  return;
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<ul>
<li>Store 구독 설정</li>
</ul>
<p><strong>5. 반응형 상태관리</strong>
사용자 액션 → Store 변경 → Observer 알림 → 자동 렌더링
<strong>6. SPA 라우팅</strong>
이후 네비게이션은 CSR로 처리 (페이지 새로고침 없음)</p>
<ul>
<li>클라이언트에서 URL 변경 감지</li>
<li>라우트 매칭 및 페이지 컴포넌트 실행</li>
<li>Store 상태 업데이트 및 자동 렌더링</li>
<li>브라우저 히스토리 API 활용</li>
</ul>
<p>이렇게 구조와 함께 흐름을 정리 하고 난 뒤에는 과제의 요구사항에 대한 이해가 되었습니다.
같은 이름의 함수가 두 곳에 있어서 혼란스러웠는데, 각 역할이 명확히 구분됨을 이해했습니다.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">// server.js - HTTP 서버 레이어 (웹서버 역할)</span>
</span><span class="code-line"><span class="token keyword">const</span> rendered <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">render</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// main-server.js의 render 호출</span>
</span><span class="code-line"><span class="token keyword">const</span> html <span class="token operator">=</span> template
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;!--app-html--&gt;&quot;</span><span class="token punctuation">,</span> rendered<span class="token punctuation">.</span>html<span class="token punctuation">)</span>    <span class="token comment">// 렌더링 결과를 HTML에 주입</span>
</span><span class="code-line">  <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;/head&gt;&quot;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>initialDataScript<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/head&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// main-server.js - 실제 SSR 로직 (SSR 엔진 역할)</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>url<span class="token punctuation">,</span> query<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">&quot;http://localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 라우팅</span>
</span><span class="code-line">  <span class="token keyword">const</span> routeInfo <span class="token operator">=</span> router<span class="token punctuation">.</span><span class="token function">findRoute</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>      
</span><span class="code-line">  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> routeInfo<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 컴포넌트 실행 &amp; 데이터 프리페칭</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span> html<span class="token punctuation">,</span> head<span class="token punctuation">,</span> initialData <span class="token punctuation">}</span><span class="token punctuation">;</span>           <span class="token comment">// React → HTML 변환 결과</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// server.js - HTTP 서버 레이어 (웹서버 역할)
const rendered = await render(url, req.query);  // main-server.js의 render 호출
const html = template
  .replace(&quot;&lt;!--app-html--&gt;&quot;, rendered.html)    // 렌더링 결과를 HTML에 주입
  .replace(&quot;&lt;/head&gt;&quot;, `${initialDataScript}&lt;/head&gt;`);

// main-server.js - 실제 SSR 로직 (SSR 엔진 역할)
export const render = async (url, query) =&gt; {
  router.setUrl(url, &quot;http://localhost&quot;);       // 라우팅
  const routeInfo = router.findRoute(url);      
  const result = await routeInfo.handler();     // 컴포넌트 실행 &amp; 데이터 프리페칭
  return { html, head, initialData };           // React → HTML 변환 결과
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>main.js와 main-server.js에 대해 모호했던 것들에 대한 이해가 되었고, 디버깅 할 때도 서버 렌더링 문제인지, 클라이언트 하이드레이션 관련 문제인지를 구분할 수 있었습니다.</p>
<br/>
<h3 id="구현하면서-새롭게-알게-된-개념"><a class="anchor" aria-hidden="true" tabindex="-1" href="#구현하면서-새롭게-알게-된-개념"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>구현하면서 새롭게 알게 된 개념</h3>
<h4 id="서버사이드에서의-인스턴스-생성-전략"><a class="anchor" aria-hidden="true" tabindex="-1" href="#서버사이드에서의-인스턴스-생성-전략"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>서버사이드에서의 인스턴스 생성 전략</h4>
<p>SSR 환경은 클라이언트/서버에 맞게 각각 다른 라우터를 써야 하는데, 이러한 환경에서 팩토리 패턴은 유용할 수 있습니다.</p>
<p><strong>[현재]</strong>
라우터를 싱글톤으로 생성하여 사용하고 있습니다.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token keyword">const</span> CurrentRouter <span class="token operator">=</span> <span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span> <span class="token operator">?</span> Router <span class="token operator">:</span> ServerRouter<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CurrentRouter</span><span class="token punctuation">(</span><span class="token constant">BASE_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span></code><div class="copied" data-code="const CurrentRouter = typeof window !== &quot;undefined&quot; ? Router : ServerRouter;

export const router = new CurrentRouter(BASE_URL);

"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[발생한 문제들]</strong></p>
<ol>
<li>E2E 테스트 동시성 문제
여러 테스트가 동시에 같은 라우터 인스턴스를 공유하여 net::ERR_CONNECTION_REFUSED 및 상태 오염 발생했습니다.</li>
<li>라우터 상태 공유 문제</li>
<li>클라이언트 하이드레이션 실패</li>
</ol>
<ul>
<li>window.__INITIAL_DATA__가 제대로 주입되지 않음</li>
<li>SSR이 실패하여 CSR로 fallback</li>
</ul>
<p>근본적인 원인은 동시성 문제였습니다.
여러 요청이 하나의 라우터 인스턴스 상태를 공유하면서 발생한 문제였습니다.</p>
<p><strong>[동시성 문제가 발생하는 원리]</strong>
Node.js는 싱글 스레드 이벤트 루프로 동작하지만, <strong>비동기 요청들은 동시에 처리</strong>됩니다.
문제는 다음과 같은 상황에서 발생했습니다.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 전역 싱글톤 라우터</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CurrentRouter</span><span class="token punctuation">(</span><span class="token constant">BASE_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 동시에 들어온 요청들</span>
</span><span class="code-line"><span class="token comment">// 요청 A: /products </span>
</span><span class="code-line"><span class="token comment">// 요청 B: /.well-known/something</span>
</span><span class="code-line"><span class="token comment">// 요청 C: /</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> query</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">setUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">&quot;http://localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ← 여기서 문제!</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token property-access">query</span> <span class="token operator">=</span> query<span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token comment">// ...</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// 전역 싱글톤 라우터
export const router = new CurrentRouter(BASE_URL);

// 동시에 들어온 요청들
// 요청 A: /products 
// 요청 B: /.well-known/something
// 요청 C: /

export const render = async (url, query) =&gt; {
  router.setUrl(url, &quot;http://localhost&quot;);  // ← 여기서 문제!
  router.query = query;
  router.start();
  // ...
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>[실행 순서]</p>
<ol>
<li>요청 A가 router.setUrl(&quot;/products&quot;)를 호출</li>
<li>요청 B가 router.setUrl(&quot;/.well-known/something&quot;)를 호출 → A의 상태 덮어씀</li>
<li>요청 C가 router.setUrl(&quot;/&quot;)를 호출 → B의 상태 덮어씀</li>
<li>각 요청이 router.findRoute()를 호출할 때는 마지막에 설정된 URL만 남아있음</li>
</ol>
<p>결과적으로,</p>
<ul>
<li>요청 A는 자신이 설정한 <code>/products</code>가 아닌 <code>/</code>로 라우팅</li>
<li>요청 B는 예상과 다른 결과 받음</li>
<li>하나의 라우터 인스턴스가 여러 요청의 상태를 뒤섞어서 예측 불가능한 동작 발생</li>
</ul>
<p>근본적인 원인은 상태를 가진 객체를 여러 비동기 요청이 공유하면서 발생하는 전형적인 동시성 문제였습니다.</p>
<p>개선을 시도해볼 수 있는 방법은 여러가지가 있었습니다.</p>
<ol>
<li>
<p>서버사이드에서 라우터 인스턴스를 개별 생성한다.</p>
</li>
<li>
<p>서버사이드에서 msw를 사용하는 비동기 이슈를 발생시키지 않고,  동기적으로 목데이터를 활용하여 데이터를 호출한다.</p>
</li>
</ol>
<p>저는 라우터 인스턴스를 개별 생성하는 것이 더 적절하다고 생각했지만, 병목이 발생하여 과제에는 목데이터를 사용하여 해결했습니다.
따라서 개선 방안에는 라우터 인스턴스를 생성하여 해결하는 과정을 정리해보았습니다.</p>
<p><strong>[개선 방안]</strong></p>
<ol>
<li>main-server.js 수정</li>
</ol>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// 기존: 전역 라우터 사용</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> query</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">setUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">&quot;http://localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 상태 공유 문제</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 개선: 요청마다 새 라우터 생성</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> query</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerRouter</span><span class="token punctuation">(</span><span class="token constant">BASE_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 독립적인 인스턴스</span>
</span><span class="code-line">  
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">addRoute</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token maybe-class-name">HomePage</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">addRoute</span><span class="token punctuation">(</span><span class="token string">&quot;/product/:id/&quot;</span><span class="token punctuation">,</span> <span class="token maybe-class-name">ProductDetailPage</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">addRoute</span><span class="token punctuation">(</span><span class="token string">&quot;.*&quot;</span><span class="token punctuation">,</span> <span class="token maybe-class-name">NotFoundPage</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">setUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token string">&quot;http://localhost&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token property-access">query</span> <span class="token operator">=</span> query<span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// 기존: 전역 라우터 사용
export const render = async (url, query) =&gt; {
  router.setUrl(url, &quot;http://localhost&quot;);  // 상태 공유 문제
};

// 개선: 요청마다 새 라우터 생성
export const render = async (url, query) =&gt; {
  const router = new ServerRouter(BASE_URL);  // 독립적인 인스턴스
  
  router.addRoute(&quot;/&quot;, HomePage);
  router.addRoute(&quot;/product/:id/&quot;, ProductDetailPage);
  router.addRoute(&quot;.*&quot;, NotFoundPage);
  
  router.setUrl(url, &quot;http://localhost&quot;);
  router.query = query;
  router.start();
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<ol start="2">
<li>클라이언트는 싱글톤 유지</li>
</ol>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// main.js - 클라이언트는 싱글톤 유지 (문제없음)</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> router <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;./router/router.js&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">registerAllEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token function">registerGlobalEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token function">loadCartFromStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token function">initRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 하나의 브라우저 세션에서는 싱글톤이 적절</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// main.js - 클라이언트는 싱글톤 유지 (문제없음)
import { router } from &#x27;./router/router.js&#x27;;
function main() {
  registerAllEvents();
  registerGlobalEvents();
  loadCartFromStorage();
  initRender();
  router.start(); // 하나의 브라우저 세션에서는 싱글톤이 적절
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>Next.js, Nuxt.js와 같은 프레임워크들이 요청별로 독립적인 컨텍스트를 생성하는 이유이기도 합니다.
Next.js에서 Tanstack Query의 인스턴스를 사용할 때, <strong>왜 SSR에서는 매번 인스턴스를 생성해야 하는지</strong>에 대해 생각해보지 않았었는데 이번 과제를 통해 근본적인 원인을 알아가게 되었습니다.</p>
<h2 id="학습-갈무리"><a class="anchor" aria-hidden="true" tabindex="-1" href="#학습-갈무리"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>학습 갈무리</h2>
<h3 id="q1-현재-구현한-ssrssg-아키텍처에서-확장성을-고려할-때-어떤-부분을-개선하시겠습니까"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q1-현재-구현한-ssrssg-아키텍처에서-확장성을-고려할-때-어떤-부분을-개선하시겠습니까"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q1. 현재 구현한 SSR/SSG 아키텍처에서 확장성을 고려할 때 어떤 부분을 개선하시겠습니까</h3>
<h4 id="1-라우터-확장성-개선"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-라우터-확장성-개선"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. 라우터 확장성 개선</h4>
<p>SSR 환경은 클라이언트/서버에 맞게 각각 다른 라우터를 써야 하는데, 이러한 환경에서 팩토리 패턴은 유용할 수 있습니다.</p>
<p><strong>[현재]</strong>
라우터를 싱글톤으로 생성하여 사용하고 있습니다.</p>
<p><strong>[개선 방안]</strong></p>
<ul>
<li>RouterFactory 패턴으로 확장성 개선</li>
</ul>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name">RouterFactory</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">static</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token parameter">environment<span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> baseConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token literal-property property">timeout</span><span class="token operator">:</span> options<span class="token punctuation">.</span><span class="token property-access">timeout</span> <span class="token operator">||</span> <span class="token number">5000</span><span class="token punctuation">,</span>
</span><span class="code-line">      <span class="token literal-property property">enableLogging</span><span class="token operator">:</span> options<span class="token punctuation">.</span><span class="token property-access">debug</span> <span class="token operator">||</span> <span class="token boolean">false</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword control-flow">switch</span> <span class="token punctuation">(</span>environment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">case</span> <span class="token string">&#x27;client&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token spread operator">...</span>baseConfig<span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">history</span><span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token literal-property property">enablePushState</span><span class="token operator">:</span> <span class="token boolean">true</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      
</span><span class="code-line">      <span class="token keyword">case</span> <span class="token string">&#x27;server&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">ServerRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token spread operator">...</span>baseConfig<span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token literal-property property">enableConcurrency</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token literal-property property">memoryLimit</span><span class="token operator">:</span> options<span class="token punctuation">.</span><span class="token property-access">memoryLimit</span> <span class="token operator">||</span> <span class="token string">&#x27;512mb&#x27;</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      
</span><span class="code-line">      <span class="token keyword">case</span> <span class="token string">&#x27;test&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">TestRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token spread operator">...</span>baseConfig<span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token literal-property property">mockHistory</span><span class="token operator">:</span> options<span class="token punctuation">.</span><span class="token property-access">mockHistory</span><span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token literal-property property">enableSnapshot</span><span class="token operator">:</span> <span class="token boolean">true</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        
</span><span class="code-line">      <span class="token keyword">case</span> <span class="token string">&#x27;worker&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">        <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">WorkerRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token spread operator">...</span>baseConfig<span class="token punctuation">,</span>
</span><span class="code-line">          <span class="token literal-property property">messagePort</span><span class="token operator">:</span> options<span class="token punctuation">.</span><span class="token property-access">port</span>
</span><span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 환경별 사용 예시</span>
</span><span class="code-line"><span class="token keyword">const</span> devRouter <span class="token operator">=</span> <span class="token maybe-class-name">RouterFactory</span><span class="token punctuation">.</span><span class="token method function property-access">createRouter</span><span class="token punctuation">(</span><span class="token string">&#x27;server&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> 
</span><span class="code-line">  <span class="token literal-property property">debug</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> 
</span><span class="code-line">  <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">10000</span> 
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">const</span> testRouter <span class="token operator">=</span> <span class="token maybe-class-name">RouterFactory</span><span class="token punctuation">.</span><span class="token method function property-access">createRouter</span><span class="token punctuation">(</span><span class="token string">&#x27;test&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> 
</span><span class="code-line">  <span class="token literal-property property">mockHistory</span><span class="token operator">:</span> mockHistoryInstance 
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="export class RouterFactory {
  static createRouter(environment, options = {}) {
    const baseConfig = {
      timeout: options.timeout || 5000,
      enableLogging: options.debug || false
    };

    switch (environment) {
      case &#x27;client&#x27;:
        return new Router({
          ...baseConfig,
          history: window.history,
          enablePushState: true
        });
      
      case &#x27;server&#x27;:
        return new ServerRouter({
          ...baseConfig,
          enableConcurrency: true,
          memoryLimit: options.memoryLimit || &#x27;512mb&#x27;
        });
      
      case &#x27;test&#x27;:
        return new TestRouter({
          ...baseConfig,
          mockHistory: options.mockHistory,
          enableSnapshot: true
        });
        
      case &#x27;worker&#x27;:
        return new WorkerRouter({
          ...baseConfig,
          messagePort: options.port
        });
    }
  }
}

// 환경별 사용 예시
const devRouter = RouterFactory.createRouter(&#x27;server&#x27;, { 
  debug: true, 
  timeout: 10000 
});

const testRouter = RouterFactory.createRouter(&#x27;test&#x27;, { 
  mockHistory: mockHistoryInstance 
});
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<ul>
<li>미들웨어와 플러그인 지원</li>
</ul>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// 환경별로 다른 미들웨어 적용</span>
</span><span class="code-line"><span class="token keyword">case</span> <span class="token string">&#x27;server&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerRouter</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SecurityMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoggingMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword control-flow">return</span> router<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">case</span> <span class="token string">&#x27;client&#x27;</span><span class="token operator">:</span>
</span><span class="code-line">  <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  router<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AnalyticsMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword control-flow">return</span> router<span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// 환경별로 다른 미들웨어 적용
case &#x27;server&#x27;:
  const router = new ServerRouter(baseConfig);
  router.use(new SecurityMiddleware());
  router.use(new LoggingMiddleware());
  return router;

case &#x27;client&#x27;:
  const router = new Router(baseConfig);
  router.use(new AnalyticsMiddleware());
  return router;
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[개선 효과]</strong></p>
<ul>
<li>각 환경(서버/클라이언트/테스트)에 필요한 설정과 의존성을 한 곳에서 관리할 수 있습니다.</li>
<li>환경이 달라도 동일한 방식으로 라우터 생성 가능합니다.</li>
<li>Worker, Electron 등 새로운 실행 환경에 대한 라우터를 switch 문에 추가만 하면 확장 가능합니다.</li>
</ul>
<h4 id="2-캐싱-전략-개선"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-캐싱-전략-개선"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. 캐싱 전략 개선</h4>
<p><strong>[현재]</strong>
현재는 매 요청마다 서버에서 렌더링을 수행하고 있습니다.</p>
<p><strong>[개선 방안]</strong>
계층별 캐싱 전략을 적용해 성능과 확장성을 개선할 수 있습니다.</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">CacheManager</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">pageCache</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 페이지 레벨 캐싱</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">componentCache</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 컴포넌트 레벨 캐싱</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">dataCache</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// API 응답 캐싱</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">async</span> <span class="token function">getOrRender</span><span class="token punctuation">(</span><span class="token parameter">cacheKey<span class="token punctuation">,</span> renderFn<span class="token punctuation">,</span> ttl <span class="token operator">=</span> <span class="token number">3600</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">pageCache</span><span class="token punctuation">.</span><span class="token method function property-access">has</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword control-flow">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">pageCache</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">renderFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">pageCache</span><span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token comment">// TTL 적용</span>
</span><span class="code-line">    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">pageCache</span><span class="token punctuation">.</span><span class="token method function property-access">delete</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">)</span><span class="token punctuation">,</span> ttl <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> result<span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 사용 예시</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> query</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> cacheKey <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token keyword control-flow">return</span> cacheManager<span class="token punctuation">.</span><span class="token method function property-access">getOrRender</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token maybe-class-name">RouterFactory</span><span class="token punctuation">.</span><span class="token method function property-access">createRouter</span><span class="token punctuation">(</span><span class="token string">&#x27;server&#x27;</span><span class="token punctuation">,</span> <span class="token constant">BASE_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token comment">// ... 기존 렌더링 로직</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="class CacheManager {
  constructor() {
    this.pageCache = new Map();     // 페이지 레벨 캐싱
    this.componentCache = new Map(); // 컴포넌트 레벨 캐싱
    this.dataCache = new Map();     // API 응답 캐싱
  }

  async getOrRender(cacheKey, renderFn, ttl = 3600) {
    if (this.pageCache.has(cacheKey)) {
      return this.pageCache.get(cacheKey);
    }
    
    const result = await renderFn();
    this.pageCache.set(cacheKey, result);
    
    // TTL 적용
    setTimeout(() =&gt; this.pageCache.delete(cacheKey), ttl * 1000);
    return result;
  }
}

// 사용 예시
export const render = async (url, query) =&gt; {
  const cacheKey = `${url}?${new URLSearchParams(query).toString()}`;
  
  return cacheManager.getOrRender(cacheKey, async () =&gt; {
    const router = RouterFactory.createRouter(&#x27;server&#x27;, BASE_URL);
    // ... 기존 렌더링 로직
  });
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[개선 효과]</strong></p>
<ul>
<li>성능 향상: 동일한 페이지 요청 시 캐시된 결과 즉시 반환</li>
<li>서버 부하 감소: 렌더링 작업 최소화로 CPU 사용량 절약</li>
<li>확장성: 캐시 무효화 전략과 분산 캐시 적용으로 대규모 트래픽 대응</li>
<li>SEO 최적화: 빠른 응답 시간으로 검색 엔진 최적화 개선</li>
</ul>
<br/>
<h3 id="q2-express-서버-대신-다른-런타임cloudflare-workers-vercel-edge-functions-등을-사용한다면-어떤-점을-수정해야-할까요"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q2-express-서버-대신-다른-런타임cloudflare-workers-vercel-edge-functions-등을-사용한다면-어떤-점을-수정해야-할까요"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q2. Express 서버 대신 다른 런타임(Cloudflare Workers, Vercel Edge Functions 등)을 사용한다면 어떤 점을 수정해야 할까요?</h3>
<p>Express는 전통적인 Node.js 서버 환경에서 동작하는 반면, Cloudflare Workers나 Vercel Edge Functions 같은 서버리스 환경은 여러 환경에서 호환되는 웹 표준 API을 기반으로 동작합니다.
따라서 다른 런타임에서도 동작하기 위해서는 Node.js에 의존적인 부분을 웹 표준 API를 기반으로 변경해야 합니다.</p>
<p>수정이 필요한 부분들은 아래와 같습니다.</p>
<h4 id="1-서버-초기화-방식-변경"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-서버-초기화-방식-변경"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. 서버 초기화 방식 변경</h4>
<p><strong>[Express]</strong></p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">static</span><span class="token punctuation">(</span><span class="token string">&#x27;dist&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Server running on </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="const app = express();
app.use(express.static(&#x27;dist&#x27;));
app.listen(PORT, () =&gt; console.log(`Server running on ${PORT}`));
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[서버리스 환경으로 수정]</strong></p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// Cloudflare Workers</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">async</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> env<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token property-access">url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token comment">// SSR 로직</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&#x27;Content-Type&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;text/html&#x27;</span> <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Vercel Edge Functions</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token property-access">url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token comment">// SSR 로직</span>
</span><span class="code-line">  <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// Cloudflare Workers
export default {
  async fetch(request, env, ctx) {
    const url = new URL(request.url);
    // SSR 로직
    return new Response(html, {
      headers: { &#x27;Content-Type&#x27;: &#x27;text/html&#x27; }
    });
  }
};

// Vercel Edge Functions
export default async function handler(request) {
  const url = new URL(request.url);
  // SSR 로직
  return new Response(html);
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h4 id="2-파일-시스템-접근-제거"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-파일-시스템-접근-제거"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. 파일 시스템 접근 제거</h4>
<p><strong>[기존 문제가 되는 코드]</strong></p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// server.js - 파일 시스템 의존</span>
</span><span class="code-line">template <span class="token operator">=</span> <span class="token keyword control-flow">await</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readFile</span><span class="token punctuation">(</span><span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// server.js - 파일 시스템 의존
template = await fs.readFile(&quot;./index.html&quot;, &quot;utf-8&quot;);
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[서버리스 대응으로 수정]</strong></p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 빌드 타임에 템플릿을 번들에 포함</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports">templateContent</span> <span class="token keyword module">from</span> <span class="token string">&#x27;./index.html?raw&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> template <span class="token operator">=</span> templateContent<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 또는 환경 변수로 주입</span>
</span><span class="code-line"><span class="token keyword">const</span> template <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token constant">HTML_TEMPLATE</span> <span class="token operator">||</span> templateContent<span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// 빌드 타임에 템플릿을 번들에 포함
import templateContent from &#x27;./index.html?raw&#x27;;
const template = templateContent;

// 또는 환경 변수로 주입
const template = env.HTML_TEMPLATE || templateContent;
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h4 id="3-상태-관리-방식-변경"><a class="anchor" aria-hidden="true" tabindex="-1" href="#3-상태-관리-방식-변경"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>3. 상태 관리 방식 변경</h4>
<p><strong>[Express]</strong></p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token keyword">let</span> globalCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 서버리스에서는 요청 간 공유 안됨</span>
</span></code><div class="copied" data-code="let globalCache = new Map(); // 서버리스에서는 요청 간 공유 안됨
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[외부 스토리지로 수정]</strong></p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// Cloudflare Workers</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">async</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> env<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> cached <span class="token operator">=</span> <span class="token keyword control-flow">await</span> env<span class="token punctuation">.</span><span class="token constant">CACHE_KV</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cached<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">renderPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">      <span class="token keyword control-flow">await</span> env<span class="token punctuation">.</span><span class="token constant">CACHE_KV</span><span class="token punctuation">.</span><span class="token method function property-access">put</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">,</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">parse</span><span class="token punctuation">(</span>cached<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">html</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// Vercel Edge Functions</span>
</span><span class="code-line"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> kv <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">&#x27;@vercel/kv&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> cached <span class="token operator">=</span> <span class="token keyword control-flow">await</span> kv<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cached<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword control-flow">await</span> kv<span class="token punctuation">.</span><span class="token method function property-access">setex</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">,</span> <span class="token number">3600</span><span class="token punctuation">,</span> <span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// Cloudflare Workers
export default {
  async fetch(request, env, ctx) {
    const cached = await env.CACHE_KV.get(cacheKey);
    if (!cached) {
      const result = await renderPage();
      await env.CACHE_KV.put(cacheKey, JSON.stringify(result));
    }
    return new Response(JSON.parse(cached).html);
  }
};

// Vercel Edge Functions
import { kv } from &#x27;@vercel/kv&#x27;;
const cached = await kv.get(cacheKey);
if (!cached) {
  await kv.setex(cacheKey, 3600, JSON.stringify(result));
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h4 id="4-요청응답-처리-방식-수정"><a class="anchor" aria-hidden="true" tabindex="-1" href="#4-요청응답-처리-방식-수정"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>4. 요청/응답 처리 방식 수정</h4>
<p><strong>[Express]</strong></p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">&#x27;*&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> query <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token property-access">query</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> headers <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">;</span>
</span><span class="code-line">  res<span class="token punctuation">.</span><span class="token method function property-access">setHeader</span><span class="token punctuation">(</span><span class="token string">&#x27;Content-Type&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;text/html&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="app.get(&#x27;*&#x27;, (req, res) =&gt; {
  const query = req.query;
  const headers = req.headers;
  res.setHeader(&#x27;Content-Type&#x27;, &#x27;text/html&#x27;);
  res.send(html);
});
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[Web API 표준으로 수정]</strong></p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// 서버리스 환경에서는 Web API 사용</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token property-access">url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">fromEntries</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token property-access">searchParams</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> headers <span class="token operator">=</span> <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">fromEntries</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token property-access">headers</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token keyword control-flow">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&#x27;Content-Type&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;text/html&#x27;</span> <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// 서버리스 환경에서는 Web API 사용
export default async function handler(request) {
  const url = new URL(request.url);
  const query = Object.fromEntries(url.searchParams);
  const headers = Object.fromEntries(request.headers);
  
  return new Response(html, {
    headers: { &#x27;Content-Type&#x27;: &#x27;text/html&#x27; }
  });
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>이렇게 Node.js 런타임에서 동작하는 부분을 웹 표준을 준수하는 코드로 전환하는 것이 핵심입니다.</p>
<br/>
<h3 id="q3-현재-구현에서-성능-병목이-될-수-있는-지점은-어디이고-어떻게-개선하시겠습니까"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q3-현재-구현에서-성능-병목이-될-수-있는-지점은-어디이고-어떻게-개선하시겠습니까"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q3. 현재 구현에서 성능 병목이 될 수 있는 지점은 어디이고, 어떻게 개선하시겠습니까?</h3>
<p><strong>[문제점]</strong>
개발 환경에서 매 요청마다 파일을 읽고 모듈을 로드하고 있습니다.</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isProduction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  template <span class="token operator">=</span> <span class="token keyword control-flow">await</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readFile</span><span class="token punctuation">(</span><span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  template <span class="token operator">=</span> <span class="token keyword control-flow">await</span> vite<span class="token punctuation">.</span><span class="token method function property-access">transformIndexHtml</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> template<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  render <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword control-flow">await</span> vite<span class="token punctuation">.</span><span class="token method function property-access">ssrLoadModule</span><span class="token punctuation">(</span><span class="token string">&quot;/src/main-server.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">render</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="if (!isProduction) {
  template = await fs.readFile(&quot;./index.html&quot;, &quot;utf-8&quot;);
  template = await vite.transformIndexHtml(url, template);
  render = (await vite.ssrLoadModule(&quot;/src/main-server.js&quot;)).render;
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[개선 방안]</strong></p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword">const</span> moduleCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> templateCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 개발 환경에서만 매 요청마다 최신 모듈 로드 (HMR 지원)</span>
</span><span class="code-line"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isProduction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> cacheKey <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">template_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>templateCache<span class="token punctuation">.</span><span class="token method function property-access">has</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> fileTemplate <span class="token operator">=</span> <span class="token keyword control-flow">await</span> fs<span class="token punctuation">.</span><span class="token method function property-access">readFile</span><span class="token punctuation">(</span><span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    <span class="token keyword">const</span> transformedTemplate <span class="token operator">=</span> <span class="token keyword control-flow">await</span> vite<span class="token punctuation">.</span><span class="token method function property-access">transformIndexHtml</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> fileTemplate<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    templateCache<span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">,</span> transformedTemplate<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  
</span><span class="code-line">  template <span class="token operator">=</span> templateCache<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>moduleCache<span class="token punctuation">.</span><span class="token method function property-access">has</span><span class="token punctuation">(</span><span class="token string">&#x27;render&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword">const</span> renderModule <span class="token operator">=</span> <span class="token keyword control-flow">await</span> vite<span class="token punctuation">.</span><span class="token method function property-access">ssrLoadModule</span><span class="token punctuation">(</span><span class="token string">&quot;/src/main-server.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    moduleCache<span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span><span class="token string">&#x27;render&#x27;</span><span class="token punctuation">,</span> renderModule<span class="token punctuation">.</span><span class="token property-access">render</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  
</span><span class="code-line">  render <span class="token operator">=</span> moduleCache<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">&#x27;render&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="const moduleCache = new Map();
const templateCache = new Map();

// 개발 환경에서만 매 요청마다 최신 모듈 로드 (HMR 지원)
if (!isProduction) {
  const cacheKey = `template_${url}`;
  
  if (!templateCache.has(cacheKey)) {
    const fileTemplate = await fs.readFile(&quot;./index.html&quot;, &quot;utf-8&quot;);
    const transformedTemplate = await vite.transformIndexHtml(url, fileTemplate);
    templateCache.set(cacheKey, transformedTemplate);
  }
  
  template = templateCache.get(cacheKey);
  
  if (!moduleCache.has(&#x27;render&#x27;)) {
    const renderModule = await vite.ssrLoadModule(&quot;/src/main-server.js&quot;);
    moduleCache.set(&#x27;render&#x27;, renderModule.render);
  }
  
  render = moduleCache.get(&#x27;render&#x27;);
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<ul>
<li>파일 시스템 접근(fs.readFile)은 상대적으로 느린 I/O 작업인데, 캐싱으로 두 번 째 요청부터는 메모리에서 즉시 반환합니다.</li>
<li>vite.ssrLoadModule은 모듈 파싱, 변환, 평가 과정을 거치기 때문에 한 번 로드된 모듈을 재사용하여 CPU 사용량 감소할 수 있습니다.</li>
<li>vite.transformIndexHtml은 HTML 변환 작업 수행하는데, 이 작업을 재사용하여 비용을 줄일 수 있습니다.</li>
</ul>
<br/>
<h3 id="q4-1000개-이상의-상품-페이지를-ssg로-생성할-때-고려해야-할-사항은-무엇입니까"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q4-1000개-이상의-상품-페이지를-ssg로-생성할-때-고려해야-할-사항은-무엇입니까"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q4. 1000개 이상의 상품 페이지를 SSG로 생성할 때 고려해야 할 사항은 무엇입니까?</h3>
<p>SSG는 빌드 타임에 모든 페이지를 미리 생성하여 <strong>런타임 성능 최적화와 함께 빠른 응답 속도를 목표</strong>로 사용된다고 생각합니다.
따라서 이러한 점에 초점을 맞추어 고려해본다면 아래와 같이 정리할 수 있습니다.</p>
<h4 id="1-빌드-시간-최적화"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-빌드-시간-최적화"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. 빌드 시간 최적화</h4>
<p>빠른 배포와 지속적인 업데이트를 위해서는 빌드 시간이 관리 가능한 범위 내에 있어야 합니다.</p>
<p><strong>[병렬 처리]</strong></p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword">const</span> <span class="token constant">BATCH_SIZE</span> <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> batches <span class="token operator">=</span> <span class="token function">chunk</span><span class="token punctuation">(</span>products<span class="token punctuation">,</span> <span class="token constant">BATCH_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> batch <span class="token keyword">of</span> batches<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword control-flow">await</span> <span class="token known-class-name class-name">Promise</span><span class="token punctuation">.</span><span class="token method function property-access">all</span><span class="token punctuation">(</span>batch<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">product</span> <span class="token arrow operator">=&gt;</span> <span class="token function">generateProductPage</span><span class="token punctuation">(</span>product<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="const BATCH_SIZE = 50;
const batches = chunk(products, BATCH_SIZE);

for (const batch of batches) {
  await Promise.all(batch.map(product =&gt; generateProductPage(product.id)));
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[증분 빌드]</strong>
전체 1000개 상품 중 실제로 변경되는 것은 보통 5-10% 내외입니다. 변경되지 않은 990개 페이지를 매번 재생성하는 것은 비효율적입니다.
따라서,</p>
<ul>
<li>변경된 상품만 재생성하여 전체 빌드 시간 단축</li>
<li>변경 감지 기반으로 불필요한 재빌드 방지</li>
</ul>
<h4 id="2-메모리-사용량-관리"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-메모리-사용량-관리"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. 메모리 사용량 관리</h4>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// 문제가 되는 패턴</span>
</span><span class="code-line"><span class="token keyword">const</span> allProducts <span class="token operator">=</span> <span class="token keyword control-flow">await</span> db<span class="token punctuation">.</span><span class="token method function property-access">getAllProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1000개 × 10KB = 10MB</span>
</span><span class="code-line"><span class="token keyword">const</span> pages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> product <span class="token keyword">of</span> allProducts<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">renderPage</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 렌더링 중 메모리 누적</span>
</span><span class="code-line">  pages<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 생성된 HTML도 메모리에 계속 보관</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line"><span class="token comment">// 최종적으로 100MB+ 메모리 사용 가능</span>
</span></code><div class="copied" data-code="// 문제가 되는 패턴
const allProducts = await db.getAllProducts(); // 1000개 × 10KB = 10MB
const pages = [];

for (const product of allProducts) {
  const html = await renderPage(product); // 렌더링 중 메모리 누적
  pages.push(html); // 생성된 HTML도 메모리에 계속 보관
}
// 최종적으로 100MB+ 메모리 사용 가능
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[메모리 관리가 필요한 이유]</strong></p>
<ul>
<li>각 페이지 렌더링 시 가상 DOM 생성으로 실제 데이터의 5-10배 메모리 사용</li>
<li>템플릿 엔진이 중간 객체들을 생성하며 메모리 사용량 증가</li>
<li>기본 힙 크기 제한(약 1.7GB)에 도달하면 빌드 실패</li>
</ul>
<p><strong>[개선 방안]</strong>
스트리밍 방식으로 데이터 처리</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">generateWithMemoryManagement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> productStream <span class="token operator">=</span> <span class="token function">getProductStream</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 100개씩 스트리밍</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token keyword control-flow">for</span> <span class="token keyword control-flow">await</span> <span class="token punctuation">(</span><span class="token keyword">const</span> productBatch <span class="token keyword">of</span> productStream<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token keyword control-flow">await</span> <span class="token function">processBatch</span><span class="token punctuation">(</span>productBatch<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    productBatch <span class="token operator">=</span> <span class="token keyword null nil">null</span><span class="token punctuation">;</span> <span class="token comment">// 명시적 참조 해제</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>global<span class="token punctuation">.</span><span class="token property-access">gc</span><span class="token punctuation">)</span> global<span class="token punctuation">.</span><span class="token method function property-access">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 가비지 컬렉션 강제 실행</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="async function generateWithMemoryManagement() {
  const productStream = getProductStream(100); // 100개씩 스트리밍
  
  for await (const productBatch of productStream) {
    await processBatch(productBatch);
    productBatch = null; // 명시적 참조 해제
    
    if (global.gc) global.gc(); // 가비지 컬렉션 강제 실행
  }
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h4 id="3-cdn-캐시-무효화-전략"><a class="anchor" aria-hidden="true" tabindex="-1" href="#3-cdn-캐시-무효화-전략"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>3. CDN 캐시 무효화 전략</h4>
<p>상품 하나가 변경될 때마다 전체 CDN 캐시를 무효화한다면 다음과 같은 문제점이 발생할 수 있습니다.</p>
<ul>
<li>성능 저하: 다음 사용자 요청 시 모든 페이지가 origin 서버에서 다시 로드</li>
<li>서버 부하: 1000개 페이지가 동시에 캐시 미스로 origin 서버에 몰림</li>
<li>비용 증가: CDN 무효화 요청 횟수에 따른 비용 발생</li>
</ul>
<p><strong>[선택적 무효화]</strong></p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// 스마트한 무효화 전략</span>
</span><span class="code-line"><span class="token keyword">const</span> invalidationPaths <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line">  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/product/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>changedProductId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>           <span class="token comment">// 변경된 상품 페이지</span>
</span><span class="code-line">  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/category/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>product<span class="token punctuation">.</span><span class="token property-access">categoryId</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>        <span class="token comment">// 해당 카테고리 페이지</span>
</span><span class="code-line">  <span class="token string">&#x27;/products&#x27;</span><span class="token punctuation">,</span>                              <span class="token comment">// 상품 목록 페이지</span>
</span><span class="code-line">  <span class="token string">&#x27;/sitemap.xml&#x27;</span>                           <span class="token comment">// 사이트맵</span>
</span><span class="code-line"><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token comment">// 4개 페이지만 무효화하여 996개 페이지의 캐시 효율성 유지</span>
</span></code><div class="copied" data-code="// 스마트한 무효화 전략
const invalidationPaths = [
  `/product/${changedProductId}`,           // 변경된 상품 페이지
  `/category/${product.categoryId}`,        // 해당 카테고리 페이지
  &#x27;/products&#x27;,                              // 상품 목록 페이지
  &#x27;/sitemap.xml&#x27;                           // 사이트맵
];
// 4개 페이지만 무효화하여 996개 페이지의 캐시 효율성 유지
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p><strong>[개선 효과]</strong></p>
<ul>
<li>응답 속도 유지: 변경되지 않은 페이지들은 여전히 CDN에서 빠르게 제공</li>
<li>서버 부하 분산: 일부 페이지만 origin 서버에서 로드하므로 트래픽 분산</li>
<li>점진적 업데이트: 변경 사항이 필요한 부분만 즉시 반영</li>
</ul>
<h3 id="q5-hydration-과정에서-사용자가-느낄-수-있는-ux-이슈는-무엇이고-어떻게-개선할-수-있을까요"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q5-hydration-과정에서-사용자가-느낄-수-있는-ux-이슈는-무엇이고-어떻게-개선할-수-있을까요"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q5. Hydration 과정에서 사용자가 느낄 수 있는 UX 이슈는 무엇이고, 어떻게 개선할 수 있을까요?</h3>
<p>Hydration 과정에서 사용자가 느낄 수 있는 UX 이슈는 다음과 같습니다.</p>
<h4 id="1-깜빡임-현상-flash-of-unstyled-content"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-깜빡임-현상-flash-of-unstyled-content"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. 깜빡임 현상 (Flash of Unstyled Content)</h4>
<p>SSR로 생성된 HTML과 클라이언트에서 하이드레이션된 결과가 일치하지 않을 때 발생합니다.</p>
<p><strong>[개선 방안]</strong></p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">__INITIAL_DATA__</span><span class="token operator">?.</span>products<span class="token operator">?.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// 서버에서 전달받은 초기 데이터로 즉시 상태 설정</span>
</span><span class="code-line">  productStore<span class="token punctuation">.</span><span class="token method function property-access">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">PRODUCT_ACTIONS</span><span class="token punctuation">.</span><span class="token constant">SETUP</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token literal-property property">payload</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token spread operator">...</span><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">__INITIAL_DATA__</span><span class="token punctuation">,</span> <span class="token literal-property property">loading</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword control-flow">return</span><span class="token punctuation">;</span> <span class="token comment">// 추가 API 호출 방지</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="if (window.__INITIAL_DATA__?.products?.length &gt; 0) {
  // 서버에서 전달받은 초기 데이터로 즉시 상태 설정
  productStore.dispatch({
    type: PRODUCT_ACTIONS.SETUP,
    payload: { ...window.__INITIAL_DATA__, loading: false }
  });
  return; // 추가 API 호출 방지
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h4 id="2-상호작용-불가-기간-uncanny-valley"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-상호작용-불가-기간-uncanny-valley"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. 상호작용 불가 기간 (Uncanny Valley)</h4>
<p>사용자는 버튼이나 링크를 볼 수 있지만 클릭해도 반응하지 않는 기간이 존재합니다.</p>
<p><strong>[개선 방안]</strong></p>
<ul>
<li>로딩 인디케이터로 상태 명확화</li>
<li>점진적 개선(Progressive Enhancement) 적용</li>
</ul>
<h4 id="3--레이아웃-시프트-layout-shift"><a class="anchor" aria-hidden="true" tabindex="-1" href="#3--레이아웃-시프트-layout-shift"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>3.  레이아웃 시프트 (Layout Shift)</h4>
<p>동적 콘텐츠 로드 시 페이지 레이아웃이 갑자기 변경되는 현상입니다.</p>
<p><strong>[개선 방안]</strong></p>
<ul>
<li>스켈레톤 UI로 레이아웃 대체</li>
</ul>
<br/>
<h3 id="q6-이번-과제에서-학습한-내용을-실제-프로덕션-환경에-적용할-때-추가로-고려해야-할-사항은"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q6-이번-과제에서-학습한-내용을-실제-프로덕션-환경에-적용할-때-추가로-고려해야-할-사항은"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q6. 이번 과제에서 학습한 내용을 실제 프로덕션 환경에 적용할 때 추가로 고려해야 할 사항은?</h3>
<p>현재 에러 로깅이 부족하여 프로덕션 환경에서는 해당 부분이 보완되어야 합니다.</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// 개발 환경에서 스택 트레이스 정리</span>
</span><span class="code-line">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isProduction <span class="token operator">&amp;&amp;</span> vite<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    vite<span class="token punctuation">.</span><span class="token method function property-access">ssrFixStacktrace</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">&quot;SSR 렌더링 에러:&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span><span class="token property-access">message</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">end</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span><span class="token property-access">stack</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ❌ 프로덕션에서 스택 노출</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="} catch (error) {
  // 개발 환경에서 스택 트레이스 정리
  if (!isProduction &amp;&amp; vite) {
    vite.ssrFixStacktrace(error);
  }

  console.error(&quot;SSR 렌더링 에러:&quot;, error.message);
  res.status(500).end(error.stack); // ❌ 프로덕션에서 스택 노출
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<ul>
<li>프로덕션에서도 스택 트레이스가 노출되고 있음</li>
<li>에러 분류 및 적절한 응답 코드 부족</li>
<li>에러 로깅 및 모니터링 부재</li>
</ul>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// productService.js:36-42 </span>
</span><span class="code-line"><span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  productStore<span class="token punctuation">.</span><span class="token method function property-access">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">PRODUCT_ACTIONS</span><span class="token punctuation">.</span><span class="token constant">SET_ERROR</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token literal-property property">payload</span><span class="token operator">:</span> error<span class="token punctuation">.</span><span class="token property-access">message</span><span class="token punctuation">,</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword control-flow">throw</span> error<span class="token punctuation">;</span> <span class="token comment">// ❌ 에러를 다시 던져서 처리되지 않음</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// productService.js:36-42 
} catch (error) {
  productStore.dispatch({
    type: PRODUCT_ACTIONS.SET_ERROR,
    payload: error.message,
  });
  throw error; // ❌ 에러를 다시 던져서 처리되지 않음
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>사용자에게 적절한 에러 메세지 제공도 부족합니다.</p>
<p><strong>[개선 방안]</strong>
서버, 클라이언트 사이드에 맞는 에러 핸들링을 강화하고 에러 바운더리 및 폴백 UI를 적용합니다.</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// 프로덕션 환경 설정</span>
</span><span class="code-line"><span class="token keyword">const</span> isProduction <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&#x27;production&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 에러 핸들러 초기화</span>
</span><span class="code-line"><span class="token keyword">const</span> errorHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ErrorHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> clientErrorHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClientErrorHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> errorBoundary <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ErrorBoundary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ErrorLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 전역 에러 핸들러 등록</span>
</span><span class="code-line"><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#x27;error&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  errorBoundary<span class="token punctuation">.</span><span class="token method function property-access">handleError</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">error</span><span class="token punctuation">,</span> <span class="token string">&#x27;Global&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token literal-property property">filename</span><span class="token operator">:</span> event<span class="token punctuation">.</span><span class="token property-access">filename</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token literal-property property">lineno</span><span class="token operator">:</span> event<span class="token punctuation">.</span><span class="token property-access">lineno</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token literal-property property">colno</span><span class="token operator">:</span> event<span class="token punctuation">.</span><span class="token property-access">colno</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#x27;unhandledrejection&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  errorBoundary<span class="token punctuation">.</span><span class="token method function property-access">handleError</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">reason</span><span class="token punctuation">,</span> <span class="token string">&#x27;Promise&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#x27;unhandledrejection&#x27;</span>
</span><span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// 프로덕션 환경 설정
const isProduction = process.env.NODE_ENV === &#x27;production&#x27;;

// 에러 핸들러 초기화
const errorHandler = new ErrorHandler();
const clientErrorHandler = new ClientErrorHandler();
const errorBoundary = new ErrorBoundary();
const logger = new ErrorLogger();

// 전역 에러 핸들러 등록
window.addEventListener(&#x27;error&#x27;, (event) =&gt; {
  errorBoundary.handleError(event.error, &#x27;Global&#x27;, {
    filename: event.filename,
    lineno: event.lineno,
    colno: event.colno
  });
});

window.addEventListener(&#x27;unhandledrejection&#x27;, (event) =&gt; {
  errorBoundary.handleError(event.reason, &#x27;Promise&#x27;, {
    type: &#x27;unhandledrejection&#x27;
  });
});
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h3 id="q7-nextjs-같은-프레임워크-대신-직접-구현한-ssrssg의-장단점은-무엇인가요"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q7-nextjs-같은-프레임워크-대신-직접-구현한-ssrssg의-장단점은-무엇인가요"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q7. Next.js 같은 프레임워크 대신 직접 구현한 SSR/SSG의 장단점은 무엇인가요?</h3>
<p><strong>[장점]</strong></p>
<ol>
<li>커스텀 자유도</li>
</ol>
<ul>
<li>프로젝트 요구사항에 맞는 적합한 방식으로 구현할 수 있다</li>
<li>불필요한 기능을 제거하여 번들 크기를 줄일 수 있다</li>
<li>특정 비즈니스 로직에 특화된 렌더링 전략을 적용해볼 수 있다</li>
</ul>
<ol start="2">
<li>의존성 제어</li>
</ol>
<ul>
<li>외부 라이브러리 의존도를 최소화할 수 있다</li>
<li>보안 취약점 노출 범위를 축소할 수 있다</li>
<li>업데이트 및 호환성 이슈에 자유롭다</li>
</ul>
<p><strong>[단점]</strong></p>
<ol>
<li>개발 및 유지보수 비용</li>
<li>안정성과 검증 부족</li>
<li>개발도구, 디버깅 환경 부족</li>
</ol>
<br/>
<h3 id="q8-nextjs-를-이용하여-ssg-방식으로-배포하려면-어떻게-해야-좋을까요"><a class="anchor" aria-hidden="true" tabindex="-1" href="#q8-nextjs-를-이용하여-ssg-방식으로-배포하려면-어떻게-해야-좋을까요"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q8. Next.js 를 이용하여 SSG 방식으로 배포하려면 어떻게 해야 좋을까요?</h3>
<p>App Router 방식에서는 dynamic 옵션을 export하여 렌더링 방식을 제어할 수 있습니다.</p>
<h4 id="1-ssg-페이지-생성"><a class="anchor" aria-hidden="true" tabindex="-1" href="#1-ssg-페이지-생성"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. SSG 페이지 생성</h4>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// app/products/page.js</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> dynamic <span class="token operator">=</span> <span class="token string">&#x27;force-static&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">ProductsPage</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">fetchProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token punctuation">{</span>products<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">product</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">(</span>
</span><span class="code-line">        <span class="token operator">&lt;</span><span class="token maybe-class-name">ProductCard</span> key<span class="token operator">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">}</span> product<span class="token operator">=</span><span class="token punctuation">{</span>product<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</span><span class="code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// app/products/page.js
export const dynamic = &#x27;force-static&#x27;;

export default async function ProductsPage() {
  const products = await fetchProducts();
  
  return (
    &lt;div&gt;
      {products.map(product =&gt; (
        &lt;ProductCard key={product.id} product={product} /&gt;
      ))}
    &lt;/div&gt;
  );
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<p>이 밖에도 다양한 dynamic 옵션들이 있습니다. 기본값은 auto입니다.</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token comment">// dynamic 옵션들</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> dynamic <span class="token operator">=</span> <span class="token string">&#x27;auto&#x27;</span><span class="token punctuation">;</span>          <span class="token comment">// 기본값: 자동 판단</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> dynamic <span class="token operator">=</span> <span class="token string">&#x27;force-dynamic&#x27;</span><span class="token punctuation">;</span> <span class="token comment">// 강제 SSR</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> dynamic <span class="token operator">=</span> <span class="token string">&#x27;force-static&#x27;</span><span class="token punctuation">;</span>  <span class="token comment">// 강제 SSG</span>
</span><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> dynamic <span class="token operator">=</span> <span class="token string">&#x27;error&#x27;</span><span class="token punctuation">;</span>         <span class="token comment">// 동적 함수 사용 시 에러</span>
</span></code><div class="copied" data-code="// dynamic 옵션들
export const dynamic = &#x27;auto&#x27;;          // 기본값: 자동 판단
export const dynamic = &#x27;force-dynamic&#x27;; // 강제 SSR
export const dynamic = &#x27;force-static&#x27;;  // 강제 SSG
export const dynamic = &#x27;error&#x27;;         // 동적 함수 사용 시 에러
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<ul>
<li>ISR(Incremental Static Regeneration) 설정</li>
</ul>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword module">export</span> <span class="token keyword">const</span> revalidate <span class="token operator">=</span> <span class="token number">3600</span><span class="token punctuation">;</span> <span class="token comment">// ISR: 1시간마다 재생성</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 또는 fetch 레벨에서 설정</span>
</span><span class="code-line"><span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#x27;/api/products&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token literal-property property">next</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">revalidate</span><span class="token operator">:</span> <span class="token number">3600</span> <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="export const revalidate = 3600; // ISR: 1시간마다 재생성

// 또는 fetch 레벨에서 설정
const products = await fetch(&#x27;/api/products&#x27;, {
  next: { revalidate: 3600 }
});
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h4 id="2-빌드"><a class="anchor" aria-hidden="true" tabindex="-1" href="#2-빌드"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. 빌드</h4>
<p>next.config.js 설정</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token doc-comment comment">/** <span class="token keyword">@type</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#x27;next&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>NextConfig<span class="token punctuation">}</span></span> */</span>
</span><span class="code-line"><span class="token keyword">const</span> nextConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token string">&#x27;export&#x27;</span><span class="token punctuation">,</span>        <span class="token comment">// 정적 파일로 출력</span>
</span><span class="code-line">  <span class="token literal-property property">trailingSlash</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>     <span class="token comment">// URL 끝에 슬래시 추가</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token comment">// 또는 서버리스 환경에서 ISR 활용</span>
</span><span class="code-line">  <span class="token comment">// output: &#x27;standalone&#x27;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="/** @type {import(&#x27;next&#x27;).NextConfig} */
const nextConfig = {
  output: &#x27;export&#x27;,        // 정적 파일로 출력
  trailingSlash: true,     // URL 끝에 슬래시 추가
  
  // 또는 서버리스 환경에서 ISR 활용
  // output: &#x27;standalone&#x27;
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<h4 id="standalone-모드란"><a class="anchor" aria-hidden="true" tabindex="-1" href="#standalone-모드란"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>standalone 모드란?</h4>
<blockquote>
<p>Next.js에서 제공하는 배포 옵션 중 하나로, 서버가 필요한 기능들을 포함하면서도 독립적으로 실행 가능한 애플리케이션을 생성하는 방식
빌드 시 .next/standalone 폴더에 Node.js 서버와 필요한 모든 의존성이 포함된 독립적인 애플리케이션이 생성됩니다.</p>
</blockquote>
<h4 id="언제-사용하는가"><a class="anchor" aria-hidden="true" tabindex="-1" href="#언제-사용하는가"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>언제 사용하는가?</h4>
<ul>
<li>ISR(Incremental Static Regeneration) 필요</li>
<li>API Routes 사용</li>
<li>동적 렌더링이 필요한 페이지 존재</li>
<li>서버 사이드 기능이 필요한 경우</li>
</ul>
<h4 id="3-배포"><a class="anchor" aria-hidden="true" tabindex="-1" href="#3-배포"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>3. 배포</h4>
<p>정적 호스팅으로 배포합니다.</p>
<ul>
<li>GitHub Pages</li>
<li>AWS S3 + CloudFront</li>
<li>Netlify</li>
<li>Vercel (정적 모드)</li>
</ul>
<pre class="language-json"><code class="language-json code-highlight"><span class="code-line"><span class="token comment">// package.json</span>
</span><span class="code-line"><span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token property">&quot;build:static&quot;</span><span class="token operator">:</span> <span class="token string">&quot;next build&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;deploy:s3&quot;</span><span class="token operator">:</span> <span class="token string">&quot;aws s3 sync out/ s3://your-bucket --delete&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">    <span class="token property">&quot;deploy:netlify&quot;</span><span class="token operator">:</span> <span class="token string">&quot;netlify deploy --prod --dir=out&quot;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code><div class="copied" data-code="// package.json
{
  &quot;scripts&quot;: {
    &quot;build:static&quot;: &quot;next build&quot;,
    &quot;deploy:s3&quot;: &quot;aws s3 sync out/ s3://your-bucket --delete&quot;,
    &quot;deploy:netlify&quot;: &quot;netlify deploy --prod --dir=out&quot;
  }
}
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<br/>
<h2 id="코드-품질-향상"><a class="anchor" aria-hidden="true" tabindex="-1" href="#코드-품질-향상"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>코드 품질 향상</h2>
<h3 id="개선하고-싶은-부분"><a class="anchor" aria-hidden="true" tabindex="-1" href="#개선하고-싶은-부분"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>개선하고 싶은 부분</h3>
<h4 id="라우터-방식-변경"><a class="anchor" aria-hidden="true" tabindex="-1" href="#라우터-방식-변경"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>라우터 방식 변경</h4>
<p>앞서 언급했던 라우터 인스턴스 생성 방식을 클라이언트/서버에 맞는 방식으로 개선하여 동시성 문제를 해결하고자 합니다.</p>
<h4 id="app에서-fallback-처리"><a class="anchor" aria-hidden="true" tabindex="-1" href="#app에서-fallback-처리"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>App에서 fallback 처리</h4>
<p><strong>[문제] CSR 빌드 서버에서의 빈 화면</strong>
React 패키지에서 빌드한 서버를 구현하는 것에 병목이 가장 심했습니다.
로컬 서버에서는 csr이 잘 렌더링 되는데 빌드한 서버(preview)에서는 네트워크는 이상이 없고 빈 화면이 나와 원인을 디버깅하기가 어려웠습니다. 제가 알아낸 결론은 렌더링할 컴포넌트가 포함되지 않은 상태로 빌드되어 빈 화면이 나오는 것이라고 판단했고, 현재는 csr 테스트코드 통과를 위해 App에서 컴포넌트를 분기처리를 하는 방식으로 테스트 코드를 통과 시켰습니다.
이 방식은 적절한 방식은 아니라고 생각되기도 하고, 제가 파악한 원인도 정확한 원인이 아닐 수 있을 것 같아서 이부분에 대한 원인을 찾아서 해결하고 싶습니다.</p>
<p><strong>[축약한 현재 구조]</strong></p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line"><span class="token comment">// App.tsx</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">const</span> PageComponent <span class="token operator">=</span> <span class="token function">useCurrentPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token function">useRouterQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token operator">&lt;</span>ToastProvider<span class="token operator">&gt;</span>
</span><span class="code-line">        <span class="token operator">&lt;</span>ModalProvider<span class="token operator">&gt;</span>
</span><span class="code-line">          <span class="token punctuation">{</span>PageComponent <span class="token operator">?</span> <span class="token punctuation">(</span>
</span><span class="code-line">            <span class="token operator">&lt;</span>PageComponent <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line">          <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>
</span><span class="code-line">            <span class="token operator">&lt;</span>HomePage
</span><span class="code-line">              searchQuery<span class="token operator">=</span><span class="token punctuation">{</span>query<span class="token punctuation">.</span>search<span class="token punctuation">}</span>
</span><span class="code-line">              limit<span class="token operator">=</span><span class="token punctuation">{</span>query<span class="token punctuation">.</span>limit<span class="token punctuation">}</span>
</span><span class="code-line">              sort<span class="token operator">=</span><span class="token punctuation">{</span>query<span class="token punctuation">.</span>sort<span class="token punctuation">}</span>
</span><span class="code-line">              category1<span class="token operator">=</span><span class="token punctuation">{</span>query<span class="token punctuation">.</span>category1<span class="token punctuation">}</span>
</span><span class="code-line">              category2<span class="token operator">=</span><span class="token punctuation">{</span>query<span class="token punctuation">.</span>category2<span class="token punctuation">}</span>
</span><span class="code-line">            <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line">          <span class="token punctuation">)</span><span class="token punctuation">}</span>
</span><span class="code-line">        <span class="token operator">&lt;</span><span class="token operator">/</span>ModalProvider<span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token operator">&lt;</span><span class="token operator">/</span>ToastProvider<span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token operator">&lt;</span>CartInitializer <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line">    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// HomePage.tsx</span>
</span><span class="code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> HomePage<span class="token operator">:</span> <span class="token constant">FC</span><span class="token operator">&lt;</span>HomePageProps<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> 
</span><span class="code-line">  searchQuery<span class="token punctuation">,</span> limit<span class="token punctuation">,</span> sort<span class="token punctuation">,</span> category1<span class="token punctuation">,</span> category2 
</span><span class="code-line"><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token comment">// props로 받은 데이터 사용</span>
</span><span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">(</span>
</span><span class="code-line">    <span class="token operator">&lt;</span>PageWrapper headerLeft<span class="token operator">=</span><span class="token punctuation">{</span>headerLeft<span class="token punctuation">}</span><span class="token operator">&gt;</span>
</span><span class="code-line">      <span class="token operator">&lt;</span>SearchBar
</span><span class="code-line">        initialSearchQuery<span class="token operator">=</span><span class="token punctuation">{</span>searchQuery<span class="token punctuation">}</span>
</span><span class="code-line">        initialLimit<span class="token operator">=</span><span class="token punctuation">{</span>limit<span class="token punctuation">}</span>
</span><span class="code-line">        <span class="token comment">// ...</span>
</span><span class="code-line">      <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line">    <span class="token operator">&lt;</span><span class="token operator">/</span>PageWrapper<span class="token operator">&gt;</span>
</span><span class="code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code><div class="copied" data-code="// App.tsx
export const App = () =&gt; {
  const PageComponent = useCurrentPage();
  const query = useRouterQuery();

  return (
    &lt;&gt;
      &lt;ToastProvider&gt;
        &lt;ModalProvider&gt;
          {PageComponent ? (
            &lt;PageComponent /&gt;
          ) : (
            &lt;HomePage
              searchQuery={query.search}
              limit={query.limit}
              sort={query.sort}
              category1={query.category1}
              category2={query.category2}
            /&gt;
          )}
        &lt;/ModalProvider&gt;
      &lt;/ToastProvider&gt;
      &lt;CartInitializer /&gt;
    &lt;/&gt;
  );
};

// HomePage.tsx
export const HomePage: FC&lt;HomePageProps&gt; = ({ 
  searchQuery, limit, sort, category1, category2 
} = {}) =&gt; {
  // props로 받은 데이터 사용
  return (
    &lt;PageWrapper headerLeft={headerLeft}&gt;
      &lt;SearchBar
        initialSearchQuery={searchQuery}
        initialLimit={limit}
        // ...
      /&gt;
    &lt;/PageWrapper&gt;
  );
};
"><svg class="octicon-copy" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg><svg class="octicon-check" aria-hidden="true" viewBox="0 0 16 16" fill="currentColor" height="12" width="12"><path fill-rule="evenodd" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg></div></pre>
<br/>
<h2 id="학습-연계"><a class="anchor" aria-hidden="true" tabindex="-1" href="#학습-연계"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>학습 연계</h2>
<h3 id="다음-학습-목표"><a class="anchor" aria-hidden="true" tabindex="-1" href="#다음-학습-목표"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>다음 학습 목표</h3>
<p>구현하면서 알게 되었던 동작 원리나 개선 포인트들을 학습하면서 Next.js에서는 이런 점들을 어떻게 풀어냈을지 궁금해졌습니다. Next.js가 제공하는 렌더링 최적화 전략들(스트리밍이나 Partial Prerendering와 같은)이나 구현 방식에 대해 마인드맵을 그려보며 복습해보고, 이 과제에서 구현한 방식과 비교해보면 조금 더 정리가 잘 될 것 같습니다.</p>
<h2 id="리뷰-받고-싶은-내용"><a class="anchor" aria-hidden="true" tabindex="-1" href="#리뷰-받고-싶은-내용"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>리뷰 받고 싶은 내용</h2>
<ol>
<li>
<p>이 과제를 다시 한 번 수행 한다면 추가로 구현해보면 도움이 될만한 것들을 추천해주실 수 있으실까요?!
과제를 확장해서 같이 경험하면 좋을 것 같은 것이 있다면 추천해주시면 감사하겠습니다!</p>
</li>
<li>
<p>앞에서 언급한 개선하고 싶은 부분의</p>
</li>
</ol>
<blockquote>
<p>App에서 fallback 처리</p>
</blockquote>
<p>에서 언급한 문제의 원인을 알고 싶습니다.
주된 병목은 로컬 서버에서 csr, ssr가 잘 동작한다면 그대로 빌드한 서버에서도 동일하게 화면이 잘 나올 것이라고 예상-&gt; 빈 화면 에서의 디버깅이었습니다. 이런 현상에 대한 원인은 주로 어떤 것인지, 가장 먼저 어떤 부분을 생각해야할까요? 그리고 이런 상황에서 디버깅을 어떤 순서대로 수행해야할 지 감을 잡는 것이 어려웠습니다!</p></div></div><div class="overflow-auto mt-9"><div data-color-mode="dark" class="wmde-markdown wmde-markdown-color p-6 max-w-full" style="word-wrap:break-word;overflow-wrap:break-word"><h2 id="과제-피드백"><a class="anchor" aria-hidden="true" tabindex="-1" href="#과제-피드백"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>과제 피드백</h2>
<p>수고했습니다. 이번 과제는 SSR과 SSG를 직접 구현해보면서 렌더링 전략의 차이점과 성능 최적화 방법을 체험하는데 목적이 있었습니다.</p>
<p>발제를 두 번 들으며 매 순간이 어려웠다고 솔직하게 표현해주셨는데, 그 과정에서 SSR 흐름과 프로젝트 구조를 체계적으로 정리하신 부분이 매우 좋았어요. 특히 클라이언트 요청부터 하이드레이션까지의 1~6단계 정리와 각 파일들의 역할을 표로 정리한 것이 명확했습니다.</p>
<p>동시성 문제를 발견하고 분석한 과정이 깊이 있었네요. &quot;하나의 라우터 인스턴스가 여러 요청의 상태를 뒤섞어서 예측 불가능한 동작 발생&quot;이라는 핵심을 정확히 파악하셨어요. 싱글톤 패턴이 서버 환경에서 어떤 문제를 일으키는지 실제로 경험해보신 거죠.</p>
<p>언제나 회고나 리뷰에 진심인게 느껴져서 좋네요. Q1-Q8까지의 세부적인 내용에 대해서 잘 작성을 해주는 것 같아요. 앞으로도 면접이나 정말 내것으로 만들기 위해서 지금 회고하면서 적어 본 내용을 실제 육성으로 말해보거나 누군가에게 설명해보는 연습까지 해보면 좋겠네요</p>
<p>Q) 이 과제를 다시 한 번 수행 한다면 추가로 구현해보면 도움이 될만한 것들을 추천해주실 수 있으실까요?! 과제를 확장해서 같이 경험하면 좋을 것 같은 것이 있다면 추천해주시면 감사하겠습니다!</p>
<p>=&gt; 인증이나 쿠키, 서버-클라이언트간 상태 공유 등 서버와 클라이언트 간의 데이터 교환이나 기능등을 로그인과 같은 인증을 구현해보면서 메타 프레임워크가 어떤 식으로 동작하는지 만들어보면 훨씬 더 큰 깊이를 알 수 있을거에요</p>
<p>=&gt; 그 밖에 Next.js나 Remix등에서 공통적으로 제공하는 개념적 기능들에 대해서 저건 어떻게 만들었을까? 왜 만들었을까? 에 대해서 고민하면서 한번 만들어 보심을 추천합니다 :)</p>
<p>Q) 1 앞에서 언급한 개선하고 싶은 부분의 App에서 fallback 처리 에서 언급한 문제의 원인을 알고 싶습니다. 주된 병목은 로컬 서버에서 csr, ssr가 잘 동작한다면 그대로 빌드한 서버에서도 동일하게 화면이 잘 나올 것이라고 예상-&gt; 빈 화면 에서의 디버깅이었습니다. 이런 현상에 대한 원인은 주로 어떤 것인지, 가장 먼저 어떤 부분을 생각해야할까요? 그리고 이런 상황에서 디버깅을 어떤 순서대로 수행해야할 지 감을 잡는 것이 어려웠습니다!</p>
<p>=&gt; 크롬 디버그 툴이라는 정말 막강한 디버그 툴의 도움을 받으면서 개발을 하다가 SSR로 넘어오게 되면 잘 보이지도 않는 콘솔에 의지하면서 디버깅을 해야하는 경험이 정말 힘들죠. 브라우저는 분명 먹통인데 알수 있는 정보는 없고 말에요 ㅎㅎ</p>
<p>=&gt; 같은 코드를 사용하지만 환경이 다르다 보니 환경에 의한 차이로 실제 중간값이 다른 경우인 경우가 많아서 문제가 되는 경우가 많죠. 그리고 이제부터 어디가 문제인지를 찾고 예상할 수 있는 능력이 점점 더 중요해진답니다.</p>
<p>=&gt; 일반적으로야 모든 개발자가 그러하듯이 콘솔 로그를 보면서 문제가 생길만한 곳을 코드를 보며 예측하면서 run &amp; fix를 하죠. 정 안되겠다 싶을때 제가 주로 하는 방법은 문제가 예상되는 곳을 주석처리하거나 skip하고 하드코딩을 해서 어떻게 해서는 정상동작하는 환경을 만들고 하나씩 붙여가는 식으로 확인을 하곤 합니다. (혹은 커밋을 뒤로 돌려가면서요). 일단 정상동작을 만들고 나면 마음이 편하기도 하고 하나씩 밟아가면서 터지는 곳을 발견할 수 있으니까요. 지호도 지호 나름대로의 방법을 찾아가 보기를 바래요.</p>
<p>수고많았습니다! 마지막 과제도 화이팅입니다</p></div></div><div class="mt-9"></div></div></main></div></div></div></div>
</body>
</html>
